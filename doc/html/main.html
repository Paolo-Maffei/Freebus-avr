<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>FreeBusAVR: Main Page</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- Generated by Doxygen 1.7.2 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul class="tablist">
      <li class="current"><a href="main.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
</div>
<div class="header">
  <div class="headertitle">
<h1>FreeBusAVR Documentation</h1>  </div>
</div>
<div class="contents">
<p><b>Setting Fuses for ATMega168(P):</b><br/>
 Boot Rom not used<br/>
 SPIEN=on<br/>
 BODLEVEL=Brown-out detection at VCC=2.7V<br/>
 SUT_CKSEL=Ext. Crystal Osc. 8.0- MHz; Start-up time: PWRDWN/RESET: 1K CK /14<br/>
</p>
<p>EXTENDED=0x01<br/>
 HIGH=0xDD (eeprom not preseved through chip erase), or 0xD5 (eeprom preserved)<br/>
 HIGH=0xCD or 0xC5 (as above, but watchdog enabled) LOW=0xCF (crystal oscillator), or 0xC0 (external clock from RFM22)<br/>
</p>
<p><b>Setting Fuses for ATMega328P:</b><br/>
</p>
<p>Boot Rom not used<br/>
 SPIEN=on<br/>
 BODLEVEL=Brown-out detection at VCC=2.7V<br/>
 SUT_CKSEL=Ext. Crystal Osc. 8.0- MHz; Start-up time: PWRDWN/RESET: 1K CK /14<br/>
</p>
<p>EXTENDED=0x05<br/>
 HIGH=0xD9 (eeprom not preseved through chip erase), or 0xD1 (eeprom preserved)<br/>
 HIGH=0xC9 or 0xC1 (as above, but watchdog enabled) LOW=0xCF (crystal oscillator), or 0xC0 (external clock from RFM22)<br/>
</p>
<p><b>Compile and create HEX files:</b><br/>
 To compile your self developed app or the existing ones finished build scripts for Windows (AVR Studio) and Linux/Unix/MacOSX (Makefiles) is in place.<br/>
 You can use AVR Studio to generate the hex files or GNU Make, what you prefer.</p>
<p>Windows:<br/>
 Load the existing project file in AVR-Studio, e.g. app-8-out\fb_app_8_out.aps and compile it with AVR Studio, for more details see the start-avr.pdf manual.</p>
<p>Linux/Unix/MacOSX:<br/>
 Some default parameters are already defined, if you like to change them copy the file Make.config.template to Make.config and edit that it matches for wishes. To create all .hex files you can type in the directory software/avr/ then:<br/>
 make hex<br/>
 you will find your hex file in the application folder like app-8-out/freebus-avr-8-out.hex</p>
<p><b>Compiler defines in your own application</b><br/>
 In order to select the right library and CPU frequency, you should define<br/>
 <b>-DFB_TP</b> freebus (twisted pair) device<br/>
 <b>-DFB_RF</b> freebus-rf device<br/>
 <b>-DFB_TP -DFB_RF</b> device with both, twisted pair and rf, this applies for a gateway<br/>
 <b>-DFB_TP -DBOARD301</b> for the old Rev 3.01 board (twisted pair, of course)<br/>
 if you use GNU make you can set the variable CUSTOM_CFLAGS in your application's Makefile.<br/>
</p>
<p><b>General notes if developing your own application:</b><br/>
 If you develop an application you should not use an ISR in that application it can disturb the extreme critical timing in the EIB bus communication. I you need timers you should check instead registers if a special event was triggered. If you absolutely cannot avoid the use of ISRs make sure that they run as short as possible and check every condition you can imagine that it is secured that the bus communication is handled correctly.<br/>
 Transfers which a very error phrone are:<br/>
 * ACKS sent and received (at the end of a telegram)<br/>
 * Long communication like programming of group addresses and parameters<br/>
 * Receiving of data while a bit is read<br/>
</p>
<p>The following functions must exist in each application (take as example <a class="el" href="fb__relais__app_8c.html" title="The relais application to switch 8 relais Manufactorer code is 0x04 = Jung  Device type (2038...">fb_relais_app.c</a>):<br/>
 * <a class="el" href="fb__relais__app_8c.html#a840291bc02cba5474a4cb46a9b9566fe">main(void)</a><br/>
 * <a class="el" href="fb__app_8h.html#ade9d8c8c0690bc0cba78301d9a254639">runApplication(struct msg *rxmsg)</a><br/>
 * <a class="el" href="fb__app_8h.html#ace6b0e9279dd6bc5c4238fd4bac237ba">readApplication(struct msg *rxmsg)</a><br/>
 * <a class="el" href="fb__app_8h.html#a749c68415730ce0554c155bbee38234b">restartApplication(void)</a><br/>
 * <a class="el" href="fb__2-dimmer__app_8h.html#aae3384a1209f19fced106416ac96670e">setApplicationDefaults(void)</a><br/>
</p>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000098">Todo:</a></b></dt><dd>complete list of conditions that must be checked </dd></dl>
</div>
<hr class="footer"/><address class="footer"><small>Generated on Mon Mar 7 2011 10:08:39 for FreeBusAVR by&#160;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.2 </small></address>
</body>
</html>
