<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>FreeBusAVR: lib/fb_prot.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- Generated by Doxygen 1.7.2 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul class="tablist">
      <li><a href="main.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
</div>
<div class="header">
  <div class="summary">
<a href="#nested-classes">Data Structures</a> &#124;
<a href="#define-members">Defines</a> &#124;
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<h1>lib/fb_prot.c File Reference</h1>  </div>
</div>
<div class="contents">

<p>Handle all requests which are EIB bases like write current address or group address.  
<a href="#_details">More...</a></p>
<code>#include &quot;<a class="el" href="fb_8h_source.html">fb.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="fb__hardware_8h_source.html">fb_hardware.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="freebus-debug_8h_source.html">freebus-debug.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="fb__eeprom_8h_source.html">fb_eeprom.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="fb__app_8h_source.html">fb_app.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="fb__hal_8h_source.html">fb_hal.h</a>&quot;</code><br/>
<code>#include &quot;rf22.h&quot;</code><br/>
<code>#include &quot;fbrf_prot.h&quot;</code><br/>
<code>#include &quot;<a class="el" href="fb__prot_8h_source.html">fb_prot.h</a>&quot;</code><br/>
<!-- startSectionHeader --><div class="dynheader">
Include dependency graph for fb_prot.c:<!-- endSectionHeader --></div>
<!-- startSectionSummary --><!-- endSectionSummary --><!-- startSectionContent --><div class="dyncontent">
<div class="center"><img src="fb__prot_8c__incl.png" border="0" usemap="#lib_2fb__prot_8c" alt=""/></div>
<map name="lib_2fb__prot_8c" id="lib_2fb__prot_8c">
<area shape="rect" id="node3" href="fb_8h.html" title="Define general values used in bus communication." alt="" coords="5,237,51,267"/><area shape="rect" id="node5" href="fb__hardware_8h.html" title="Hardware specific options which includes the platforms (like ATmega8, ATmega168...)" alt="" coords="269,237,381,267"/><area shape="rect" id="node7" href="freebus-debug_8h.html" title="Header file to map debugging between several output devices. Possible outputs are lcd..." alt="" coords="415,83,540,112"/><area shape="rect" id="node15" href="fb__eeprom_8h.html" title="Handling the access and mapping to the eeprom." alt="" coords="564,83,665,112"/><area shape="rect" id="node17" href="fb__app_8h.html" title="General application definition file." alt="" coords="167,83,244,112"/><area shape="rect" id="node27" href="fb__hal_8h.html" title="Definitions on Hardware Abstration Layer." alt="" coords="319,83,391,112"/><area shape="rect" id="node34" href="rf_2rf22-controller_2rf22_8h_source.html" title="rf22.h" alt="" coords="689,83,748,112"/><area shape="rect" id="node36" href="rf_2rf22-controller_2fbrf__prot_8h_source.html" title="fbrf_prot.h" alt="" coords="781,83,869,112"/><area shape="rect" id="node46" href="fb__prot_8h.html" title="Define the protocol specific definitions Implementation of the communication protocol." alt="" coords="65,83,143,112"/><area shape="rect" id="node11" href="lcd-lib_8h.html" title="lcd&#45;lib.h" alt="" coords="697,160,767,189"/><area shape="rect" id="node13" href="delay_8h.html" title="Functions to delay the execution." alt="" coords="699,237,765,267"/><area shape="rect" id="node19" href="msg__queue_8h.html" title="Definitions for the message queue system used for telegrams and communucation like debugging (also rs..." alt="" coords="135,160,244,189"/><area shape="rect" id="node38" href="fbrf22_8h_source.html" title="fbrf22.h" alt="" coords="791,160,860,189"/><area shape="rect" id="node40" href="rfmsg__queue_8h_source.html" title="rfmsg_queue.h" alt="" coords="884,160,1001,189"/><area shape="rect" id="node42" href="fbrf__hardware_8h_source.html" title="fbrf_hardware.h" alt="" coords="883,237,1003,267"/><area shape="rect" id="node44" href="fbrf-atmega8_8h_source.html" title="fbrf&#45;atmega8.h" alt="" coords="884,315,1001,344"/></map>
<!-- endSectionContent --></div>
<table class="memberdecls">
<tr><td colspan="2"><h2><a name="nested-classes"></a>
Data Structures</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structfb__cmd.html">fb_cmd</a></td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">structure which saves all EIB commands  <a href="structfb__cmd.html#_details">More...</a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structucd__stat.html">ucd_stat</a></td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Track status of connections if connection is opened with T_Connect_Req.  <a href="structucd__stat.html#_details">More...</a><br/></td></tr>
<tr><td colspan="2"><h2><a name="define-members"></a>
Defines</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a5cca3bbce3ad20496d4b9e953dde9188"></a><!-- doxytag: member="fb_prot.c::_FB_PROT_C" ref="a5cca3bbce3ad20496d4b9e953dde9188" args="" -->
#define&#160;</td><td class="memItemRight" valign="bottom"><b>_FB_PROT_C</b></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="fb__prot_8c.html#ad01f913d138227e2b4fc4dd2ca904f07">MSG_MUL</a>&#160;&#160;&#160;(1&lt;&lt;1)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Multicast address, one-to-many, connection-less.  <a href="#ad01f913d138227e2b4fc4dd2ca904f07"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="fb__prot_8c.html#a13b38c2f32cb6fdf9e18f62e5dce75c6">MSG_BRC</a>&#160;&#160;&#160;(1&lt;&lt;7)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Broadcast adress, one-to-all conenction-less.  <a href="#a13b38c2f32cb6fdf9e18f62e5dce75c6"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="fb__prot_8c.html#af4b7d60452ebd8d0355291bd3b720e39">MSG_DAF</a>&#160;&#160;&#160;(1&lt;&lt;1)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Direct adressing, one-to-one.  <a href="#af4b7d60452ebd8d0355291bd3b720e39"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="fb__prot_8c.html#ab3b0799fb79aec4bb06d92b4770139f9">MSG_GRP</a>&#160;&#160;&#160;(1&lt;&lt;6)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Group adress.  <a href="#ab3b0799fb79aec4bb06d92b4770139f9"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="fb__prot_8c.html#a253031b1534db6709a48eb59e440b801">MSG_CON</a>&#160;&#160;&#160;(1&lt;&lt;5)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">connect request  <a href="#a253031b1534db6709a48eb59e440b801"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="fb__prot_8c.html#ac7d0d9a9ace91de05ac02191bd7a1aa8">MSG_DIS</a>&#160;&#160;&#160;(1&lt;&lt;4)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">disconnect request  <a href="#ac7d0d9a9ace91de05ac02191bd7a1aa8"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="acd5e63d3403142c6a7c4be6c2579c354"></a><!-- doxytag: member="fb_prot.c::FW_MASK" ref="acd5e63d3403142c6a7c4be6c2579c354" args="" -->
#define&#160;</td><td class="memItemRight" valign="bottom"><b>FW_MASK</b>&#160;&#160;&#160;<a class="el" href="fb__prot_8c.html#a8eddb2a4af440b7e0c13055d3ad4bc7d">nodeParam</a>[NODEPARAM_SIZE - 6]</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a956161ec8a9b3794be199bf6501ce744"></a><!-- doxytag: member="fb_prot.c::FW_PA" ref="a956161ec8a9b3794be199bf6501ce744" args="" -->
#define&#160;</td><td class="memItemRight" valign="bottom"><b>FW_PA</b>&#160;&#160;&#160;<a class="el" href="fb__prot_8c.html#a8eddb2a4af440b7e0c13055d3ad4bc7d">nodeParam</a>[NODEPARAM_SIZE - 7]</td></tr>
<tr><td colspan="2"><h2><a name="func-members"></a>
Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="fb__prot_8c.html#aaec72f885e36952a75395779cf20d684">read_grp_addr</a> (void)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Read the group addresses from the eeprom and save them in the struct grp_addr.  <a href="#aaec72f885e36952a75395779cf20d684"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static struct <a class="el" href="structmsg.html">msg</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="fb__prot_8c.html#a1ca66f4c62a2c7c7ff2c8ebef64465da">fb_new_msg</a> (uint8_t *dest, uint8_t payload_len)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Create a new telegram and and return pointer to it.  <a href="#a1ca66f4c62a2c7c7ff2c8ebef64465da"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static uint8_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="fb__prot_8c.html#ac3b30c7591e51974ab895440929395c6">A_PhysicalAddress_Write</a> (struct <a class="el" href="structmsg.html">msg</a> *rxmsg)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Set the received address as our new device address.  <a href="#ac3b30c7591e51974ab895440929395c6"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static uint8_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="fb__prot_8c.html#ae42ed05d4ccf0a841bdaa32fe7af4478">A_PhysicalAddress_Read</a> (struct <a class="el" href="structmsg.html">msg</a> *rxmsg)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns the address of the device.  <a href="#ae42ed05d4ccf0a841bdaa32fe7af4478"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static uint8_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="fb__prot_8c.html#a3b317425f1358ea37c8fca124e29c277">T_Connect_Req</a> (struct <a class="el" href="structmsg.html">msg</a> *rxmsg)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Called to start a connection to a physical address.  <a href="#a3b317425f1358ea37c8fca124e29c277"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static uint8_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="fb__prot_8c.html#a0675ad49aa389619806157f585c466ee">T_Disconnect_Req</a> (struct <a class="el" href="structmsg.html">msg</a> *rxmsg)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Release the transport connection.  <a href="#a0675ad49aa389619806157f585c466ee"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="fb__prot_8c.html#a440973c20d3055721521a359aee68536">ncd_resp</a> (struct <a class="el" href="structmsg.html">msg</a> *rxmsg)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Sicherungslayer.  <a href="#a440973c20d3055721521a359aee68536"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static uint8_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="fb__prot_8c.html#a37d55968595e78e21dc1dba21418acf4">A_DeviceDescriptor_Read</a> (struct <a class="el" href="structmsg.html">msg</a> *rxmsg)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Is called if information for the BCU type is requested.  <a href="#a37d55968595e78e21dc1dba21418acf4"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static uint8_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="fb__prot_8c.html#af2931210aae10a2c39698d2f1fb3c98c">A_Memory_Read</a> (struct <a class="el" href="structmsg.html">msg</a> *rxmsg)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Read data from eeprom and return send it as telegram back to the requester.  <a href="#af2931210aae10a2c39698d2f1fb3c98c"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static uint8_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="fb__prot_8c.html#afae8acdc71d1ebff494c621459c097cf">A_Memory_Write</a> (struct <a class="el" href="structmsg.html">msg</a> *rxmsg)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Write recieved data to the eeprom.  <a href="#afae8acdc71d1ebff494c621459c097cf"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static uint8_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="fb__prot_8c.html#a4a0be801ed4f2d9b2cbce548adf56a76">A_ADC_Read</a> (struct <a class="el" href="structmsg.html">msg</a> *rxmsg)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Read the values from the ADC converter.  <a href="#a4a0be801ed4f2d9b2cbce548adf56a76"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static uint8_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="fb__prot_8c.html#a088341f3603f5de9eb4817a8199391c6">A_Restart</a> (struct <a class="el" href="structmsg.html">msg</a> *rxmsg)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Restart the program on the microcontroller.  <a href="#a088341f3603f5de9eb4817a8199391c6"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static uint8_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="fb__prot_8c.html#a5928e9483083ad86d6c82f0b0ca533af">Ignore</a> (struct <a class="el" href="structmsg.html">msg</a> *rxmsg)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Send aknowledge to certain message.  <a href="#a5928e9483083ad86d6c82f0b0ca533af"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static uint8_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="fb__prot_8c.html#ae56aada1e48493023c8f3ecf7a1e71a7">A_GroupValue_Read</a> (struct <a class="el" href="structmsg.html">msg</a> *rxmsg)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">A read request to the application.  <a href="#ae56aada1e48493023c8f3ecf7a1e71a7"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static uint8_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="fb__prot_8c.html#abb5d4fc672e3e3e123f5f3e6e9f901e3">A_GroupValue_Write</a> (struct <a class="el" href="structmsg.html">msg</a> *rxmsg)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Is called if a broadcast is received with a matching group address (eg.  <a href="#abb5d4fc672e3e3e123f5f3e6e9f901e3"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static uint8_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="fb__prot_8c.html#af4f820be8f1240cee6515133062a2e93">check_addr</a> (struct <a class="el" href="structfbus__hdr.html">fbus_hdr</a> *hdr)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Analyse the type of the message (broadcast, direct, group address) and check for physical and group address if the telegram is for us.  <a href="#af4f820be8f1240cee6515133062a2e93"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="fb__prot_8c.html#ade80ef84f4f14d25a2283b43d9c1a54f">sendExtTelegram</a> (uint8_t commObjectNumber, uint8_t <a class="el" href="fb__ain10v_8c.html#a3f0c55f449560b03ce0ac43270c26600">value</a>, uint8_t offset)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Send telegram as response to signal current state of the port to other devices.  <a href="#ade80ef84f4f14d25a2283b43d9c1a54f"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="fb__prot_8c.html#a990a78673785da5bb024bfaf60e0984a">sendTelegram</a> (uint8_t commObjectNumber, uint8_t <a class="el" href="fb__ain10v_8c.html#a3f0c55f449560b03ce0ac43270c26600">value</a>, uint8_t offset)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Send telegram as response to signal current state of the port to other devices.  <a href="#a990a78673785da5bb024bfaf60e0984a"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">uint8_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="fb__prot_8c.html#ac5c589c547e7f53fb4b2c9bbbbe8797a">findRespondGroupAddressByObjectNumber</a> (uint8_t commObjectNumber, uint8_t offset)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Search through group address list and return the matching position of a group address which is an response address link.  <a href="#ac5c589c547e7f53fb4b2c9bbbbe8797a"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">uint8_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="fb__prot_8c.html#a3b07c15a969dbc529bb64de840ea56eb">fb_handlemsg</a> (struct <a class="el" href="structmsg.html">msg</a> *rxmsg)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Queue message for handling.  <a href="#a3b07c15a969dbc529bb64de840ea56eb"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="fb__prot_8c.html#a349ae562a88e3299f95943d9dcc2d794">fbprot_msg_handler</a> (void)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">That function is called from main loop.  <a href="#a349ae562a88e3299f95943d9dcc2d794"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="fb__prot_8c.html#a3e2ec796b82409111b3a88a764b17e4b">fbprot_Init</a> (const <a class="el" href="structSTRUCT__DEFPARAM.html">STRUCT_DEFPARAM</a> *pParam)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Read configuration from eeprom is existant or set default values and write them to the eeprom.  <a href="#a3e2ec796b82409111b3a88a764b17e4b"></a><br/></td></tr>
<tr><td colspan="2"><h2><a name="var-members"></a>
Variables</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">uint8_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="fb__prot_8c.html#a8eddb2a4af440b7e0c13055d3ad4bc7d">nodeParam</a> []</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">parameterstructure (RAM)  <a href="#a8eddb2a4af440b7e0c13055d3ad4bc7d"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="structgrp__addr__s.html">grp_addr_s</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="fb__prot_8c.html#aae3c982e005b9e0659d533393720a7f8">grp_addr</a></td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">List of saved group addresses for this controller, see struct <a class="el" href="structgrp__addr__s.html" title="Structure for the group addresses.">grp_addr_s</a> for more information.  <a href="#aae3c982e005b9e0659d533393720a7f8"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static struct <a class="el" href="structucd__stat.html">ucd_stat</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="fb__prot_8c.html#a5299818938807c9ebc199b66cbc01958">ucd</a></td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Used to track transport connections, for this source address, status and counter is saved.  <a href="#a5299818938807c9ebc199b66cbc01958"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="adbfedca471e27c2d257fc90093e5f3de"></a><!-- doxytag: member="fb_prot.c::rx_ptr" ref="adbfedca471e27c2d257fc90093e5f3de" args="" -->
static struct <a class="el" href="structmsg.html">msg</a> *&#160;</td><td class="memItemRight" valign="bottom"><b>rx_ptr</b></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="structfb__cmd.html">fb_cmd</a> bus_cmds[]&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="fb__prot_8c.html#ab1cd66b780fee6c2be823928c720a129">PROGMEM</a></td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Store mapping of function with parameters called by bus memebers.  <a href="#ab1cd66b780fee6c2be823928c720a129"></a><br/></td></tr>
</table>
<hr/><a name="_details"></a><h2>Detailed Description</h2>
<p>Handle all requests which are EIB bases like write current address or group address. </p>
<dl class="author"><dt><b>Author:</b></dt><dd>Dirk Opfer, Matthias Fechner, Christian Bode, Dirk Armbrust </dd></dl>
<dl class="date"><dt><b>Date:</b></dt><dd>Fri Oct 26 18:14:05 2007</dd></dl>
<p>Description of a telegram:</p>
<ul>
<li>A telegram consists of the following bytes:<ol type="a">
<li>8-bit: controll byte</li>
<li>16-bit: source address</li>
<li>16-bit: destination address</li>
<li>3-bit: routing counter</li>
<li>4-bit: length of user data</li>
<li>2-16 byte: user data</li>
<li>8-bit: CRC byte</li>
</ol>
</li>
<li>Each byte is build up in the following way: S01234567PS<ol type="a">
<li>S=Start bit (always 1)</li>
<li>0=data bit (LSB)</li>
<li>1-6=data</li>
<li>7=data (MSB)</li>
<li>P=parity bit</li>
<li>S=stop bit (always 1)</li>
</ol>
</li>
</ul>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000088">Todo:</a></b></dt><dd><p class="startdd">Hier sollten die Bezeichnungen (apdu, ...) noch mal überarbeitet werden. Ziel sollte es sein diese aus der Spec zu entnehmen. </p>
<p>Reduce debugging again. </p>
<p class="enddd">Handle group address zero which is a broadcast to all devices. </p>
</dd></dl>
<hr/><h2>Define Documentation</h2>
<a class="anchor" id="a13b38c2f32cb6fdf9e18f62e5dce75c6"></a><!-- doxytag: member="fb_prot.c::MSG_BRC" ref="a13b38c2f32cb6fdf9e18f62e5dce75c6" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define MSG_BRC&#160;&#160;&#160;(1&lt;&lt;7)</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Broadcast adress, one-to-all conenction-less. </p>

<p>Referenced by <a class="el" href="fb__prot_8c.html#af4f820be8f1240cee6515133062a2e93">check_addr()</a>, and <a class="el" href="fb__prot_8c.html#a349ae562a88e3299f95943d9dcc2d794">fbprot_msg_handler()</a>.</p>

</div>
</div>
<a class="anchor" id="a253031b1534db6709a48eb59e440b801"></a><!-- doxytag: member="fb_prot.c::MSG_CON" ref="a253031b1534db6709a48eb59e440b801" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define MSG_CON&#160;&#160;&#160;(1&lt;&lt;5)</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>connect request </p>

<p>Referenced by <a class="el" href="fb__prot_8c.html#af4f820be8f1240cee6515133062a2e93">check_addr()</a>.</p>

</div>
</div>
<a class="anchor" id="af4b7d60452ebd8d0355291bd3b720e39"></a><!-- doxytag: member="fb_prot.c::MSG_DAF" ref="af4b7d60452ebd8d0355291bd3b720e39" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define MSG_DAF&#160;&#160;&#160;(1&lt;&lt;1)</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Direct adressing, one-to-one. </p>

<p>Referenced by <a class="el" href="fb__prot_8c.html#af4f820be8f1240cee6515133062a2e93">check_addr()</a>.</p>

</div>
</div>
<a class="anchor" id="ac7d0d9a9ace91de05ac02191bd7a1aa8"></a><!-- doxytag: member="fb_prot.c::MSG_DIS" ref="ac7d0d9a9ace91de05ac02191bd7a1aa8" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define MSG_DIS&#160;&#160;&#160;(1&lt;&lt;4)</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>disconnect request </p>

<p>Referenced by <a class="el" href="fb__prot_8c.html#af4f820be8f1240cee6515133062a2e93">check_addr()</a>.</p>

</div>
</div>
<a class="anchor" id="ab3b0799fb79aec4bb06d92b4770139f9"></a><!-- doxytag: member="fb_prot.c::MSG_GRP" ref="ab3b0799fb79aec4bb06d92b4770139f9" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define MSG_GRP&#160;&#160;&#160;(1&lt;&lt;6)</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Group adress. </p>

<p>Referenced by <a class="el" href="fb__prot_8c.html#af4f820be8f1240cee6515133062a2e93">check_addr()</a>, and <a class="el" href="fb__prot_8c.html#a349ae562a88e3299f95943d9dcc2d794">fbprot_msg_handler()</a>.</p>

</div>
</div>
<a class="anchor" id="ad01f913d138227e2b4fc4dd2ca904f07"></a><!-- doxytag: member="fb_prot.c::MSG_MUL" ref="ad01f913d138227e2b4fc4dd2ca904f07" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define MSG_MUL&#160;&#160;&#160;(1&lt;&lt;1)</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Multicast address, one-to-many, connection-less. </p>

</div>
</div>
<hr/><h2>Function Documentation</h2>
<a class="anchor" id="a4a0be801ed4f2d9b2cbce548adf56a76"></a><!-- doxytag: member="fb_prot.c::A_ADC_Read" ref="a4a0be801ed4f2d9b2cbce548adf56a76" args="(struct msg *rxmsg)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static uint8_t A_ADC_Read </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structmsg.html">msg</a> *&#160;</td>
          <td class="paramname"> <em>rxmsg</em>&#160;)</td>
          <td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Read the values from the ADC converter. </p>
<p>We don't have that so it is only a dummy to speed up programming and reading of the devices.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">rxmsg</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd></dd></dl>

<p>References <a class="el" href="structfbus__hdr.html#ad851123f6d3d388bcd224e7da9c22669">fbus_hdr::apci</a>, <a class="el" href="structucd__stat.html#a9ff1c79502044d630150467c79c5105e">ucd_stat::count</a>, <a class="el" href="structmsg.html#a4d5d84257dfd217679a22a7d2ff9dd6f">msg::data</a>, <a class="el" href="fb_8h.html#a1b0499c100f686fe464f9f139e6fa98d">FB_ACK</a>, <a class="el" href="fb__hal_8h.html#af70a4606fe5ce0777a371e0c6c3540fb">fb_hal_txqueue_msg()</a>, <a class="el" href="fb__prot_8c.html#a1ca66f4c62a2c7c7ff2c8ebef64465da">fb_new_msg()</a>, <a class="el" href="fb_8h.html#a4aff7801c9ec9dee2fb54a0c4970335c">FB_NONE</a>, <a class="el" href="fb__hal_8h.html#a3e4f31f4b97d833e7ef5fb9615def386">fb_send_ack()</a>, <a class="el" href="fb__prot_8c.html#a440973c20d3055721521a359aee68536">ncd_resp()</a>, <a class="el" href="structfbus__hdr.html#a7fe9afaff390f35dc2dbde5c1adb91f0">fbus_hdr::npci</a>, <a class="el" href="structfbus__hdr.html#a60845bb16d8af17fd0b699cde499d7ad">fbus_hdr::src</a>, <a class="el" href="structfbus__hdr.html#ab011cf810d4a1ed6a2ef9b24121ea737">fbus_hdr::tpci</a>, and <a class="el" href="fb__prot_8c.html#a5299818938807c9ebc199b66cbc01958">ucd</a>.</p>

<p><!-- startSectionHeader --><div class="dynheader">
Here is the call graph for this function:<!-- endSectionHeader --></div>
<!-- startSectionSummary --><!-- endSectionSummary --><!-- startSectionContent --><div class="dyncontent">
<div class="center"><img src="fb__prot_8c_a4a0be801ed4f2d9b2cbce548adf56a76_cgraph.png" border="0" usemap="#fb__prot_8c_a4a0be801ed4f2d9b2cbce548adf56a76_cgraph" alt=""/></div>
<map name="fb__prot_8c_a4a0be801ed4f2d9b2cbce548adf56a76_cgraph" id="fb__prot_8c_a4a0be801ed4f2d9b2cbce548adf56a76_cgraph">
<area shape="rect" id="node3" href="fb__hal_8h.html#af70a4606fe5ce0777a371e0c6c3540fb" title="Queue message for sending." alt="" coords="309,5,464,35"/><area shape="rect" id="node7" href="fb__prot_8c.html#a1ca66f4c62a2c7c7ff2c8ebef64465da" title="Create a new telegram and and return pointer to it." alt="" coords="336,84,437,113"/><area shape="rect" id="node11" href="fb__hal_8h.html#a3e4f31f4b97d833e7ef5fb9615def386" title="Function to set the ack value for the response to a telegram which must be send in a absolutly excat ..." alt="" coords="160,84,261,113"/><area shape="rect" id="node13" href="fb__prot_8c.html#a440973c20d3055721521a359aee68536" title="Sicherungslayer." alt="" coords="171,31,251,60"/><area shape="rect" id="node5" href="msg__queue_8h.html#af35d846267d1aaaf1df04c8bff03047e" title="Add a new message to the message queue." alt="" coords="512,5,603,35"/><area shape="rect" id="node9" href="msg__queue_8h.html#aa3b6fa424df78c0dbbbaa16a7dd32acb" title="Allocate space for a message and return a pointer to it." alt="" coords="517,84,597,113"/></map>
<!-- endSectionContent --></div>
</p>

</div>
</div>
<a class="anchor" id="a37d55968595e78e21dc1dba21418acf4"></a><!-- doxytag: member="fb_prot.c::A_DeviceDescriptor_Read" ref="a37d55968595e78e21dc1dba21418acf4" args="(struct msg *rxmsg)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static uint8_t A_DeviceDescriptor_Read </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structmsg.html">msg</a> *&#160;</td>
          <td class="paramname"> <em>rxmsg</em>&#160;)</td>
          <td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Is called if information for the BCU type is requested. </p>
<p>Function triggers a send which return information about the BCU.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">rxmsg</td><td>Pointer to received telegram</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>FB_ACK: everything is fine, FB_NONE: Response telegram could not be created </dd></dl>

<p>References <a class="el" href="structfbus__hdr.html#ad851123f6d3d388bcd224e7da9c22669">fbus_hdr::apci</a>, <a class="el" href="structmsg.html#a4d5d84257dfd217679a22a7d2ff9dd6f">msg::data</a>, <a class="el" href="fb_8h.html#a1b0499c100f686fe464f9f139e6fa98d">FB_ACK</a>, <a class="el" href="fb__hal_8h.html#af70a4606fe5ce0777a371e0c6c3540fb">fb_hal_txqueue_msg()</a>, <a class="el" href="fb__prot_8c.html#a1ca66f4c62a2c7c7ff2c8ebef64465da">fb_new_msg()</a>, <a class="el" href="fb_8h.html#a4aff7801c9ec9dee2fb54a0c4970335c">FB_NONE</a>, <a class="el" href="fb__hal_8h.html#a3e4f31f4b97d833e7ef5fb9615def386">fb_send_ack()</a>, <a class="el" href="fb__prot_8c.html#a440973c20d3055721521a359aee68536">ncd_resp()</a>, <a class="el" href="structfbus__hdr.html#a7fe9afaff390f35dc2dbde5c1adb91f0">fbus_hdr::npci</a>, <a class="el" href="structfbus__hdr.html#a60845bb16d8af17fd0b699cde499d7ad">fbus_hdr::src</a>, and <a class="el" href="structfbus__hdr.html#ab011cf810d4a1ed6a2ef9b24121ea737">fbus_hdr::tpci</a>.</p>

<p><!-- startSectionHeader --><div class="dynheader">
Here is the call graph for this function:<!-- endSectionHeader --></div>
<!-- startSectionSummary --><!-- endSectionSummary --><!-- startSectionContent --><div class="dyncontent">
<div class="center"><img src="fb__prot_8c_a37d55968595e78e21dc1dba21418acf4_cgraph.png" border="0" usemap="#fb__prot_8c_a37d55968595e78e21dc1dba21418acf4_cgraph" alt=""/></div>
<map name="fb__prot_8c_a37d55968595e78e21dc1dba21418acf4_cgraph" id="fb__prot_8c_a37d55968595e78e21dc1dba21418acf4_cgraph">
<area shape="rect" id="node3" href="fb__hal_8h.html#af70a4606fe5ce0777a371e0c6c3540fb" title="Queue message for sending." alt="" coords="389,5,544,35"/><area shape="rect" id="node7" href="fb__prot_8c.html#a1ca66f4c62a2c7c7ff2c8ebef64465da" title="Create a new telegram and and return pointer to it." alt="" coords="416,84,517,113"/><area shape="rect" id="node11" href="fb__hal_8h.html#a3e4f31f4b97d833e7ef5fb9615def386" title="Function to set the ack value for the response to a telegram which must be send in a absolutly excat ..." alt="" coords="240,84,341,113"/><area shape="rect" id="node13" href="fb__prot_8c.html#a440973c20d3055721521a359aee68536" title="Sicherungslayer." alt="" coords="251,31,331,60"/><area shape="rect" id="node5" href="msg__queue_8h.html#af35d846267d1aaaf1df04c8bff03047e" title="Add a new message to the message queue." alt="" coords="592,5,683,35"/><area shape="rect" id="node9" href="msg__queue_8h.html#aa3b6fa424df78c0dbbbaa16a7dd32acb" title="Allocate space for a message and return a pointer to it." alt="" coords="597,84,677,113"/></map>
<!-- endSectionContent --></div>
</p>

</div>
</div>
<a class="anchor" id="ae56aada1e48493023c8f3ecf7a1e71a7"></a><!-- doxytag: member="fb_prot.c::A_GroupValue_Read" ref="ae56aada1e48493023c8f3ecf7a1e71a7" args="(struct msg *rxmsg)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static uint8_t A_GroupValue_Read </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structmsg.html">msg</a> *&#160;</td>
          <td class="paramname"> <em>rxmsg</em>&#160;)</td>
          <td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>A read request to the application. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">rxmsg</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd></dd></dl>

<p>References <a class="el" href="fb__prot_8h.html#a36e1203bd35757a2d24c7a7488dc39e2">APPLICATION_RUN_STATUS</a>, <a class="el" href="freebus-debug_8h.html#a992e66debf91a3c70533bbae6b5a046a">DEBUG_NEWLINE</a>, <a class="el" href="freebus-debug_8h.html#a9f481e1a0f65900c41f6e6cad5ddce21">DEBUG_PUTS</a>, <a class="el" href="fb_8h.html#a1b0499c100f686fe464f9f139e6fa98d">FB_ACK</a>, <a class="el" href="fb_8h.html#a28bf3ec6797a7edcdaec064eb474e2bb">FB_NACK</a>, <a class="el" href="fb__hal_8h.html#a3e4f31f4b97d833e7ef5fb9615def386">fb_send_ack()</a>, <a class="el" href="fb__eeprom_8h.html#a9eb1d517bad2009ea1fcaa3dfb8d87f2">mem_ReadByte()</a>, and <a class="el" href="fb__adc_8c.html#acdb92216340d9fc010cc12bbb44bbfb2">readApplication()</a>.</p>

<p><!-- startSectionHeader --><div class="dynheader">
Here is the call graph for this function:<!-- endSectionHeader --></div>
<!-- startSectionSummary --><!-- endSectionSummary --><!-- startSectionContent --><div class="dyncontent">
<div class="center"><img src="fb__prot_8c_ae56aada1e48493023c8f3ecf7a1e71a7_cgraph.png" border="0" usemap="#fb__prot_8c_ae56aada1e48493023c8f3ecf7a1e71a7_cgraph" alt=""/></div>
<map name="fb__prot_8c_ae56aada1e48493023c8f3ecf7a1e71a7_cgraph" id="fb__prot_8c_ae56aada1e48493023c8f3ecf7a1e71a7_cgraph">
<area shape="rect" id="node3" href="fb__hal_8h.html#a3e4f31f4b97d833e7ef5fb9615def386" title="Function to set the ack value for the response to a telegram which must be send in a absolutly excat ..." alt="" coords="217,5,319,35"/><area shape="rect" id="node5" href="fb__eeprom_8h.html#a9eb1d517bad2009ea1fcaa3dfb8d87f2" title="Read data from the eeprom cache and return it." alt="" coords="207,59,329,88"/><area shape="rect" id="node7" href="fb__adc_8c.html#acdb92216340d9fc010cc12bbb44bbfb2" title="Read status from port and return it." alt="" coords="208,112,328,141"/></map>
<!-- endSectionContent --></div>
</p>

</div>
</div>
<a class="anchor" id="abb5d4fc672e3e3e123f5f3e6e9f901e3"></a><!-- doxytag: member="fb_prot.c::A_GroupValue_Write" ref="abb5d4fc672e3e3e123f5f3e6e9f901e3" args="(struct msg *rxmsg)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static uint8_t A_GroupValue_Write </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structmsg.html">msg</a> *&#160;</td>
          <td class="paramname"> <em>rxmsg</em>&#160;)</td>
          <td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Is called if a broadcast is received with a matching group address (eg. </p>
<p>button is pressed to switch relais on or off).</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">rxmsg</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000093">Todo:</a></b></dt><dd>handle message shorter then 6-bit</dd></dl>
<dl class="return"><dt><b>Returns:</b></dt><dd></dd></dl>

<p>References <a class="el" href="fb__prot_8h.html#a36e1203bd35757a2d24c7a7488dc39e2">APPLICATION_RUN_STATUS</a>, <a class="el" href="fb_8h.html#a1b0499c100f686fe464f9f139e6fa98d">FB_ACK</a>, <a class="el" href="fb_8h.html#a28bf3ec6797a7edcdaec064eb474e2bb">FB_NACK</a>, <a class="el" href="fb__hal_8h.html#a3e4f31f4b97d833e7ef5fb9615def386">fb_send_ack()</a>, <a class="el" href="fb__eeprom_8h.html#a9eb1d517bad2009ea1fcaa3dfb8d87f2">mem_ReadByte()</a>, and <a class="el" href="fb__adc_8c.html#a30773cfc4105728c9628fca36c8c7c20">runApplication()</a>.</p>

<p><!-- startSectionHeader --><div class="dynheader">
Here is the call graph for this function:<!-- endSectionHeader --></div>
<!-- startSectionSummary --><!-- endSectionSummary --><!-- startSectionContent --><div class="dyncontent">
<div class="center"><img src="fb__prot_8c_abb5d4fc672e3e3e123f5f3e6e9f901e3_cgraph.png" border="0" usemap="#fb__prot_8c_abb5d4fc672e3e3e123f5f3e6e9f901e3_cgraph" alt=""/></div>
<map name="fb__prot_8c_abb5d4fc672e3e3e123f5f3e6e9f901e3_cgraph" id="fb__prot_8c_abb5d4fc672e3e3e123f5f3e6e9f901e3_cgraph">
<area shape="rect" id="node3" href="fb__hal_8h.html#a3e4f31f4b97d833e7ef5fb9615def386" title="Function to set the ack value for the response to a telegram which must be send in a absolutly excat ..." alt="" coords="217,5,319,35"/><area shape="rect" id="node5" href="fb__eeprom_8h.html#a9eb1d517bad2009ea1fcaa3dfb8d87f2" title="Read data from the eeprom cache and return it." alt="" coords="207,59,329,88"/><area shape="rect" id="node7" href="fb__adc_8c.html#a30773cfc4105728c9628fca36c8c7c20" title="Function is called if A_GroupValue_Write is received." alt="" coords="212,112,324,141"/></map>
<!-- endSectionContent --></div>
</p>

</div>
</div>
<a class="anchor" id="af2931210aae10a2c39698d2f1fb3c98c"></a><!-- doxytag: member="fb_prot.c::A_Memory_Read" ref="af2931210aae10a2c39698d2f1fb3c98c" args="(struct msg *rxmsg)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static uint8_t A_Memory_Read </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structmsg.html">msg</a> *&#160;</td>
          <td class="paramname"> <em>rxmsg</em>&#160;)</td>
          <td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Read data from eeprom and return send it as telegram back to the requester. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">rxmsg</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd></dd></dl>

<p>References <a class="el" href="structfbus__hdr.html#ad851123f6d3d388bcd224e7da9c22669">fbus_hdr::apci</a>, <a class="el" href="structucd__stat.html#a9ff1c79502044d630150467c79c5105e">ucd_stat::count</a>, <a class="el" href="structmsg.html#a4d5d84257dfd217679a22a7d2ff9dd6f">msg::data</a>, <a class="el" href="fb_8h.html#a1b0499c100f686fe464f9f139e6fa98d">FB_ACK</a>, <a class="el" href="fb__hal_8h.html#af70a4606fe5ce0777a371e0c6c3540fb">fb_hal_txqueue_msg()</a>, <a class="el" href="fb__prot_8c.html#a1ca66f4c62a2c7c7ff2c8ebef64465da">fb_new_msg()</a>, <a class="el" href="fb_8h.html#a4aff7801c9ec9dee2fb54a0c4970335c">FB_NONE</a>, <a class="el" href="fb__hal_8h.html#a3e4f31f4b97d833e7ef5fb9615def386">fb_send_ack()</a>, <a class="el" href="structmsg.html#a9f80ed48480c54a999ac13700287f880">msg::len</a>, <a class="el" href="fb__eeprom_8h.html#a9eb1d517bad2009ea1fcaa3dfb8d87f2">mem_ReadByte()</a>, <a class="el" href="fb__prot_8c.html#a440973c20d3055721521a359aee68536">ncd_resp()</a>, <a class="el" href="structfbus__hdr.html#a7fe9afaff390f35dc2dbde5c1adb91f0">fbus_hdr::npci</a>, <a class="el" href="structfbus__hdr.html#a60845bb16d8af17fd0b699cde499d7ad">fbus_hdr::src</a>, <a class="el" href="structfbus__hdr.html#ab011cf810d4a1ed6a2ef9b24121ea737">fbus_hdr::tpci</a>, and <a class="el" href="fb__prot_8c.html#a5299818938807c9ebc199b66cbc01958">ucd</a>.</p>

<p><!-- startSectionHeader --><div class="dynheader">
Here is the call graph for this function:<!-- endSectionHeader --></div>
<!-- startSectionSummary --><!-- endSectionSummary --><!-- startSectionContent --><div class="dyncontent">
<div class="center"><img src="fb__prot_8c_af2931210aae10a2c39698d2f1fb3c98c_cgraph.png" border="0" usemap="#fb__prot_8c_af2931210aae10a2c39698d2f1fb3c98c_cgraph" alt=""/></div>
<map name="fb__prot_8c_af2931210aae10a2c39698d2f1fb3c98c_cgraph" id="fb__prot_8c_af2931210aae10a2c39698d2f1fb3c98c_cgraph">
<area shape="rect" id="node3" href="fb__hal_8h.html#af70a4606fe5ce0777a371e0c6c3540fb" title="Queue message for sending." alt="" coords="357,7,512,37"/><area shape="rect" id="node7" href="fb__prot_8c.html#a1ca66f4c62a2c7c7ff2c8ebef64465da" title="Create a new telegram and and return pointer to it." alt="" coords="384,113,485,142"/><area shape="rect" id="node11" href="fb__hal_8h.html#a3e4f31f4b97d833e7ef5fb9615def386" title="Function to set the ack value for the response to a telegram which must be send in a absolutly excat ..." alt="" coords="196,86,297,115"/><area shape="rect" id="node13" href="fb__eeprom_8h.html#a9eb1d517bad2009ea1fcaa3dfb8d87f2" title="Read data from the eeprom cache and return it." alt="" coords="185,139,308,169"/><area shape="rect" id="node15" href="fb__prot_8c.html#a440973c20d3055721521a359aee68536" title="Sicherungslayer." alt="" coords="207,33,287,62"/><area shape="rect" id="node5" href="msg__queue_8h.html#af35d846267d1aaaf1df04c8bff03047e" title="Add a new message to the message queue." alt="" coords="560,7,651,37"/><area shape="rect" id="node9" href="msg__queue_8h.html#aa3b6fa424df78c0dbbbaa16a7dd32acb" title="Allocate space for a message and return a pointer to it." alt="" coords="565,113,645,142"/></map>
<!-- endSectionContent --></div>
</p>

</div>
</div>
<a class="anchor" id="afae8acdc71d1ebff494c621459c097cf"></a><!-- doxytag: member="fb_prot.c::A_Memory_Write" ref="afae8acdc71d1ebff494c621459c097cf" args="(struct msg *rxmsg)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static uint8_t A_Memory_Write </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structmsg.html">msg</a> *&#160;</td>
          <td class="paramname"> <em>rxmsg</em>&#160;)</td>
          <td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Write recieved data to the eeprom. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">rxmsg</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd></dd></dl>

<p>References <a class="el" href="structfbus__hdr.html#ad851123f6d3d388bcd224e7da9c22669">fbus_hdr::apci</a>, <a class="el" href="structmsg.html#a4d5d84257dfd217679a22a7d2ff9dd6f">msg::data</a>, <a class="el" href="fb_8h.html#a1b0499c100f686fe464f9f139e6fa98d">FB_ACK</a>, <a class="el" href="fb__hal_8h.html#a3e4f31f4b97d833e7ef5fb9615def386">fb_send_ack()</a>, <a class="el" href="fb__eeprom_8h.html#a734ed3d1f9147def7f23ae10c7156e92">mem_WriteBlock()</a>, and <a class="el" href="fb__prot_8c.html#a440973c20d3055721521a359aee68536">ncd_resp()</a>.</p>

<p><!-- startSectionHeader --><div class="dynheader">
Here is the call graph for this function:<!-- endSectionHeader --></div>
<!-- startSectionSummary --><!-- endSectionSummary --><!-- startSectionContent --><div class="dyncontent">
<div class="center"><img src="fb__prot_8c_afae8acdc71d1ebff494c621459c097cf_cgraph.png" border="0" usemap="#fb__prot_8c_afae8acdc71d1ebff494c621459c097cf_cgraph" alt=""/></div>
<map name="fb__prot_8c_afae8acdc71d1ebff494c621459c097cf_cgraph" id="fb__prot_8c_afae8acdc71d1ebff494c621459c097cf_cgraph">
<area shape="rect" id="node3" href="fb__hal_8h.html#a3e4f31f4b97d833e7ef5fb9615def386" title="Function to set the ack value for the response to a telegram which must be send in a absolutly excat ..." alt="" coords="199,31,300,60"/><area shape="rect" id="node5" href="fb__eeprom_8h.html#a734ed3d1f9147def7f23ae10c7156e92" title="Write data to the eeprom cache and trigger background process to write eeprom cache to real eeprom..." alt="" coords="185,84,313,113"/><area shape="rect" id="node15" href="fb__prot_8c.html#a440973c20d3055721521a359aee68536" title="Sicherungslayer." alt="" coords="209,163,289,192"/><area shape="rect" id="node7" href="msg__queue_8h.html#aadc5609c7a2263c8cae4ab0d8eae7c4d" title="Allocate a new message." alt="" coords="401,59,479,88"/><area shape="rect" id="node11" href="msg__queue_8h.html#af35d846267d1aaaf1df04c8bff03047e" title="Add a new message to the message queue." alt="" coords="565,164,656,193"/><area shape="rect" id="node13" href="fb__eeprom_8c.html#ac92e88b86efd0e0e32beaee667bfc226" title="Start to write the first byte to eeprom." alt="" coords="380,5,500,35"/><area shape="rect" id="node9" href="msg__queue_8h.html#aa3b6fa424df78c0dbbbaa16a7dd32acb" title="Allocate space for a message and return a pointer to it." alt="" coords="571,111,651,140"/><area shape="rect" id="node17" href="fb__hal_8h.html#af70a4606fe5ce0777a371e0c6c3540fb" title="Queue message for sending." alt="" coords="363,216,517,245"/><area shape="rect" id="node20" href="fb__prot_8c.html#a1ca66f4c62a2c7c7ff2c8ebef64465da" title="Create a new telegram and and return pointer to it." alt="" coords="389,163,491,192"/></map>
<!-- endSectionContent --></div>
</p>

</div>
</div>
<a class="anchor" id="ae42ed05d4ccf0a841bdaa32fe7af4478"></a><!-- doxytag: member="fb_prot.c::A_PhysicalAddress_Read" ref="ae42ed05d4ccf0a841bdaa32fe7af4478" args="(struct msg *rxmsg)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static uint8_t A_PhysicalAddress_Read </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structmsg.html">msg</a> *&#160;</td>
          <td class="paramname"> <em>rxmsg</em>&#160;)</td>
          <td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Returns the address of the device. </p>
<p>The device must be in programming mode for this. Only one device can be in programming mode. See 3.2.2 in EIB specification</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">rxmsg</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd></dd></dl>

<p>References <a class="el" href="structfbus__hdr.html#ad851123f6d3d388bcd224e7da9c22669">fbus_hdr::apci</a>, <a class="el" href="structfbus__hdr.html#ac495b44f58807e4c580231c2ee426bcc">fbus_hdr::ctrl</a>, <a class="el" href="structmsg.html#a4d5d84257dfd217679a22a7d2ff9dd6f">msg::data</a>, <a class="el" href="fb_8h.html#a1b0499c100f686fe464f9f139e6fa98d">FB_ACK</a>, <a class="el" href="fb__hal_8h.html#af70a4606fe5ce0777a371e0c6c3540fb">fb_hal_txqueue_msg()</a>, <a class="el" href="fb__prot_8c.html#a1ca66f4c62a2c7c7ff2c8ebef64465da">fb_new_msg()</a>, <a class="el" href="fb__hal_8h.html#a3e4f31f4b97d833e7ef5fb9615def386">fb_send_ack()</a>, <a class="el" href="fb_8h.html#aff0cdfa8a30dbfdad5cc03301ba601ff">SS_PROG</a>, <a class="el" href="fb__hal_8h.html#a53ac9c8b9cfb94746b9f5b39bf152620">systemState</a>, and <a class="el" href="structfbus__hdr.html#ab011cf810d4a1ed6a2ef9b24121ea737">fbus_hdr::tpci</a>.</p>

<p><!-- startSectionHeader --><div class="dynheader">
Here is the call graph for this function:<!-- endSectionHeader --></div>
<!-- startSectionSummary --><!-- endSectionSummary --><!-- startSectionContent --><div class="dyncontent">
<div class="center"><img src="fb__prot_8c_ae42ed05d4ccf0a841bdaa32fe7af4478_cgraph.png" border="0" usemap="#fb__prot_8c_ae42ed05d4ccf0a841bdaa32fe7af4478_cgraph" alt=""/></div>
<map name="fb__prot_8c_ae42ed05d4ccf0a841bdaa32fe7af4478_cgraph" id="fb__prot_8c_ae42ed05d4ccf0a841bdaa32fe7af4478_cgraph">
<area shape="rect" id="node3" href="fb__hal_8h.html#af70a4606fe5ce0777a371e0c6c3540fb" title="Queue message for sending." alt="" coords="235,5,389,35"/><area shape="rect" id="node7" href="fb__prot_8c.html#a1ca66f4c62a2c7c7ff2c8ebef64465da" title="Create a new telegram and and return pointer to it." alt="" coords="261,59,363,88"/><area shape="rect" id="node11" href="fb__hal_8h.html#a3e4f31f4b97d833e7ef5fb9615def386" title="Function to set the ack value for the response to a telegram which must be send in a absolutly excat ..." alt="" coords="261,112,363,141"/><area shape="rect" id="node5" href="msg__queue_8h.html#af35d846267d1aaaf1df04c8bff03047e" title="Add a new message to the message queue." alt="" coords="437,5,528,35"/><area shape="rect" id="node9" href="msg__queue_8h.html#aa3b6fa424df78c0dbbbaa16a7dd32acb" title="Allocate space for a message and return a pointer to it." alt="" coords="443,59,523,88"/></map>
<!-- endSectionContent --></div>
</p>

</div>
</div>
<a class="anchor" id="ac3b30c7591e51974ab895440929395c6"></a><!-- doxytag: member="fb_prot.c::A_PhysicalAddress_Write" ref="ac3b30c7591e51974ab895440929395c6" args="(struct msg *rxmsg)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static uint8_t A_PhysicalAddress_Write </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structmsg.html">msg</a> *&#160;</td>
          <td class="paramname"> <em>rxmsg</em>&#160;)</td>
          <td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Set the received address as our new device address. </p>
<p>For this function the device must be in programming mode. Only one device can be in programming mode. See 3.2.1 in EIB specification.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">rxmsg</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd></dd></dl>

<p>References <a class="el" href="fb__eeprom_8h.html#a27e2dbb193fe9e6cfbf74e9103117fcf">BASE_ADDRESS_OFFSET</a>, <a class="el" href="structmsg.html#a4d5d84257dfd217679a22a7d2ff9dd6f">msg::data</a>, <a class="el" href="fb_8h.html#a1b0499c100f686fe464f9f139e6fa98d">FB_ACK</a>, <a class="el" href="fb_8h.html#a4aff7801c9ec9dee2fb54a0c4970335c">FB_NONE</a>, <a class="el" href="fb__hal_8h.html#a3e4f31f4b97d833e7ef5fb9615def386">fb_send_ack()</a>, <a class="el" href="fb__eeprom_8h.html#a734ed3d1f9147def7f23ae10c7156e92">mem_WriteBlock()</a>, <a class="el" href="fb__eeprom_8h.html#adfc8790bc691a72a03b40b7641801fb6">NODEPARAM_SIZE</a>, <a class="el" href="fb__prot_8h.html#a694e1f79998d52c33dbb7ed4c23ccf57">pa</a>, <a class="el" href="fb__prot_8h.html#a05146ed1759ff141e4e78a9739ff1bdb">PA_ADDRESS_HIGH</a>, <a class="el" href="fb_8h.html#aff0cdfa8a30dbfdad5cc03301ba601ff">SS_PROG</a>, and <a class="el" href="fb__hal_8h.html#a53ac9c8b9cfb94746b9f5b39bf152620">systemState</a>.</p>

<p><!-- startSectionHeader --><div class="dynheader">
Here is the call graph for this function:<!-- endSectionHeader --></div>
<!-- startSectionSummary --><!-- endSectionSummary --><!-- startSectionContent --><div class="dyncontent">
<div class="center"><img src="fb__prot_8c_ac3b30c7591e51974ab895440929395c6_cgraph.png" border="0" usemap="#fb__prot_8c_ac3b30c7591e51974ab895440929395c6_cgraph" alt=""/></div>
<map name="fb__prot_8c_ac3b30c7591e51974ab895440929395c6_cgraph" id="fb__prot_8c_ac3b30c7591e51974ab895440929395c6_cgraph">
<area shape="rect" id="node3" href="fb__hal_8h.html#a3e4f31f4b97d833e7ef5fb9615def386" title="Function to set the ack value for the response to a telegram which must be send in a absolutly excat ..." alt="" coords="249,5,351,35"/><area shape="rect" id="node5" href="fb__eeprom_8h.html#a734ed3d1f9147def7f23ae10c7156e92" title="Write data to the eeprom cache and trigger background process to write eeprom cache to real eeprom..." alt="" coords="236,59,364,88"/><area shape="rect" id="node7" href="msg__queue_8h.html#aadc5609c7a2263c8cae4ab0d8eae7c4d" title="Allocate a new message." alt="" coords="436,5,513,35"/><area shape="rect" id="node11" href="msg__queue_8h.html#af35d846267d1aaaf1df04c8bff03047e" title="Add a new message to the message queue." alt="" coords="429,59,520,88"/><area shape="rect" id="node13" href="fb__eeprom_8c.html#ac92e88b86efd0e0e32beaee667bfc226" title="Start to write the first byte to eeprom." alt="" coords="415,112,535,141"/><area shape="rect" id="node9" href="msg__queue_8h.html#aa3b6fa424df78c0dbbbaa16a7dd32acb" title="Allocate space for a message and return a pointer to it." alt="" coords="585,5,665,35"/></map>
<!-- endSectionContent --></div>
</p>

</div>
</div>
<a class="anchor" id="a088341f3603f5de9eb4817a8199391c6"></a><!-- doxytag: member="fb_prot.c::A_Restart" ref="a088341f3603f5de9eb4817a8199391c6" args="(struct msg *rxmsg)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static uint8_t A_Restart </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structmsg.html">msg</a> *&#160;</td>
          <td class="paramname"> <em>rxmsg</em>&#160;)</td>
          <td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Restart the program on the microcontroller. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">rxmsg</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd></dd></dl>

<p>References <a class="el" href="freebus-debug_8h.html#ad8d82a47e19a599b0cca4140ed6b7c86">DEBUG_PUTC</a>, <a class="el" href="fb__eeprom_8h.html#a7bf612843223717f1d420610cbd12d6e">eeprom_busy()</a>, and <a class="el" href="fb__hal_8h.html#a4111a79334fb10bc9c786f510256c20b">fb_hal_restart()</a>.</p>

<p><!-- startSectionHeader --><div class="dynheader">
Here is the call graph for this function:<!-- endSectionHeader --></div>
<!-- startSectionSummary --><!-- endSectionSummary --><!-- startSectionContent --><div class="dyncontent">
<div class="center"><img src="fb__prot_8c_a088341f3603f5de9eb4817a8199391c6_cgraph.png" border="0" usemap="#fb__prot_8c_a088341f3603f5de9eb4817a8199391c6_cgraph" alt=""/></div>
<map name="fb__prot_8c_a088341f3603f5de9eb4817a8199391c6_cgraph" id="fb__prot_8c_a088341f3603f5de9eb4817a8199391c6_cgraph">
<area shape="rect" id="node3" href="fb__eeprom_8h.html#a7bf612843223717f1d420610cbd12d6e" title="Check if eeprom cache was written completely to eeprom." alt="" coords="135,5,233,35"/><area shape="rect" id="node5" href="fb__hal_8h.html#a4111a79334fb10bc9c786f510256c20b" title="Restart the application by activating the watchdog and block the program." alt="" coords="135,59,233,88"/></map>
<!-- endSectionContent --></div>
</p>

</div>
</div>
<a class="anchor" id="af4f820be8f1240cee6515133062a2e93"></a><!-- doxytag: member="fb_prot.c::check_addr" ref="af4f820be8f1240cee6515133062a2e93" args="(struct fbus_hdr *hdr)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static uint8_t check_addr </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structfbus__hdr.html">fbus_hdr</a> *&#160;</td>
          <td class="paramname"> <em>hdr</em>&#160;)</td>
          <td><code> [inline, static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Analyse the type of the message (broadcast, direct, group address) and check for physical and group address if the telegram is for us. </p>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000094">Todo:</a></b></dt><dd>must we handle group address 0/0/0 here in a special way?</dd></dl>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">hdr</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd></dd></dl>

<p>References <a class="el" href="structgrp__addr__s.html#a76c51d2b8425bcfffb8b2dec126cbf1a">grp_addr_s::count</a>, <a class="el" href="structfbus__hdr.html#affac3a0c18c2fe2af1aaeccd2596cd5d">fbus_hdr::dest</a>, <a class="el" href="structgrp__addr__s.html#a4b12f8b029a5a4a7c86e14fc6e5f9243">grp_addr_s::ga</a>, <a class="el" href="fb__adc_8c.html#aae3c982e005b9e0659d533393720a7f8">grp_addr</a>, <a class="el" href="fb__prot_8c.html#a13b38c2f32cb6fdf9e18f62e5dce75c6">MSG_BRC</a>, <a class="el" href="fb__prot_8c.html#a253031b1534db6709a48eb59e440b801">MSG_CON</a>, <a class="el" href="fb__prot_8c.html#af4b7d60452ebd8d0355291bd3b720e39">MSG_DAF</a>, <a class="el" href="fb__prot_8c.html#ac7d0d9a9ace91de05ac02191bd7a1aa8">MSG_DIS</a>, <a class="el" href="fb__prot_8c.html#ab3b0799fb79aec4bb06d92b4770139f9">MSG_GRP</a>, <a class="el" href="structfbus__hdr.html#a7fe9afaff390f35dc2dbde5c1adb91f0">fbus_hdr::npci</a>, <a class="el" href="fb__prot_8h.html#a694e1f79998d52c33dbb7ed4c23ccf57">pa</a>, <a class="el" href="fb__prot_8h.html#ad331ea80e37048c176ce596bb3d50629">T_BROADCAST_DATA</a>, <a class="el" href="fb__prot_8h.html#a297dc1f48a8a663935fd48fcee8c464e">T_BROADCAST_DATA_MASK</a>, <a class="el" href="fb__prot_8h.html#a8c22ae32379fbc042fdfa61e1532a5b6">T_CONNECT_REQ</a>, <a class="el" href="fb__prot_8h.html#a1a2d34c9f5064c66717557b70def8bd7">T_CONNECT_REQ_MASK</a>, <a class="el" href="fb__prot_8h.html#a301dc9d6faf968b6037d221545281b34">T_DISCONNECT_REQ</a>, <a class="el" href="fb__prot_8h.html#a0383d85348bb259849f7258ace9ab7db">T_DISCONNECT_REQ_MASK</a>, and <a class="el" href="structfbus__hdr.html#ab011cf810d4a1ed6a2ef9b24121ea737">fbus_hdr::tpci</a>.</p>

<p>Referenced by <a class="el" href="fb__prot_8c.html#a349ae562a88e3299f95943d9dcc2d794">fbprot_msg_handler()</a>.</p>

<p><!-- startSectionHeader --><div class="dynheader">
Here is the caller graph for this function:<!-- endSectionHeader --></div>
<!-- startSectionSummary --><!-- endSectionSummary --><!-- startSectionContent --><div class="dyncontent">
<div class="center"><img src="fb__prot_8c_af4f820be8f1240cee6515133062a2e93_icgraph.png" border="0" usemap="#fb__prot_8c_af4f820be8f1240cee6515133062a2e93_icgraph" alt=""/></div>
<map name="fb__prot_8c_af4f820be8f1240cee6515133062a2e93_icgraph" id="fb__prot_8c_af4f820be8f1240cee6515133062a2e93_icgraph">
<area shape="rect" id="node3" href="fb__prot_8c.html#a349ae562a88e3299f95943d9dcc2d794" title="That function is called from main loop." alt="" coords="151,5,300,35"/><area shape="rect" id="node5" href="fb__in8__app_8c.html#a840291bc02cba5474a4cb46a9b9566fe" title="The start point of the program, init all libraries, start the bus interface, the application and chec..." alt="" coords="351,5,404,35"/></map>
<!-- endSectionContent --></div>
</p>

</div>
</div>
<a class="anchor" id="a3b07c15a969dbc529bb64de840ea56eb"></a><!-- doxytag: member="fb_prot.c::fb_handlemsg" ref="a3b07c15a969dbc529bb64de840ea56eb" args="(struct msg *rxmsg)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint8_t fb_handlemsg </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structmsg.html">msg</a> *&#160;</td>
          <td class="paramname"> <em>rxmsg</em>&#160;)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Queue message for handling. </p>
<p>That function will be called if a telegram was received completely.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">rxmsg</td><td>Pointer to message</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd></dd></dl>

<p>References <a class="el" href="msg__queue_8h.html#af35d846267d1aaaf1df04c8bff03047e">queuemsg()</a>.</p>

<p><!-- startSectionHeader --><div class="dynheader">
Here is the call graph for this function:<!-- endSectionHeader --></div>
<!-- startSectionSummary --><!-- endSectionSummary --><!-- startSectionContent --><div class="dyncontent">
<div class="center"><img src="fb__prot_8c_a3b07c15a969dbc529bb64de840ea56eb_cgraph.png" border="0" usemap="#fb__prot_8c_a3b07c15a969dbc529bb64de840ea56eb_cgraph" alt=""/></div>
<map name="fb__prot_8c_a3b07c15a969dbc529bb64de840ea56eb_cgraph" id="fb__prot_8c_a3b07c15a969dbc529bb64de840ea56eb_cgraph">
<area shape="rect" id="node3" href="msg__queue_8h.html#af35d846267d1aaaf1df04c8bff03047e" title="Add a new message to the message queue." alt="" coords="165,5,256,35"/></map>
<!-- endSectionContent --></div>
</p>

</div>
</div>
<a class="anchor" id="a1ca66f4c62a2c7c7ff2c8ebef64465da"></a><!-- doxytag: member="fb_prot.c::fb_new_msg" ref="a1ca66f4c62a2c7c7ff2c8ebef64465da" args="(uint8_t *dest, uint8_t payload_len)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static struct <a class="el" href="structmsg.html">msg</a> * fb_new_msg </td>
          <td>(</td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"> <em>dest</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"> <em>payload_len</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td><code> [static, read]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Create a new telegram and and return pointer to it. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">dest</td><td>Pointer to the destination address </td></tr>
    <tr><td class="paramname">payload_len</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd></dd></dl>

<p>References <a class="el" href="msg__queue_8h.html#aa3b6fa424df78c0dbbbaa16a7dd32acb">AllocMsgI()</a>, <a class="el" href="structfbus__hdr.html#ac495b44f58807e4c580231c2ee426bcc">fbus_hdr::ctrl</a>, <a class="el" href="structmsg.html#a4d5d84257dfd217679a22a7d2ff9dd6f">msg::data</a>, <a class="el" href="structfbus__hdr.html#affac3a0c18c2fe2af1aaeccd2596cd5d">fbus_hdr::dest</a>, <a class="el" href="structmsg.html#a9f80ed48480c54a999ac13700287f880">msg::len</a>, <a class="el" href="structfbus__hdr.html#a7fe9afaff390f35dc2dbde5c1adb91f0">fbus_hdr::npci</a>, <a class="el" href="fb__prot_8h.html#a694e1f79998d52c33dbb7ed4c23ccf57">pa</a>, <a class="el" href="structmsg.html#a9a24303b4435fd372af8703f37f1d299">msg::repeat</a>, and <a class="el" href="structfbus__hdr.html#a60845bb16d8af17fd0b699cde499d7ad">fbus_hdr::src</a>.</p>

<p>Referenced by <a class="el" href="fb__prot_8c.html#a4a0be801ed4f2d9b2cbce548adf56a76">A_ADC_Read()</a>, <a class="el" href="fb__prot_8c.html#a37d55968595e78e21dc1dba21418acf4">A_DeviceDescriptor_Read()</a>, <a class="el" href="fb__prot_8c.html#af2931210aae10a2c39698d2f1fb3c98c">A_Memory_Read()</a>, <a class="el" href="fb__prot_8c.html#ae42ed05d4ccf0a841bdaa32fe7af4478">A_PhysicalAddress_Read()</a>, and <a class="el" href="fb__prot_8c.html#a440973c20d3055721521a359aee68536">ncd_resp()</a>.</p>

<p><!-- startSectionHeader --><div class="dynheader">
Here is the call graph for this function:<!-- endSectionHeader --></div>
<!-- startSectionSummary --><!-- endSectionSummary --><!-- startSectionContent --><div class="dyncontent">
<div class="center"><img src="fb__prot_8c_a1ca66f4c62a2c7c7ff2c8ebef64465da_cgraph.png" border="0" usemap="#fb__prot_8c_a1ca66f4c62a2c7c7ff2c8ebef64465da_cgraph" alt=""/></div>
<map name="fb__prot_8c_a1ca66f4c62a2c7c7ff2c8ebef64465da_cgraph" id="fb__prot_8c_a1ca66f4c62a2c7c7ff2c8ebef64465da_cgraph">
<area shape="rect" id="node3" href="msg__queue_8h.html#aa3b6fa424df78c0dbbbaa16a7dd32acb" title="Allocate space for a message and return a pointer to it." alt="" coords="156,5,236,35"/></map>
<!-- endSectionContent --></div>
</p>

<p><!-- startSectionHeader --><div class="dynheader">
Here is the caller graph for this function:<!-- endSectionHeader --></div>
<!-- startSectionSummary --><!-- endSectionSummary --><!-- startSectionContent --><div class="dyncontent">
<div class="center"><img src="fb__prot_8c_a1ca66f4c62a2c7c7ff2c8ebef64465da_icgraph.png" border="0" usemap="#fb__prot_8c_a1ca66f4c62a2c7c7ff2c8ebef64465da_icgraph" alt=""/></div>
<map name="fb__prot_8c_a1ca66f4c62a2c7c7ff2c8ebef64465da_icgraph" id="fb__prot_8c_a1ca66f4c62a2c7c7ff2c8ebef64465da_icgraph">
<area shape="rect" id="node3" href="fb__prot_8c.html#a4a0be801ed4f2d9b2cbce548adf56a76" title="Read the values from the ADC converter." alt="" coords="407,5,508,35"/><area shape="rect" id="node5" href="fb__prot_8c.html#a37d55968595e78e21dc1dba21418acf4" title="Is called if information for the BCU type is requested." alt="" coords="372,59,543,88"/><area shape="rect" id="node7" href="fb__prot_8c.html#af2931210aae10a2c39698d2f1fb3c98c" title="Read data from eeprom and return send it as telegram back to the requester." alt="" coords="396,165,519,195"/><area shape="rect" id="node9" href="fb__prot_8c.html#ae42ed05d4ccf0a841bdaa32fe7af4478" title="Returns the address of the device." alt="" coords="149,215,323,244"/><area shape="rect" id="node11" href="fb__prot_8c.html#a440973c20d3055721521a359aee68536" title="Sicherungslayer." alt="" coords="199,111,273,140"/><area shape="rect" id="node16" href="fb__prot_8c.html#afae8acdc71d1ebff494c621459c097cf" title="Write recieved data to the eeprom." alt="" coords="396,112,519,141"/></map>
<!-- endSectionContent --></div>
</p>

</div>
</div>
<a class="anchor" id="a3e2ec796b82409111b3a88a764b17e4b"></a><!-- doxytag: member="fb_prot.c::fbprot_Init" ref="a3e2ec796b82409111b3a88a764b17e4b" args="(const STRUCT_DEFPARAM *pParam)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void fbprot_Init </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structSTRUCT__DEFPARAM.html">STRUCT_DEFPARAM</a> *&#160;</td>
          <td class="paramname"> <em>pParam</em>&#160;)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Read configuration from eeprom is existant or set default values and write them to the eeprom. </p>
<p>Configure and enable all interrupts. </p>

<p><p>&lt;</p>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000096">Todo:</a></b></dt><dd>do not save group addresses in memory, read it from eeprom to save memory. </dd></dl>
</p>

<p>References <a class="el" href="freebus-debug_8h.html#a992e66debf91a3c70533bbae6b5a046a">DEBUG_NEWLINE</a>, <a class="el" href="freebus-debug_8h.html#a9f481e1a0f65900c41f6e6cad5ddce21">DEBUG_PUTS</a>, <a class="el" href="fb__prot_8h.html#a559201e80166d584f01e50012b4f4f8e">DEVICE_NUMBER_HIGH</a>, <a class="el" href="fb__prot_8h.html#ae8a1cdab4aadd52e37f3e362f096dedb">DEVICE_NUMBER_LOW</a>, <a class="el" href="fb__eeprom_8h.html#a7b1be2223a2fe16a4791caa396ca5253">eeprom_ParamSetDefault()</a>, <a class="el" href="fb__eeprom_8h.html#a4106e144334e369c48eed9dfe23e593c">eeprom_print()</a>, <a class="el" href="fb__eeprom_8h.html#a9eb1d517bad2009ea1fcaa3dfb8d87f2">mem_ReadByte()</a>, <a class="el" href="fb__prot_8h.html#a694e1f79998d52c33dbb7ed4c23ccf57">pa</a>, <a class="el" href="fb__prot_8h.html#a05146ed1759ff141e4e78a9739ff1bdb">PA_ADDRESS_HIGH</a>, <a class="el" href="fb__prot_8h.html#afe14aac8ca24567289c746da1323d3b8">PA_ADDRESS_LOW</a>, and <a class="el" href="fb__prot_8c.html#aaec72f885e36952a75395779cf20d684">read_grp_addr()</a>.</p>

<p>Referenced by <a class="el" href="fb__adc_8c.html#a840291bc02cba5474a4cb46a9b9566fe">main()</a>.</p>

<p><!-- startSectionHeader --><div class="dynheader">
Here is the call graph for this function:<!-- endSectionHeader --></div>
<!-- startSectionSummary --><!-- endSectionSummary --><!-- startSectionContent --><div class="dyncontent">
<div class="center"><img src="fb__prot_8c_a3e2ec796b82409111b3a88a764b17e4b_cgraph.png" border="0" usemap="#fb__prot_8c_a3e2ec796b82409111b3a88a764b17e4b_cgraph" alt=""/></div>
<map name="fb__prot_8c_a3e2ec796b82409111b3a88a764b17e4b_cgraph" id="fb__prot_8c_a3e2ec796b82409111b3a88a764b17e4b_cgraph">
<area shape="rect" id="node3" href="fb__eeprom_8h.html#a7b1be2223a2fe16a4791caa396ca5253" title="store the default parameter directly to the eeprom" alt="" coords="141,5,331,35"/><area shape="rect" id="node5" href="fb__eeprom_8h.html#a4106e144334e369c48eed9dfe23e593c" title="Print the complete eeprom to DEBUG defined." alt="" coords="183,59,289,88"/><area shape="rect" id="node7" href="fb__eeprom_8h.html#a9eb1d517bad2009ea1fcaa3dfb8d87f2" title="Read data from the eeprom cache and return it." alt="" coords="380,111,503,140"/><area shape="rect" id="node10" href="fb__prot_8c.html#aaec72f885e36952a75395779cf20d684" title="Read the group addresses from the eeprom and save them in the struct grp_addr." alt="" coords="179,163,293,192"/></map>
<!-- endSectionContent --></div>
</p>

<p><!-- startSectionHeader --><div class="dynheader">
Here is the caller graph for this function:<!-- endSectionHeader --></div>
<!-- startSectionSummary --><!-- endSectionSummary --><!-- startSectionContent --><div class="dyncontent">
<div class="center"><img src="fb__prot_8c_a3e2ec796b82409111b3a88a764b17e4b_icgraph.png" border="0" usemap="#fb__prot_8c_a3e2ec796b82409111b3a88a764b17e4b_icgraph" alt=""/></div>
<map name="fb__prot_8c_a3e2ec796b82409111b3a88a764b17e4b_icgraph" id="fb__prot_8c_a3e2ec796b82409111b3a88a764b17e4b_icgraph">
<area shape="rect" id="node3" href="fb__adc_8c.html#a840291bc02cba5474a4cb46a9b9566fe" title="The start point of the program, init all libraries, start the bus interface, the application and chec..." alt="" coords="143,5,196,35"/></map>
<!-- endSectionContent --></div>
</p>

</div>
</div>
<a class="anchor" id="a349ae562a88e3299f95943d9dcc2d794"></a><!-- doxytag: member="fb_prot.c::fbprot_msg_handler" ref="a349ae562a88e3299f95943d9dcc2d794" args="(void)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void fbprot_msg_handler </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname">&#160;)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>That function is called from main loop. </p>

<p><dl class="todo"><dt><b><a class="el" href="todo.html#_todo000095">Todo:</a></b></dt><dd>disable this debugging, it crashes the controller if a telegram is received that is unkown </dd></dl>
</p>

<p>References <a class="el" href="structfbus__hdr.html#ad851123f6d3d388bcd224e7da9c22669">fbus_hdr::apci</a>, <a class="el" href="fb__prot_8c.html#af4f820be8f1240cee6515133062a2e93">check_addr()</a>, <a class="el" href="structfb__cmd.html#acf85f5c59e47fa6e835b20b9f8ad47c0">fb_cmd::cmd</a>, <a class="el" href="msg__queue_8h.html#a0ec97afd35e8b03f52186853b4de5e9a">COUNT_ARRAY_ELEMENTS</a>, <a class="el" href="structmsg.html#a4d5d84257dfd217679a22a7d2ff9dd6f">msg::data</a>, <a class="el" href="freebus-debug_8h.html#a992e66debf91a3c70533bbae6b5a046a">DEBUG_NEWLINE</a>, <a class="el" href="freebus-debug_8h.html#ad8d82a47e19a599b0cca4140ed6b7c86">DEBUG_PUTC</a>, <a class="el" href="freebus-debug_8h.html#ad95fd4c3cff2f6c4f1343988282b9e31">DEBUG_PUTHEX</a>, <a class="el" href="freebus-debug_8h.html#a9f481e1a0f65900c41f6e6cad5ddce21">DEBUG_PUTS</a>, <a class="el" href="msg__queue_8h.html#a76c904b1fd4cb70e06c96422f8a58e43">dequeuemsg()</a>, <a class="el" href="structfbus__hdr.html#affac3a0c18c2fe2af1aaeccd2596cd5d">fbus_hdr::dest</a>, <a class="el" href="fb_8h.html#a1b0499c100f686fe464f9f139e6fa98d">FB_ACK</a>, <a class="el" href="fb__hal_8h.html#af70a4606fe5ce0777a371e0c6c3540fb">fb_hal_txqueue_msg()</a>, <a class="el" href="fb__hal_8h.html#a3e4f31f4b97d833e7ef5fb9615def386">fb_send_ack()</a>, <a class="el" href="structmsg.html#a8736cda7667fc6096fc011a0eb957d64">msg::flags</a>, <a class="el" href="msg__queue_8h.html#afec1149f3bb049af42978cf90c775ca6">FreeMsg()</a>, <a class="el" href="structfb__cmd.html#ab902de246a9c613b16fc041061cfa23e">fb_cmd::func</a>, <a class="el" href="structmsg.html#a9f80ed48480c54a999ac13700287f880">msg::len</a>, <a class="el" href="structfb__cmd.html#ab5709d1f3a82efdabfcc25b9a0114d33">fb_cmd::mask</a>, <a class="el" href="structfb__cmd.html#a8fe83add457eb2cc4dc31a7438084480">fb_cmd::max_len</a>, <a class="el" href="structfb__cmd.html#a76f85f2b42dfb775cafa02dddd06185c">fb_cmd::min_len</a>, <a class="el" href="msg__queue_8h.html#a962c15ff199e164f9cd3a9f88cd7bd27a9ae175911f48e90871f5f6037d427cd5">MSG_ALLOC</a>, <a class="el" href="msg__queue_8h.html#ac78e5c994cf36918516b451351d1bd5c">MSG_AUTOFREE</a>, <a class="el" href="fb__prot_8c.html#a13b38c2f32cb6fdf9e18f62e5dce75c6">MSG_BRC</a>, <a class="el" href="fb__prot_8c.html#ab3b0799fb79aec4bb06d92b4770139f9">MSG_GRP</a>, <a class="el" href="structmsg.html#a1f62dc1f252c5dd90aeb4a8063b2b068">msg::next</a>, <a class="el" href="structfbus__hdr.html#a7fe9afaff390f35dc2dbde5c1adb91f0">fbus_hdr::npci</a>, <a class="el" href="structmsg.html#a5be0cab05503423ed78791fa2e169dae">msg::state</a>, <a class="el" href="structfb__cmd.html#a47e0610b1e2af672b7712f0340fe9982">fb_cmd::state</a>, and <a class="el" href="structfbus__hdr.html#ab011cf810d4a1ed6a2ef9b24121ea737">fbus_hdr::tpci</a>.</p>

<p>Referenced by <a class="el" href="fb__in8__app_8c.html#a840291bc02cba5474a4cb46a9b9566fe">main()</a>.</p>

<p><!-- startSectionHeader --><div class="dynheader">
Here is the call graph for this function:<!-- endSectionHeader --></div>
<!-- startSectionSummary --><!-- endSectionSummary --><!-- startSectionContent --><div class="dyncontent">
<div class="center"><img src="fb__prot_8c_a349ae562a88e3299f95943d9dcc2d794_cgraph.png" border="0" usemap="#fb__prot_8c_a349ae562a88e3299f95943d9dcc2d794_cgraph" alt=""/></div>
<map name="fb__prot_8c_a349ae562a88e3299f95943d9dcc2d794_cgraph" id="fb__prot_8c_a349ae562a88e3299f95943d9dcc2d794_cgraph">
<area shape="rect" id="node3" href="fb__prot_8c.html#af4f820be8f1240cee6515133062a2e93" title="Analyse the type of the message (broadcast, direct, group address) and check for physical and group a..." alt="" coords="236,5,329,35"/><area shape="rect" id="node5" href="msg__queue_8h.html#a76c904b1fd4cb70e06c96422f8a58e43" title="Remove a message from the queue." alt="" coords="229,59,336,88"/><area shape="rect" id="node7" href="msg__queue_8h.html#afec1149f3bb049af42978cf90c775ca6" title="Free the message and mark it as MSG_FREE." alt="" coords="416,84,491,113"/><area shape="rect" id="node9" href="fb__hal_8h.html#af70a4606fe5ce0777a371e0c6c3540fb" title="Queue message for sending." alt="" coords="205,163,360,192"/><area shape="rect" id="node13" href="fb__hal_8h.html#a3e4f31f4b97d833e7ef5fb9615def386" title="Function to set the ack value for the response to a telegram which must be send in a absolutly excat ..." alt="" coords="232,216,333,245"/><area shape="rect" id="node11" href="msg__queue_8h.html#af35d846267d1aaaf1df04c8bff03047e" title="Add a new message to the message queue." alt="" coords="408,163,499,192"/></map>
<!-- endSectionContent --></div>
</p>

<p><!-- startSectionHeader --><div class="dynheader">
Here is the caller graph for this function:<!-- endSectionHeader --></div>
<!-- startSectionSummary --><!-- endSectionSummary --><!-- startSectionContent --><div class="dyncontent">
<div class="center"><img src="fb__prot_8c_a349ae562a88e3299f95943d9dcc2d794_icgraph.png" border="0" usemap="#fb__prot_8c_a349ae562a88e3299f95943d9dcc2d794_icgraph" alt=""/></div>
<map name="fb__prot_8c_a349ae562a88e3299f95943d9dcc2d794_icgraph" id="fb__prot_8c_a349ae562a88e3299f95943d9dcc2d794_icgraph">
<area shape="rect" id="node3" href="fb__in8__app_8c.html#a840291bc02cba5474a4cb46a9b9566fe" title="The start point of the program, init all libraries, start the bus interface, the application and chec..." alt="" coords="207,5,260,35"/></map>
<!-- endSectionContent --></div>
</p>

</div>
</div>
<a class="anchor" id="ac5c589c547e7f53fb4b2c9bbbbe8797a"></a><!-- doxytag: member="fb_prot.c::findRespondGroupAddressByObjectNumber" ref="ac5c589c547e7f53fb4b2c9bbbbe8797a" args="(uint8_t commObjectNumber, uint8_t offset)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint8_t findRespondGroupAddressByObjectNumber </td>
          <td>(</td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"> <em>commObjectNumber</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"> <em>offset</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Search through group address list and return the matching position of a group address which is an response address link. </p>
<p>If no group address found return 0.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">commObjectNumber</td><td>The object of the group address (0-7) </td></tr>
    <tr><td class="paramname">offset</td><td>Definition of offset for response addresses in EEPROM, 0x0C for 8-out</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>Position in group address array grp_addr </dd></dl>

<p>References <a class="el" href="fb__prot_8h.html#abcc3f2fd268a19f70795cd172a0fe4e6">ASSOCTABPTR</a>, <a class="el" href="fb__eeprom_8h.html#a27e2dbb193fe9e6cfbf74e9103117fcf">BASE_ADDRESS_OFFSET</a>, and <a class="el" href="fb__eeprom_8h.html#a9eb1d517bad2009ea1fcaa3dfb8d87f2">mem_ReadByte()</a>.</p>

<p>Referenced by <a class="el" href="fb__prot_8c.html#ade80ef84f4f14d25a2283b43d9c1a54f">sendExtTelegram()</a>, and <a class="el" href="fb__prot_8c.html#a990a78673785da5bb024bfaf60e0984a">sendTelegram()</a>.</p>

<p><!-- startSectionHeader --><div class="dynheader">
Here is the call graph for this function:<!-- endSectionHeader --></div>
<!-- startSectionSummary --><!-- endSectionSummary --><!-- startSectionContent --><div class="dyncontent">
<div class="center"><img src="fb__prot_8c_ac5c589c547e7f53fb4b2c9bbbbe8797a_cgraph.png" border="0" usemap="#fb__prot_8c_ac5c589c547e7f53fb4b2c9bbbbe8797a_cgraph" alt=""/></div>
<map name="fb__prot_8c_ac5c589c547e7f53fb4b2c9bbbbe8797a_cgraph" id="fb__prot_8c_ac5c589c547e7f53fb4b2c9bbbbe8797a_cgraph">
<area shape="rect" id="node3" href="fb__eeprom_8h.html#a9eb1d517bad2009ea1fcaa3dfb8d87f2" title="Read data from the eeprom cache and return it." alt="" coords="356,5,479,35"/></map>
<!-- endSectionContent --></div>
</p>

<p><!-- startSectionHeader --><div class="dynheader">
Here is the caller graph for this function:<!-- endSectionHeader --></div>
<!-- startSectionSummary --><!-- endSectionSummary --><!-- startSectionContent --><div class="dyncontent">
<div class="center"><img src="fb__prot_8c_ac5c589c547e7f53fb4b2c9bbbbe8797a_icgraph.png" border="0" usemap="#fb__prot_8c_ac5c589c547e7f53fb4b2c9bbbbe8797a_icgraph" alt=""/></div>
<map name="fb__prot_8c_ac5c589c547e7f53fb4b2c9bbbbe8797a_icgraph" id="fb__prot_8c_ac5c589c547e7f53fb4b2c9bbbbe8797a_icgraph">
<area shape="rect" id="node3" href="fb__prot_8c.html#ade80ef84f4f14d25a2283b43d9c1a54f" title="Send telegram as response to signal current state of the port to other devices." alt="" coords="356,5,487,35"/><area shape="rect" id="node5" href="fb__prot_8c.html#a990a78673785da5bb024bfaf60e0984a" title="Send telegram as response to signal current state of the port to other devices." alt="" coords="365,59,477,88"/><area shape="rect" id="node7" href="fb__in8__app_8c.html#a8d1473313842fe123fec771c086af269" title="Port Function: Jalousie." alt="" coords="536,5,669,35"/><area shape="rect" id="node9" href="fb__in8__app_8c.html#a71a91b98ae9a796dac4ab23c7e3ff6d8" title="Port Function: switch." alt="" coords="540,59,665,88"/><area shape="rect" id="node11" href="fb__relais__app_8c.html#a1f6d9eb16dbc08dfcfac5f8ceb8d7f40" title="processOutputs" alt="" coords="541,112,664,141"/><area shape="rect" id="node13" href="fb__relais__app_8c.html#a30773cfc4105728c9628fca36c8c7c20" title="Function is called if A_GroupValue_Write is received." alt="" coords="719,112,831,141"/></map>
<!-- endSectionContent --></div>
</p>

</div>
</div>
<a class="anchor" id="a5928e9483083ad86d6c82f0b0ca533af"></a><!-- doxytag: member="fb_prot.c::Ignore" ref="a5928e9483083ad86d6c82f0b0ca533af" args="(struct msg *rxmsg)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static uint8_t Ignore </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structmsg.html">msg</a> *&#160;</td>
          <td class="paramname"> <em>rxmsg</em>&#160;)</td>
          <td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Send aknowledge to certain message. </p>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000092">Todo:</a></b></dt><dd>Not implemented yet</dd></dl>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">rxmsg</td><td>The received telegram</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>0 </dd></dl>

<p>References <a class="el" href="fb_8h.html#a1b0499c100f686fe464f9f139e6fa98d">FB_ACK</a>, and <a class="el" href="fb__hal_8h.html#a3e4f31f4b97d833e7ef5fb9615def386">fb_send_ack()</a>.</p>

<p><!-- startSectionHeader --><div class="dynheader">
Here is the call graph for this function:<!-- endSectionHeader --></div>
<!-- startSectionSummary --><!-- endSectionSummary --><!-- startSectionContent --><div class="dyncontent">
<div class="center"><img src="fb__prot_8c_a5928e9483083ad86d6c82f0b0ca533af_cgraph.png" border="0" usemap="#fb__prot_8c_a5928e9483083ad86d6c82f0b0ca533af_cgraph" alt=""/></div>
<map name="fb__prot_8c_a5928e9483083ad86d6c82f0b0ca533af_cgraph" id="fb__prot_8c_a5928e9483083ad86d6c82f0b0ca533af_cgraph">
<area shape="rect" id="node3" href="fb__hal_8h.html#a3e4f31f4b97d833e7ef5fb9615def386" title="Function to set the ack value for the response to a telegram which must be send in a absolutly excat ..." alt="" coords="117,5,219,35"/></map>
<!-- endSectionContent --></div>
</p>

</div>
</div>
<a class="anchor" id="a440973c20d3055721521a359aee68536"></a><!-- doxytag: member="fb_prot.c::ncd_resp" ref="a440973c20d3055721521a359aee68536" args="(struct msg *rxmsg)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static void ncd_resp </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structmsg.html">msg</a> *&#160;</td>
          <td class="paramname"> <em>rxmsg</em>&#160;)</td>
          <td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Sicherungslayer. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">rxmsg</td><td>pointer to currently received eib telegram </td></tr>
  </table>
  </dd>
</dl>

<p>References <a class="el" href="structmsg.html#a4d5d84257dfd217679a22a7d2ff9dd6f">msg::data</a>, <a class="el" href="fb__hal_8h.html#af70a4606fe5ce0777a371e0c6c3540fb">fb_hal_txqueue_msg()</a>, <a class="el" href="fb__prot_8c.html#a1ca66f4c62a2c7c7ff2c8ebef64465da">fb_new_msg()</a>, <a class="el" href="structfbus__hdr.html#a7fe9afaff390f35dc2dbde5c1adb91f0">fbus_hdr::npci</a>, <a class="el" href="structfbus__hdr.html#a60845bb16d8af17fd0b699cde499d7ad">fbus_hdr::src</a>, and <a class="el" href="structfbus__hdr.html#ab011cf810d4a1ed6a2ef9b24121ea737">fbus_hdr::tpci</a>.</p>

<p>Referenced by <a class="el" href="fb__prot_8c.html#a4a0be801ed4f2d9b2cbce548adf56a76">A_ADC_Read()</a>, <a class="el" href="fb__prot_8c.html#a37d55968595e78e21dc1dba21418acf4">A_DeviceDescriptor_Read()</a>, <a class="el" href="fb__prot_8c.html#af2931210aae10a2c39698d2f1fb3c98c">A_Memory_Read()</a>, and <a class="el" href="fb__prot_8c.html#afae8acdc71d1ebff494c621459c097cf">A_Memory_Write()</a>.</p>

<p><!-- startSectionHeader --><div class="dynheader">
Here is the call graph for this function:<!-- endSectionHeader --></div>
<!-- startSectionSummary --><!-- endSectionSummary --><!-- startSectionContent --><div class="dyncontent">
<div class="center"><img src="fb__prot_8c_a440973c20d3055721521a359aee68536_cgraph.png" border="0" usemap="#fb__prot_8c_a440973c20d3055721521a359aee68536_cgraph" alt=""/></div>
<map name="fb__prot_8c_a440973c20d3055721521a359aee68536_cgraph" id="fb__prot_8c_a440973c20d3055721521a359aee68536_cgraph">
<area shape="rect" id="node3" href="fb__hal_8h.html#af70a4606fe5ce0777a371e0c6c3540fb" title="Queue message for sending." alt="" coords="133,5,288,35"/><area shape="rect" id="node7" href="fb__prot_8c.html#a1ca66f4c62a2c7c7ff2c8ebef64465da" title="Create a new telegram and and return pointer to it." alt="" coords="160,59,261,88"/><area shape="rect" id="node5" href="msg__queue_8h.html#af35d846267d1aaaf1df04c8bff03047e" title="Add a new message to the message queue." alt="" coords="336,5,427,35"/><area shape="rect" id="node9" href="msg__queue_8h.html#aa3b6fa424df78c0dbbbaa16a7dd32acb" title="Allocate space for a message and return a pointer to it." alt="" coords="341,59,421,88"/></map>
<!-- endSectionContent --></div>
</p>

<p><!-- startSectionHeader --><div class="dynheader">
Here is the caller graph for this function:<!-- endSectionHeader --></div>
<!-- startSectionSummary --><!-- endSectionSummary --><!-- startSectionContent --><div class="dyncontent">
<div class="center"><img src="fb__prot_8c_a440973c20d3055721521a359aee68536_icgraph.png" border="0" usemap="#fb__prot_8c_a440973c20d3055721521a359aee68536_icgraph" alt=""/></div>
<map name="fb__prot_8c_a440973c20d3055721521a359aee68536_icgraph" id="fb__prot_8c_a440973c20d3055721521a359aee68536_icgraph">
<area shape="rect" id="node3" href="fb__prot_8c.html#a4a0be801ed4f2d9b2cbce548adf56a76" title="Read the values from the ADC converter." alt="" coords="164,5,265,35"/><area shape="rect" id="node5" href="fb__prot_8c.html#a37d55968595e78e21dc1dba21418acf4" title="Is called if information for the BCU type is requested." alt="" coords="129,59,300,88"/><area shape="rect" id="node7" href="fb__prot_8c.html#af2931210aae10a2c39698d2f1fb3c98c" title="Read data from eeprom and return send it as telegram back to the requester." alt="" coords="153,112,276,141"/><area shape="rect" id="node9" href="fb__prot_8c.html#afae8acdc71d1ebff494c621459c097cf" title="Write recieved data to the eeprom." alt="" coords="153,165,276,195"/></map>
<!-- endSectionContent --></div>
</p>

</div>
</div>
<a class="anchor" id="aaec72f885e36952a75395779cf20d684"></a><!-- doxytag: member="fb_prot.c::read_grp_addr" ref="aaec72f885e36952a75395779cf20d684" args="(void)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static void read_grp_addr </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname">&#160;)</td>
          <td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Read the group addresses from the eeprom and save them in the struct grp_addr. </p>

<p>References <a class="el" href="structgrp__addr__s.html#a76c51d2b8425bcfffb8b2dec126cbf1a">grp_addr_s::count</a>, <a class="el" href="fb__prot_8h.html#a5f41914a8993067abe915849b0f0bc5b">COUNT_GRP_ADDRESSES</a>, <a class="el" href="freebus-debug_8h.html#ad95fd4c3cff2f6c4f1343988282b9e31">DEBUG_PUTHEX</a>, <a class="el" href="freebus-debug_8h.html#a9f481e1a0f65900c41f6e6cad5ddce21">DEBUG_PUTS</a>, <a class="el" href="freebus-debug_8h.html#a62c89a645f3f8f40d781b5af3014d4cd">DEBUG_SPACE</a>, <a class="el" href="fb_8h.html#a93a74e1d2018d844ab0bcc2a2bedca39">FB_MAX_GROUP_ADDR</a>, <a class="el" href="structgrp__addr__s.html#a4b12f8b029a5a4a7c86e14fc6e5f9243">grp_addr_s::ga</a>, <a class="el" href="fb__adc_8c.html#aae3c982e005b9e0659d533393720a7f8">grp_addr</a>, <a class="el" href="fb__eeprom_8h.html#a9eb1d517bad2009ea1fcaa3dfb8d87f2">mem_ReadByte()</a>, and <a class="el" href="fb__prot_8h.html#a332e353c27828076ade45e7d1967873f">START_ADDRESS_GROUP_ADDRESSES</a>.</p>

<p>Referenced by <a class="el" href="fb__prot_8c.html#a3e2ec796b82409111b3a88a764b17e4b">fbprot_Init()</a>.</p>

<p><!-- startSectionHeader --><div class="dynheader">
Here is the call graph for this function:<!-- endSectionHeader --></div>
<!-- startSectionSummary --><!-- endSectionSummary --><!-- startSectionContent --><div class="dyncontent">
<div class="center"><img src="fb__prot_8c_aaec72f885e36952a75395779cf20d684_cgraph.png" border="0" usemap="#fb__prot_8c_aaec72f885e36952a75395779cf20d684_cgraph" alt=""/></div>
<map name="fb__prot_8c_aaec72f885e36952a75395779cf20d684_cgraph" id="fb__prot_8c_aaec72f885e36952a75395779cf20d684_cgraph">
<area shape="rect" id="node3" href="fb__eeprom_8h.html#a9eb1d517bad2009ea1fcaa3dfb8d87f2" title="Read data from the eeprom cache and return it." alt="" coords="169,5,292,35"/></map>
<!-- endSectionContent --></div>
</p>

<p><!-- startSectionHeader --><div class="dynheader">
Here is the caller graph for this function:<!-- endSectionHeader --></div>
<!-- startSectionSummary --><!-- endSectionSummary --><!-- startSectionContent --><div class="dyncontent">
<div class="center"><img src="fb__prot_8c_aaec72f885e36952a75395779cf20d684_icgraph.png" border="0" usemap="#fb__prot_8c_aaec72f885e36952a75395779cf20d684_icgraph" alt=""/></div>
<map name="fb__prot_8c_aaec72f885e36952a75395779cf20d684_icgraph" id="fb__prot_8c_aaec72f885e36952a75395779cf20d684_icgraph">
<area shape="rect" id="node3" href="fb__prot_8c.html#a3e2ec796b82409111b3a88a764b17e4b" title="Read configuration from eeprom is existant or set default values and write them to the eeprom..." alt="" coords="169,5,255,35"/><area shape="rect" id="node5" href="fb__adc_8c.html#a840291bc02cba5474a4cb46a9b9566fe" title="The start point of the program, init all libraries, start the bus interface, the application and chec..." alt="" coords="305,5,359,35"/></map>
<!-- endSectionContent --></div>
</p>

</div>
</div>
<a class="anchor" id="ade80ef84f4f14d25a2283b43d9c1a54f"></a><!-- doxytag: member="fb_prot.c::sendExtTelegram" ref="ade80ef84f4f14d25a2283b43d9c1a54f" args="(uint8_t commObjectNumber, uint8_t value, uint8_t offset)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void sendExtTelegram </td>
          <td>(</td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"> <em>commObjectNumber</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"> <em>value</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"> <em>offset</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Send telegram as response to signal current state of the port to other devices. </p>
<p>Only necessary if ports are switched inside a timer function.</p>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000089">Todo:</a></b></dt><dd>what source address to send if object has several group addresses?</dd></dl>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">commObjectNumber</td><td>which port was switched </td></tr>
    <tr><td class="paramname">value</td><td>1=switched on, 0=switched of </td></tr>
    <tr><td class="paramname">offset</td><td>Definition of offset for response addresses in EEPROM, 0x0C for 8-out </td></tr>
  </table>
  </dd>
</dl>

<p><p>&lt;</p>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000090">Todo:</a></b></dt><dd>that is application specific code maybe we should move it to another function </dd></dl>
</p>

<p>References <a class="el" href="msg__queue_8h.html#aa3b6fa424df78c0dbbbaa16a7dd32acb">AllocMsgI()</a>, <a class="el" href="structfbus__hdr.html#ad851123f6d3d388bcd224e7da9c22669">fbus_hdr::apci</a>, <a class="el" href="structfbus__hdr.html#ac495b44f58807e4c580231c2ee426bcc">fbus_hdr::ctrl</a>, <a class="el" href="structmsg.html#a4d5d84257dfd217679a22a7d2ff9dd6f">msg::data</a>, <a class="el" href="structfbus__hdr.html#affac3a0c18c2fe2af1aaeccd2596cd5d">fbus_hdr::dest</a>, <a class="el" href="fb__hal_8h.html#af70a4606fe5ce0777a371e0c6c3540fb">fb_hal_txqueue_msg()</a>, <a class="el" href="fb__prot_8h.html#a313ffcd6f35f6b76ed97d80765dd9faf">findRespondGroupAddressByObjectNumber()</a>, <a class="el" href="structmsg.html#a8736cda7667fc6096fc011a0eb957d64">msg::flags</a>, <a class="el" href="structgrp__addr__s.html#a4b12f8b029a5a4a7c86e14fc6e5f9243">grp_addr_s::ga</a>, <a class="el" href="fb__adc_8c.html#aae3c982e005b9e0659d533393720a7f8">grp_addr</a>, <a class="el" href="structmsg.html#a9f80ed48480c54a999ac13700287f880">msg::len</a>, <a class="el" href="fb__eeprom_8h.html#a9eb1d517bad2009ea1fcaa3dfb8d87f2">mem_ReadByte()</a>, <a class="el" href="structfbus__hdr.html#a7fe9afaff390f35dc2dbde5c1adb91f0">fbus_hdr::npci</a>, <a class="el" href="fb__prot_8h.html#a05146ed1759ff141e4e78a9739ff1bdb">PA_ADDRESS_HIGH</a>, <a class="el" href="fb__prot_8h.html#afe14aac8ca24567289c746da1323d3b8">PA_ADDRESS_LOW</a>, <a class="el" href="structmsg.html#a9a24303b4435fd372af8703f37f1d299">msg::repeat</a>, <a class="el" href="structfbus__hdr.html#a60845bb16d8af17fd0b699cde499d7ad">fbus_hdr::src</a>, and <a class="el" href="structfbus__hdr.html#ab011cf810d4a1ed6a2ef9b24121ea737">fbus_hdr::tpci</a>.</p>

<p><!-- startSectionHeader --><div class="dynheader">
Here is the call graph for this function:<!-- endSectionHeader --></div>
<!-- startSectionSummary --><!-- endSectionSummary --><!-- startSectionContent --><div class="dyncontent">
<div class="center"><img src="fb__prot_8c_ade80ef84f4f14d25a2283b43d9c1a54f_cgraph.png" border="0" usemap="#fb__prot_8c_ade80ef84f4f14d25a2283b43d9c1a54f_cgraph" alt=""/></div>
<map name="fb__prot_8c_ade80ef84f4f14d25a2283b43d9c1a54f_cgraph" id="fb__prot_8c_ade80ef84f4f14d25a2283b43d9c1a54f_cgraph">
<area shape="rect" id="node3" href="msg__queue_8h.html#aa3b6fa424df78c0dbbbaa16a7dd32acb" title="Allocate space for a message and return a pointer to it." alt="" coords="297,5,377,35"/><area shape="rect" id="node5" href="fb__hal_8h.html#af70a4606fe5ce0777a371e0c6c3540fb" title="Queue message for sending." alt="" coords="260,59,415,88"/><area shape="rect" id="node9" href="fb__prot_8h.html#a313ffcd6f35f6b76ed97d80765dd9faf" title="Search through group address list and return the matching position of a group address which is an res..." alt="" coords="188,112,487,141"/><area shape="rect" id="node11" href="fb__eeprom_8h.html#a9eb1d517bad2009ea1fcaa3dfb8d87f2" title="Read data from the eeprom cache and return it." alt="" coords="537,137,660,167"/><area shape="rect" id="node7" href="msg__queue_8h.html#af35d846267d1aaaf1df04c8bff03047e" title="Add a new message to the message queue." alt="" coords="553,59,644,88"/></map>
<!-- endSectionContent --></div>
</p>

</div>
</div>
<a class="anchor" id="a990a78673785da5bb024bfaf60e0984a"></a><!-- doxytag: member="fb_prot.c::sendTelegram" ref="a990a78673785da5bb024bfaf60e0984a" args="(uint8_t commObjectNumber, uint8_t value, uint8_t offset)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void sendTelegram </td>
          <td>(</td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"> <em>commObjectNumber</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"> <em>value</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"> <em>offset</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Send telegram as response to signal current state of the port to other devices. </p>
<p>Only necessary if ports are switched inside a timer function.</p>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000091">Todo:</a></b></dt><dd>what source address to send if object has several group addresses?</dd></dl>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">commObjectNumber</td><td>which port was switched </td></tr>
    <tr><td class="paramname">value</td><td>1=switched on, 0=switched of </td></tr>
    <tr><td class="paramname">offset</td><td>Definition of offset for response addresses in EEPROM, 0x0C for 8-out </td></tr>
  </table>
  </dd>
</dl>

<p>References <a class="el" href="msg__queue_8h.html#aa3b6fa424df78c0dbbbaa16a7dd32acb">AllocMsgI()</a>, <a class="el" href="structfbus__hdr.html#ad851123f6d3d388bcd224e7da9c22669">fbus_hdr::apci</a>, <a class="el" href="structfbus__hdr.html#ac495b44f58807e4c580231c2ee426bcc">fbus_hdr::ctrl</a>, <a class="el" href="structmsg.html#a4d5d84257dfd217679a22a7d2ff9dd6f">msg::data</a>, <a class="el" href="structfbus__hdr.html#affac3a0c18c2fe2af1aaeccd2596cd5d">fbus_hdr::dest</a>, <a class="el" href="fb__hal_8h.html#af70a4606fe5ce0777a371e0c6c3540fb">fb_hal_txqueue_msg()</a>, <a class="el" href="fb__prot_8h.html#a313ffcd6f35f6b76ed97d80765dd9faf">findRespondGroupAddressByObjectNumber()</a>, <a class="el" href="structmsg.html#a8736cda7667fc6096fc011a0eb957d64">msg::flags</a>, <a class="el" href="structgrp__addr__s.html#a4b12f8b029a5a4a7c86e14fc6e5f9243">grp_addr_s::ga</a>, <a class="el" href="fb__adc_8c.html#aae3c982e005b9e0659d533393720a7f8">grp_addr</a>, <a class="el" href="structmsg.html#a9f80ed48480c54a999ac13700287f880">msg::len</a>, <a class="el" href="fb__eeprom_8h.html#a9eb1d517bad2009ea1fcaa3dfb8d87f2">mem_ReadByte()</a>, <a class="el" href="structfbus__hdr.html#a7fe9afaff390f35dc2dbde5c1adb91f0">fbus_hdr::npci</a>, <a class="el" href="fb__prot_8h.html#a05146ed1759ff141e4e78a9739ff1bdb">PA_ADDRESS_HIGH</a>, <a class="el" href="fb__prot_8h.html#afe14aac8ca24567289c746da1323d3b8">PA_ADDRESS_LOW</a>, <a class="el" href="structmsg.html#a9a24303b4435fd372af8703f37f1d299">msg::repeat</a>, <a class="el" href="structfbus__hdr.html#a60845bb16d8af17fd0b699cde499d7ad">fbus_hdr::src</a>, and <a class="el" href="structfbus__hdr.html#ab011cf810d4a1ed6a2ef9b24121ea737">fbus_hdr::tpci</a>.</p>

<p>Referenced by <a class="el" href="fb__in8__app_8c.html#a8d1473313842fe123fec771c086af269">PortFunc_Jalousie()</a>, <a class="el" href="fb__in8__app_8c.html#a71a91b98ae9a796dac4ab23c7e3ff6d8">PortFunc_Switch()</a>, and <a class="el" href="fb__relais__app_8c.html#a1f6d9eb16dbc08dfcfac5f8ceb8d7f40">processOutputs()</a>.</p>

<p><!-- startSectionHeader --><div class="dynheader">
Here is the call graph for this function:<!-- endSectionHeader --></div>
<!-- startSectionSummary --><!-- endSectionSummary --><!-- startSectionContent --><div class="dyncontent">
<div class="center"><img src="fb__prot_8c_a990a78673785da5bb024bfaf60e0984a_cgraph.png" border="0" usemap="#fb__prot_8c_a990a78673785da5bb024bfaf60e0984a_cgraph" alt=""/></div>
<map name="fb__prot_8c_a990a78673785da5bb024bfaf60e0984a_cgraph" id="fb__prot_8c_a990a78673785da5bb024bfaf60e0984a_cgraph">
<area shape="rect" id="node3" href="msg__queue_8h.html#aa3b6fa424df78c0dbbbaa16a7dd32acb" title="Allocate space for a message and return a pointer to it." alt="" coords="276,5,356,35"/><area shape="rect" id="node5" href="fb__hal_8h.html#af70a4606fe5ce0777a371e0c6c3540fb" title="Queue message for sending." alt="" coords="239,59,393,88"/><area shape="rect" id="node9" href="fb__prot_8h.html#a313ffcd6f35f6b76ed97d80765dd9faf" title="Search through group address list and return the matching position of a group address which is an res..." alt="" coords="167,112,465,141"/><area shape="rect" id="node11" href="fb__eeprom_8h.html#a9eb1d517bad2009ea1fcaa3dfb8d87f2" title="Read data from the eeprom cache and return it." alt="" coords="516,137,639,167"/><area shape="rect" id="node7" href="msg__queue_8h.html#af35d846267d1aaaf1df04c8bff03047e" title="Add a new message to the message queue." alt="" coords="532,59,623,88"/></map>
<!-- endSectionContent --></div>
</p>

<p><!-- startSectionHeader --><div class="dynheader">
Here is the caller graph for this function:<!-- endSectionHeader --></div>
<!-- startSectionSummary --><!-- endSectionSummary --><!-- startSectionContent --><div class="dyncontent">
<div class="center"><img src="fb__prot_8c_a990a78673785da5bb024bfaf60e0984a_icgraph.png" border="0" usemap="#fb__prot_8c_a990a78673785da5bb024bfaf60e0984a_icgraph" alt=""/></div>
<map name="fb__prot_8c_a990a78673785da5bb024bfaf60e0984a_icgraph" id="fb__prot_8c_a990a78673785da5bb024bfaf60e0984a_icgraph">
<area shape="rect" id="node3" href="fb__in8__app_8c.html#a8d1473313842fe123fec771c086af269" title="Port Function: Jalousie." alt="" coords="165,5,299,35"/><area shape="rect" id="node5" href="fb__in8__app_8c.html#a71a91b98ae9a796dac4ab23c7e3ff6d8" title="Port Function: switch." alt="" coords="169,59,295,88"/><area shape="rect" id="node7" href="fb__relais__app_8c.html#a1f6d9eb16dbc08dfcfac5f8ceb8d7f40" title="processOutputs" alt="" coords="171,112,293,141"/><area shape="rect" id="node9" href="fb__relais__app_8c.html#a30773cfc4105728c9628fca36c8c7c20" title="Function is called if A_GroupValue_Write is received." alt="" coords="348,112,460,141"/></map>
<!-- endSectionContent --></div>
</p>

</div>
</div>
<a class="anchor" id="a3b317425f1358ea37c8fca124e29c277"></a><!-- doxytag: member="fb_prot.c::T_Connect_Req" ref="a3b317425f1358ea37c8fca124e29c277" args="(struct msg *rxmsg)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static uint8_t T_Connect_Req </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structmsg.html">msg</a> *&#160;</td>
          <td class="paramname"> <em>rxmsg</em>&#160;)</td>
          <td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Called to start a connection to a physical address. </p>
<p>Only accepted if no conenction is established yet. Only acknowledge byte is returned no confirmation telegram is sent.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">rxmsg</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd></dd></dl>

<p>References <a class="el" href="structucd__stat.html#a40a356f94ae998f038d14f303dfee80f">ucd_stat::addr</a>, <a class="el" href="structucd__stat.html#a9ff1c79502044d630150467c79c5105e">ucd_stat::count</a>, <a class="el" href="structmsg.html#a4d5d84257dfd217679a22a7d2ff9dd6f">msg::data</a>, <a class="el" href="fb_8h.html#a1b0499c100f686fe464f9f139e6fa98d">FB_ACK</a>, <a class="el" href="fb_8h.html#a4aff7801c9ec9dee2fb54a0c4970335c">FB_NONE</a>, <a class="el" href="fb__hal_8h.html#a3e4f31f4b97d833e7ef5fb9615def386">fb_send_ack()</a>, <a class="el" href="structfbus__hdr.html#a60845bb16d8af17fd0b699cde499d7ad">fbus_hdr::src</a>, <a class="el" href="structucd__stat.html#a809879e798766da03b6588aadb1d2f10">ucd_stat::status</a>, and <a class="el" href="fb__prot_8c.html#a5299818938807c9ebc199b66cbc01958">ucd</a>.</p>

<p><!-- startSectionHeader --><div class="dynheader">
Here is the call graph for this function:<!-- endSectionHeader --></div>
<!-- startSectionSummary --><!-- endSectionSummary --><!-- startSectionContent --><div class="dyncontent">
<div class="center"><img src="fb__prot_8c_a3b317425f1358ea37c8fca124e29c277_cgraph.png" border="0" usemap="#fb__prot_8c_a3b317425f1358ea37c8fca124e29c277_cgraph" alt=""/></div>
<map name="fb__prot_8c_a3b317425f1358ea37c8fca124e29c277_cgraph" id="fb__prot_8c_a3b317425f1358ea37c8fca124e29c277_cgraph">
<area shape="rect" id="node3" href="fb__hal_8h.html#a3e4f31f4b97d833e7ef5fb9615def386" title="Function to set the ack value for the response to a telegram which must be send in a absolutly excat ..." alt="" coords="173,5,275,35"/></map>
<!-- endSectionContent --></div>
</p>

</div>
</div>
<a class="anchor" id="a0675ad49aa389619806157f585c466ee"></a><!-- doxytag: member="fb_prot.c::T_Disconnect_Req" ref="a0675ad49aa389619806157f585c466ee" args="(struct msg *rxmsg)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static uint8_t T_Disconnect_Req </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structmsg.html">msg</a> *&#160;</td>
          <td class="paramname"> <em>rxmsg</em>&#160;)</td>
          <td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Release the transport connection. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">rxmsg</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd></dd></dl>

<p>References <a class="el" href="structucd__stat.html#a40a356f94ae998f038d14f303dfee80f">ucd_stat::addr</a>, <a class="el" href="structucd__stat.html#a9ff1c79502044d630150467c79c5105e">ucd_stat::count</a>, <a class="el" href="structmsg.html#a4d5d84257dfd217679a22a7d2ff9dd6f">msg::data</a>, <a class="el" href="fb_8h.html#a1b0499c100f686fe464f9f139e6fa98d">FB_ACK</a>, <a class="el" href="fb_8h.html#a4aff7801c9ec9dee2fb54a0c4970335c">FB_NONE</a>, <a class="el" href="fb__hal_8h.html#a3e4f31f4b97d833e7ef5fb9615def386">fb_send_ack()</a>, <a class="el" href="structfbus__hdr.html#a60845bb16d8af17fd0b699cde499d7ad">fbus_hdr::src</a>, <a class="el" href="structucd__stat.html#a809879e798766da03b6588aadb1d2f10">ucd_stat::status</a>, and <a class="el" href="fb__prot_8c.html#a5299818938807c9ebc199b66cbc01958">ucd</a>.</p>

<p><!-- startSectionHeader --><div class="dynheader">
Here is the call graph for this function:<!-- endSectionHeader --></div>
<!-- startSectionSummary --><!-- endSectionSummary --><!-- startSectionContent --><div class="dyncontent">
<div class="center"><img src="fb__prot_8c_a0675ad49aa389619806157f585c466ee_cgraph.png" border="0" usemap="#fb__prot_8c_a0675ad49aa389619806157f585c466ee_cgraph" alt=""/></div>
<map name="fb__prot_8c_a0675ad49aa389619806157f585c466ee_cgraph" id="fb__prot_8c_a0675ad49aa389619806157f585c466ee_cgraph">
<area shape="rect" id="node3" href="fb__hal_8h.html#a3e4f31f4b97d833e7ef5fb9615def386" title="Function to set the ack value for the response to a telegram which must be send in a absolutly excat ..." alt="" coords="192,5,293,35"/></map>
<!-- endSectionContent --></div>
</p>

</div>
</div>
<hr/><h2>Variable Documentation</h2>
<a class="anchor" id="aae3c982e005b9e0659d533393720a7f8"></a><!-- doxytag: member="fb_prot.c::grp_addr" ref="aae3c982e005b9e0659d533393720a7f8" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="structgrp__addr__s.html">grp_addr_s</a> <a class="el" href="fb__prot_8c.html#aae3c982e005b9e0659d533393720a7f8">grp_addr</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>List of saved group addresses for this controller, see struct <a class="el" href="structgrp__addr__s.html" title="Structure for the group addresses.">grp_addr_s</a> for more information. </p>

<p>Referenced by <a class="el" href="fb__prot_8c.html#af4f820be8f1240cee6515133062a2e93">check_addr()</a>, <a class="el" href="fb__ain10v_8c.html#a4adf2da9160be7c9f461cafa1028ab0d">find_ga()</a>, <a class="el" href="fb__prot_8c.html#aaec72f885e36952a75395779cf20d684">read_grp_addr()</a>, <a class="el" href="fb__ain10v_8c.html#acdb92216340d9fc010cc12bbb44bbfb2">readApplication()</a>, <a class="el" href="fb__2-dimmer__app_8c.html#a30773cfc4105728c9628fca36c8c7c20">runApplication()</a>, <a class="el" href="fb__prot_8c.html#ade80ef84f4f14d25a2283b43d9c1a54f">sendExtTelegram()</a>, and <a class="el" href="fb__prot_8c.html#a990a78673785da5bb024bfaf60e0984a">sendTelegram()</a>.</p>

</div>
</div>
<a class="anchor" id="a8eddb2a4af440b7e0c13055d3ad4bc7d"></a><!-- doxytag: member="fb_prot.c::nodeParam" ref="a8eddb2a4af440b7e0c13055d3ad4bc7d" args="[]" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint8_t <a class="el" href="fb__prot_8c.html#a8eddb2a4af440b7e0c13055d3ad4bc7d">nodeParam</a>[]</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>parameterstructure (RAM) </p>

<p>Referenced by <a class="el" href="fb__eeprom_8c.html#aef320e016dbb25dac76482345f2ce495">eeprom_Init()</a>, and <a class="el" href="fb__adc_8c.html#a840291bc02cba5474a4cb46a9b9566fe">main()</a>.</p>

</div>
</div>
<a class="anchor" id="ab1cd66b780fee6c2be823928c720a129"></a><!-- doxytag: member="fb_prot.c::PROGMEM" ref="ab1cd66b780fee6c2be823928c720a129" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="structfb__cmd.html">fb_cmd</a> bus_cmds [] <a class="el" href="lib_2uart_8c.html#a0e2fa7eab54405a676752c417d75eec0">PROGMEM</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<b>Initial value:</b><div class="fragment"><pre class="fragment"> {



    {              <a class="code" href="fb__prot_8c.html#ab3b0799fb79aec4bb06d92b4770139f9" title="Group adress.">MSG_GRP</a> , 0x0080, 0x03C0, 0x00, 0x0E, <a class="code" href="fb__prot_8c.html#abb5d4fc672e3e3e123f5f3e6e9f901e3" title="Is called if a broadcast is received with a matching group address (eg.">A_GroupValue_Write</a> },
    {              <a class="code" href="fb__prot_8c.html#ab3b0799fb79aec4bb06d92b4770139f9" title="Group adress.">MSG_GRP</a> , 0x0000, 0x03FF, 0x00, 0x10, <a class="code" href="fb__prot_8c.html#ae56aada1e48493023c8f3ecf7a1e71a7" title="A read request to the application.">A_GroupValue_Read</a> },


    {              <a class="code" href="fb__prot_8c.html#a253031b1534db6709a48eb59e440b801" title="connect request">MSG_CON</a> , 0x0000, 0x0000, 0x01, 0x01, <a class="code" href="fb__prot_8c.html#a3b317425f1358ea37c8fca124e29c277" title="Called to start a connection to a physical address.">T_Connect_Req</a> },
    {              <a class="code" href="fb__prot_8c.html#ac7d0d9a9ace91de05ac02191bd7a1aa8" title="disconnect request">MSG_DIS</a> , 0x0000, 0x0000, 0x01, 0x01, <a class="code" href="fb__prot_8c.html#a0675ad49aa389619806157f585c466ee" title="Release the transport connection.">T_Disconnect_Req</a> },
    {              <a class="code" href="fb__prot_8c.html#af4b7d60452ebd8d0355291bd3b720e39" title="Direct adressing, one-to-one.">MSG_DAF</a> , 0xC200, 0xC300, 0x01, 0x01, <a class="code" href="fb__prot_8c.html#a5928e9483083ad86d6c82f0b0ca533af" title="Send aknowledge to certain message.">Ignore</a>},


    {    <a class="code" href="fb__prot_8c.html#a13b38c2f32cb6fdf9e18f62e5dce75c6" title="Broadcast adress, one-to-all conenction-less.">MSG_BRC</a> | <a class="code" href="fb__prot_8c.html#af4b7d60452ebd8d0355291bd3b720e39" title="Direct adressing, one-to-one.">MSG_DAF</a> , 0x00C0, 0x03FF, 0x04, 0x04, <a class="code" href="fb__prot_8c.html#ac3b30c7591e51974ab895440929395c6" title="Set the received address as our new device address.">A_PhysicalAddress_Write</a> },      
    {    <a class="code" href="fb__prot_8c.html#a13b38c2f32cb6fdf9e18f62e5dce75c6" title="Broadcast adress, one-to-all conenction-less.">MSG_BRC</a> | <a class="code" href="fb__prot_8c.html#af4b7d60452ebd8d0355291bd3b720e39" title="Direct adressing, one-to-one.">MSG_DAF</a> , 0x0100, 0x03FF, 0x02, 0x02, <a class="code" href="fb__prot_8c.html#ae42ed05d4ccf0a841bdaa32fe7af4478" title="Returns the address of the device.">A_PhysicalAddress_Read</a> },






    {              <a class="code" href="fb__prot_8c.html#af4b7d60452ebd8d0355291bd3b720e39" title="Direct adressing, one-to-one.">MSG_DAF</a> , 0x0180, 0x03C0, 0x03, 0x03, <a class="code" href="fb__prot_8c.html#a4a0be801ed4f2d9b2cbce548adf56a76" title="Read the values from the ADC converter.">A_ADC_Read</a> },
    {              <a class="code" href="fb__prot_8c.html#af4b7d60452ebd8d0355291bd3b720e39" title="Direct adressing, one-to-one.">MSG_DAF</a> , 0x4200, 0xC3C0, 0x04, 0x04, <a class="code" href="fb__prot_8c.html#af2931210aae10a2c39698d2f1fb3c98c" title="Read data from eeprom and return send it as telegram back to the requester.">A_Memory_Read</a> },
    {              <a class="code" href="fb__prot_8c.html#af4b7d60452ebd8d0355291bd3b720e39" title="Direct adressing, one-to-one.">MSG_DAF</a> , 0x4280, 0xC3C0, 0x01, 0x10, <a class="code" href="fb__prot_8c.html#afae8acdc71d1ebff494c621459c097cf" title="Write recieved data to the eeprom.">A_Memory_Write</a> },

    {              <a class="code" href="fb__prot_8c.html#af4b7d60452ebd8d0355291bd3b720e39" title="Direct adressing, one-to-one.">MSG_DAF</a> , 0x4300, 0xFFFF, 0x02, 0x02, <a class="code" href="fb__prot_8c.html#a37d55968595e78e21dc1dba21418acf4" title="Is called if information for the BCU type is requested.">A_DeviceDescriptor_Read</a> },
    {              <a class="code" href="fb__prot_8c.html#af4b7d60452ebd8d0355291bd3b720e39" title="Direct adressing, one-to-one.">MSG_DAF</a> , 0x0380, 0x03FF, 0x02, 0x02, <a class="code" href="fb__prot_8c.html#a088341f3603f5de9eb4817a8199391c6" title="Restart the program on the microcontroller.">A_Restart</a>},
}
</pre></div>
<p>Store mapping of function with parameters called by bus memebers. </p>

</div>
</div>
<a class="anchor" id="a5299818938807c9ebc199b66cbc01958"></a><!-- doxytag: member="fb_prot.c::ucd" ref="a5299818938807c9ebc199b66cbc01958" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="structucd__stat.html">ucd_stat</a> <a class="el" href="fb__prot_8c.html#a5299818938807c9ebc199b66cbc01958">ucd</a><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Used to track transport connections, for this source address, status and counter is saved. </p>

<p>Referenced by <a class="el" href="fb__prot_8c.html#a4a0be801ed4f2d9b2cbce548adf56a76">A_ADC_Read()</a>, <a class="el" href="fb__prot_8c.html#af2931210aae10a2c39698d2f1fb3c98c">A_Memory_Read()</a>, <a class="el" href="fb__prot_8c.html#a3b317425f1358ea37c8fca124e29c277">T_Connect_Req()</a>, and <a class="el" href="fb__prot_8c.html#a0675ad49aa389619806157f585c466ee">T_Disconnect_Req()</a>.</p>

</div>
</div>
</div>
<hr class="footer"/><address class="footer"><small>Generated on Mon Mar 7 2011 10:08:42 for FreeBusAVR by&#160;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.2 </small></address>
</body>
</html>
