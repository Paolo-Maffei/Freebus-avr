<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>FreeBusAVR: lib/fb_eeprom.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- Generated by Doxygen 1.6.2 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="main.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
      <li><a href="annotated.html"><span>Data&nbsp;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div class="tabs">
    <ul>
      <li><a href="files.html"><span>File&nbsp;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
</div>
<div class="contents">
<h1>lib/fb_eeprom.c File Reference</h1>
<p>The eeprom is divided into two parts. The complete size of the eeprom is 256+18+24 Byte (0x0000-0x0128).<br/>
 0x0000-0x00FF: Address space for parameters and addresses of the controller/application (0x0100-0x01FF)<br/>
 0x0100-0x0111: User memory (0x00CE-0x00DF), 18 Byte<br/>
 0x0112-0x0129: Application memory (0x0000-0x0017), 24 Byte<br/>
 Handles communication from and to eeprom.  
<a href="#_details">More...</a></p>
<code>#include &quot;<a class="el" href="fb_8h_source.html">fb.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="fb__hardware_8h_source.html">fb_hardware.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="msg__queue_8h_source.html">msg_queue.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="fb__hal_8h_source.html">fb_hal.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="freebus-debug_8h_source.html">freebus-debug.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="fb__eeprom_8h_source.html">fb_eeprom.h</a>&quot;</code><br/>
<div class="dynheader">
Include dependency graph for fb_eeprom.c:</div>
<div class="dynsection">
<div class="center"><img src="fb__eeprom_8c__incl.png" border="0" usemap="#lib_2fb__eeprom_8c_map" alt=""/></div>
<map name="lib_2fb__eeprom_8c_map" id="lib_2fb__eeprom_8c">
<area shape="rect" id="node3" href="fb_8h.html" title="Define general values used in bus communication." alt="" coords="5,83,48,112"/><area shape="rect" id="node5" href="fb__hardware_8h.html" title="Hardware specific options which includes the platforms (like ATmega8, ATmega168...." alt="" coords="77,237,179,267"/><area shape="rect" id="node7" href="msg__queue_8h.html" title="Definitions for the message queue system used for telegrams and communucation like..." alt="" coords="123,160,221,189"/><area shape="rect" id="node10" href="fb__hal_8h.html" title="Definitions on Hardware Abstration Layer." alt="" coords="233,83,300,112"/><area shape="rect" id="node17" href="freebus-debug_8h.html" title="Header file to map debugging between several output devices. Possible outputs are..." alt="" coords="392,83,507,112"/><area shape="rect" id="node25" href="fb__eeprom_8h.html" title="Handling the access and mapping to the eeprom." alt="" coords="531,83,624,112"/><area shape="rect" id="node21" href="lcd-lib_8h.html" title="lcd&#45;lib.h" alt="" coords="589,160,656,189"/><area shape="rect" id="node23" href="delay_8h.html" title="Functions to delay the execution." alt="" coords="591,237,655,267"/></map>
</div>
<table border="0" cellpadding="0" cellspacing="0">
<tr><td colspan="2"><h2>Data Structures</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="structeeprom__cmds.html">eeprom_cmds</a></td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Data will be written to the eeprom byte by byte that structure save data and variables needed to write data to the eeprom.  <a href="structeeprom__cmds.html#_details">More...</a><br/></td></tr>
<tr><td colspan="2"><h2>Typedefs</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">typedef struct <a class="el" href="structeeprom__cmds.html">eeprom_cmds</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="fb__eeprom_8c.html#a03567569fc0750c83035037ece6c0157">EEPROM_CMDS</a></td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Data will be written to the eeprom byte by byte that structure save data and variables needed to write data to the eeprom.  <a href="#a03567569fc0750c83035037ece6c0157"></a><br/></td></tr>
<tr><td colspan="2"><h2>Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="fb__eeprom_8c.html#a6ab1e3cc3c300d12592e39648da8c022">prog_ee</a> (uint16_t addr, uint8_t dat)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Store on byte on eeprom.  <a href="#a6ab1e3cc3c300d12592e39648da8c022"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="fb__eeprom_8c.html#ac92e88b86efd0e0e32beaee667bfc226">trigger_eeprom</a> (void)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Start to write the first byte to eeprom.  <a href="#ac92e88b86efd0e0e32beaee667bfc226"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="fb__eeprom_8c.html#a422cd185036099f4434f337562b3cb1b">write_memory_p</a> (uint16_t addr, uint8_t dat)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Write directly to the eeprom, don't use the eeprom cache.  <a href="#a422cd185036099f4434f337562b3cb1b"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="fb__eeprom_8c.html#a27dee4c5a0efad576a37c10e5f737334">ISR</a> (EE_RDY_vect)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Interrupt handler to write queued eeprom data byte for byte to eeprom without blocking the controller.  <a href="#a27dee4c5a0efad576a37c10e5f737334"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">uint8_t&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="fb__eeprom_8c.html#a15ff5c1dcbf437fa2fb4f730fcd20c85">eeprom_ParamRead</a> (uint16_t addr)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Read data from the eeprom cache and return it.  <a href="#a15ff5c1dcbf437fa2fb4f730fcd20c85"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="fb__eeprom_8c.html#a68f918bbf3e9cd0ec46a706bb5c8b9d3">eeprom_ParamWrite</a> (uint16_t addr, uint8_t len, uint8_t *dat)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Write data to the eeprom cache and trigger background process to write eeprom cache to real eeprom.  <a href="#a68f918bbf3e9cd0ec46a706bb5c8b9d3"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">uint8_t&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="fb__eeprom_8c.html#aa4b1f50ccff861cd630909a662b29b0d">eeprom_busy</a> (void)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Check if eeprom cache was written completely to eeprom.  <a href="#aa4b1f50ccff861cd630909a662b29b0d"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="fb__eeprom_8c.html#a96f365c9a61f6dd9b856c7da3d6fefde">eeprom_ParamSetDefault</a> (const <a class="el" href="structSTRUCT__DEFPARAM.html">STRUCT_DEFPARAM</a> *pParam)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">store the default parameter directly to the eeprom  <a href="#a96f365c9a61f6dd9b856c7da3d6fefde"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="fb__eeprom_8c.html#aef320e016dbb25dac76482345f2ce495">eeprom_Init</a> (uint8_t *<a class="el" href="fb__relais__app_8c.html#a0e697e56b88a7c0fb3b3a3c1e7cd2682">nodeParam</a>, uint16_t paramlen)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Read the eeprom to the eeprom cache.  <a href="#aef320e016dbb25dac76482345f2ce495"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="fb__eeprom_8c.html#a4106e144334e369c48eed9dfe23e593c">eeprom_print</a> (void)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Print the complete eeprom to DEBUG defined.  <a href="#a4106e144334e369c48eed9dfe23e593c"></a><br/></td></tr>
<tr><td colspan="2"><h2>Variables</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">uint8_t *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="fb__eeprom_8c.html#a8b54a9207abfa04fdd10537033a94a37">eeprom_NodeParam</a></td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">parameter structure (pointer)  <a href="#a8b54a9207abfa04fdd10537033a94a37"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">uint16_t&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="fb__eeprom_8c.html#ac361d05f7daac2a71b7f7d881c5e1663">eeprom_NodeParamLen</a></td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">length of the paramater structure  <a href="#ac361d05f7daac2a71b7f7d881c5e1663"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static struct <a class="el" href="structmsg.html">msg</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="fb__eeprom_8c.html#ab39ebd5d0ee54f5e9d3a406a52e6f1df">eeprom_msg</a></td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">EEprom msg queue.  <a href="#ab39ebd5d0ee54f5e9d3a406a52e6f1df"></a><br/></td></tr>
</table>
<hr/><a name="_details"></a><h2>Detailed Description</h2>
<p>The eeprom is divided into two parts. The complete size of the eeprom is 256+18+24 Byte (0x0000-0x0128).<br/>
 0x0000-0x00FF: Address space for parameters and addresses of the controller/application (0x0100-0x01FF)<br/>
 0x0100-0x0111: User memory (0x00CE-0x00DF), 18 Byte<br/>
 0x0112-0x0129: Application memory (0x0000-0x0017), 24 Byte<br/>
 Handles communication from and to eeprom. </p>
<dl class="author"><dt><b>Author:</b></dt><dd>Dirk Opfer, Matthias Fechner, Christian Bode </dd></dl>
<dl class="date"><dt><b>Date:</b></dt><dd>Fri Oct 26 17:18:15 2007</dd></dl>
<p>attention: don't use <a class="el" href="fb__eeprom_8c.html#a6ab1e3cc3c300d12592e39648da8c022" title="Store on byte on eeprom.">prog_ee()</a> with opt-level 0 </p>
<hr/><h2>Typedef Documentation</h2>
<a class="anchor" id="a03567569fc0750c83035037ece6c0157"></a><!-- doxytag: member="fb_eeprom.c::EEPROM_CMDS" ref="a03567569fc0750c83035037ece6c0157" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef struct <a class="el" href="structeeprom__cmds.html">eeprom_cmds</a>  <a class="el" href="structeeprom__cmds.html">EEPROM_CMDS</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Data will be written to the eeprom byte by byte that structure save data and variables needed to write data to the eeprom. </p>

</div>
</div>
<hr/><h2>Function Documentation</h2>
<a class="anchor" id="aa4b1f50ccff861cd630909a662b29b0d"></a><!-- doxytag: member="fb_eeprom.c::eeprom_busy" ref="aa4b1f50ccff861cd630909a662b29b0d" args="(void)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint8_t eeprom_busy </td>
          <td>(</td>
          <td class="paramtype">void&nbsp;</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Check if eeprom cache was written completely to eeprom. </p>
<dl class="return"><dt><b>Returns:</b></dt><dd>TRUE if eeprom cache is not written completely to eeprom </dd></dl>

<p><dl class="todo"><dt><b><a class="el" href="todo.html#_todo000088">Todo:</a></b></dt><dd>???: </dd></dl>
</p>

<p>References <a class="el" href="fb_8h_source.html#l00050">FALSE</a>, <a class="el" href="msg__queue_8h_source.html#l00057">MSG_FREE</a>, <a class="el" href="msg__queue_8h_source.html#l00066">msg::state</a>, and <a class="el" href="fb_8h_source.html#l00054">TRUE</a>.</p>

<p>Referenced by <a class="el" href="fb__prot_8c_source.html#l00637">A_Restart()</a>.</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dynsection">
<div class="center"><img src="fb__eeprom_8c_aa4b1f50ccff861cd630909a662b29b0d_icgraph.png" border="0" usemap="#fb__eeprom_8c_aa4b1f50ccff861cd630909a662b29b0d_icgraph_map" alt=""></div>
<map name="fb__eeprom_8c_aa4b1f50ccff861cd630909a662b29b0d_icgraph_map" id="fb__eeprom_8c_aa4b1f50ccff861cd630909a662b29b0d_icgraph">
<area shape="rect" id="node3" href="fb__prot_8c.html#a088341f3603f5de9eb4817a8199391c6" title="Restart the program on the microcontroller." alt="" coords="155,5,235,35"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="aef320e016dbb25dac76482345f2ce495"></a><!-- doxytag: member="fb_eeprom.c::eeprom_Init" ref="aef320e016dbb25dac76482345f2ce495" args="(uint8_t *nodeParam, uint16_t paramlen)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void eeprom_Init </td>
          <td>(</td>
          <td class="paramtype">uint8_t *&nbsp;</td>
          <td class="paramname"> <em>nodeParam</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint16_t&nbsp;</td>
          <td class="paramname"> <em>paramlen</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Read the eeprom to the eeprom cache. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>nodeParam</em>&nbsp;</td><td></td></tr>
    <tr><td valign="top"></td><td valign="top"><em>paramlen</em>&nbsp;</td><td></td></tr>
  </table>
  </dd>
</dl>

<p>References <a class="el" href="fb__eeprom_8c_source.html#l00062">eeprom_NodeParam</a>, and <a class="el" href="fb__eeprom_8c_source.html#l00063">eeprom_NodeParamLen</a>.</p>

<p>Referenced by <a class="el" href="fb__in8__app_8c_source.html#l00870">main()</a>.</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dynsection">
<div class="center"><img src="fb__eeprom_8c_aef320e016dbb25dac76482345f2ce495_icgraph.png" border="0" usemap="#fb__eeprom_8c_aef320e016dbb25dac76482345f2ce495_icgraph_map" alt=""></div>
<map name="fb__eeprom_8c_aef320e016dbb25dac76482345f2ce495_icgraph_map" id="fb__eeprom_8c_aef320e016dbb25dac76482345f2ce495_icgraph">
<area shape="rect" id="node3" href="fb__in8__app_8c.html#a840291bc02cba5474a4cb46a9b9566fe" title="The start point of the program, init all libraries, start the bus interface, the..." alt="" coords="144,5,195,35"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a15ff5c1dcbf437fa2fb4f730fcd20c85"></a><!-- doxytag: member="fb_eeprom.c::eeprom_ParamRead" ref="a15ff5c1dcbf437fa2fb4f730fcd20c85" args="(uint16_t addr)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint8_t eeprom_ParamRead </td>
          <td>(</td>
          <td class="paramtype">uint16_t&nbsp;</td>
          <td class="paramname"> <em>addr</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Read data from the eeprom cache and return it. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>addr</em>&nbsp;</td><td>The address from the eeprom to read the data</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>Value in eeprom on addr </dd></dl>

<p>References <a class="el" href="fb__eeprom_8h_source.html#l00048">APPLICATION_MEM_BASE_ADR</a>, <a class="el" href="fb__eeprom_8h_source.html#l00049">APPLICATION_MEM_SIZE</a>, <a class="el" href="fb__eeprom_8h_source.html#l00045">BASE_ADDRESS_OFFSET</a>, <a class="el" href="fb__eeprom_8c_source.html#l00062">eeprom_NodeParam</a>, <a class="el" href="fb__eeprom_8h_source.html#l00046">NODEPARAM_SIZE</a>, <a class="el" href="fb__hal_8h_source.html#l00083">systemState</a>, <a class="el" href="fb__eeprom_8h_source.html#l00050">SYSTEMSTATE</a>, <a class="el" href="fb__eeprom_8h_source.html#l00051">USERRAM_BASE_ADR</a>, and <a class="el" href="fb__eeprom_8h_source.html#l00052">USERRAM_SIZE</a>.</p>

<p>Referenced by <a class="el" href="fb__prot_8c_source.html#l00594">A_ADC_Read()</a>, <a class="el" href="fb__prot_8c_source.html#l00669">A_GroupValue_Read()</a>, <a class="el" href="fb__prot_8c_source.html#l00698">A_GroupValue_Write()</a>, <a class="el" href="fb__prot_8c_source.html#l00517">A_Memory_Read()</a>, <a class="el" href="fb__prot_8c_source.html#l00904">fbprot_Init()</a>, <a class="el" href="fb__prot_8c_source.html#l00247">findRespondGroupAddressByObjectNumber()</a>, <a class="el" href="fb__in8__app_8c_source.html#l00422">getPortFunction()</a>, <a class="el" href="fb__in8__app_8c_source.html#l00645">PortFunc_Jalousie()</a>, <a class="el" href="fb__in8__app_8c_source.html#l00497">PortFunc_Switch()</a>, <a class="el" href="fb__prot_8c_source.html#l00280">read_grp_addr()</a>, <a class="el" href="fb__relais__app_8c_source.html#l00284">readApplication()</a>, <a class="el" href="fb__in8__app_8c_source.html#l00330">restartApplication()</a>, <a class="el" href="fb__relais__app_8c_source.html#l00356">runApplication()</a>, <a class="el" href="fb__prot_8c_source.html#l00163">sendExtTelegram()</a>, <a class="el" href="fb__prot_8c_source.html#l00208">sendTelegram()</a>, <a class="el" href="fb__hal_8c_source.html#l00219">sendTestTelegram()</a>, <a class="el" href="fb__relais__app_8c_source.html#l00505">switchObjects()</a>, and <a class="el" href="fb__in8__app_8c_source.html#l00181">timerOverflowFunction()</a>.</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dynsection">
<div class="center"><img src="fb__eeprom_8c_a15ff5c1dcbf437fa2fb4f730fcd20c85_icgraph.png" border="0" usemap="#fb__eeprom_8c_a15ff5c1dcbf437fa2fb4f730fcd20c85_icgraph_map" alt=""></div>
<map name="fb__eeprom_8c_a15ff5c1dcbf437fa2fb4f730fcd20c85_icgraph_map" id="fb__eeprom_8c_a15ff5c1dcbf437fa2fb4f730fcd20c85_icgraph">
<area shape="rect" id="node3" href="fb__prot_8c.html#a4a0be801ed4f2d9b2cbce548adf56a76" title="Read the values from the ADC converter." alt="" coords="281,5,383,35"/><area shape="rect" id="node5" href="fb__prot_8c.html#ae56aada1e48493023c8f3ecf7a1e71a7" title="A read request to the application." alt="" coords="261,59,403,88"/><area shape="rect" id="node7" href="fb__prot_8c.html#abb5d4fc672e3e3e123f5f3e6e9f901e3" title="Is called if a broadcast is received with a matching group address (eg." alt="" coords="260,112,404,141"/><area shape="rect" id="node9" href="fb__prot_8c.html#af2931210aae10a2c39698d2f1fb3c98c" title="Read data from eeprom and return send it as telegram back to the requester." alt="" coords="271,165,393,195"/><area shape="rect" id="node11" href="fb__prot_8c.html#a3e2ec796b82409111b3a88a764b17e4b" title="Read configuration from eeprom is existant or set default values and write them to..." alt="" coords="553,271,631,300"/><area shape="rect" id="node15" href="fb__prot_8c.html#ac5c589c547e7f53fb4b2c9bbbbe8797a" title="Search through group address list and return the matching position of a group address..." alt="" coords="195,475,469,504"/><area shape="rect" id="node17" href="fb__prot_8c.html#ade80ef84f4f14d25a2283b43d9c1a54f" title="Send telegram as response to signal current state of the port to other devices." alt="" coords="531,448,653,477"/><area shape="rect" id="node19" href="fb__prot_8c.html#a990a78673785da5bb024bfaf60e0984a" title="Send telegram as response to signal current state of the port to other devices." alt="" coords="541,525,643,555"/><area shape="rect" id="node21" href="fb__in8__app_8c.html#a8d1473313842fe123fec771c086af269" title="Port Function: Jalousie." alt="" coords="716,573,844,603"/><area shape="rect" id="node23" href="fb__in8__app_8c.html#a3cabe34d9b90083ff13af0188e622539" title="Timer1 is used as application timer." alt="" coords="893,573,1043,603"/><area shape="rect" id="node25" href="fb__in8__app_8c.html#a71a91b98ae9a796dac4ab23c7e3ff6d8" title="Port Function: switch." alt="" coords="720,627,840,656"/><area shape="rect" id="node29" href="fb__in8__app_8c.html#ac5f68c3b0256b1990defd5eb2f2f1967" title="Get the function code for the select port." alt="" coords="723,420,837,449"/><area shape="rect" id="node34" href="fb__prot_8c.html#aaec72f885e36952a75395779cf20d684" title="Read the group addresses from the eeprom and save them in the struct grp_addr." alt="" coords="280,269,384,299"/><area shape="rect" id="node37" href="fb__relais__app_8c.html#acdb92216340d9fc010cc12bbb44bbfb2" title="Read status from port and return it." alt="" coords="277,731,387,760"/><area shape="rect" id="node39" href="fb__in8__app_8c.html#aabc97de0ba2150af0af7d2ddb8293824" title="Function is called when microcontroller gets power or if the application must be..." alt="" coords="271,784,393,813"/><area shape="rect" id="node41" href="fb__relais__app_8c.html#a30773cfc4105728c9628fca36c8c7c20" title="Function is called if A_GroupValue_Write is received." alt="" coords="540,835,644,864"/><area shape="rect" id="node45" href="fb__hal_8c.html#ab475358073d6ed6f59de0b9fd41e65ee" title="That function can be use to send a test telegramm to the bus, e.g." alt="" coords="528,217,656,247"/><area shape="rect" id="node48" href="fb__relais__app_8c.html#aac9e4f65925a5a959cb5df9ed091b3b7" title="Switch the objects to state in portValue and save value to eeprom if necessary." alt="" coords="280,888,384,917"/><area shape="rect" id="node13" href="fb__in8__app_8c.html#a840291bc02cba5474a4cb46a9b9566fe" title="The start point of the program, init all libraries, start the bus interface, the..." alt="" coords="755,244,805,273"/><area shape="rect" id="node50" href="fb__relais__app_8c.html#aabc97de0ba2150af0af7d2ddb8293824" title="Function is called when microcontroller gets power or if the application must be..." alt="" coords="531,888,653,917"/><area shape="rect" id="node53" href="fb__relais__app_8c.html#a3cabe34d9b90083ff13af0188e622539" title="Timer1 is used as application timer." alt="" coords="517,941,667,971"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a96f365c9a61f6dd9b856c7da3d6fefde"></a><!-- doxytag: member="fb_eeprom.c::eeprom_ParamSetDefault" ref="a96f365c9a61f6dd9b856c7da3d6fefde" args="(const STRUCT_DEFPARAM *pParam)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void eeprom_ParamSetDefault </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structSTRUCT__DEFPARAM.html">STRUCT_DEFPARAM</a> *&nbsp;</td>
          <td class="paramname"> <em>pParam</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>store the default parameter directly to the eeprom </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>pParam</em>&nbsp;</td><td></td></tr>
  </table>
  </dd>
</dl>

<p>References <a class="el" href="fb__eeprom_8c_source.html#l00052">eeprom_cmds::addr</a>, <a class="el" href="fb__eeprom_8h_source.html#l00045">BASE_ADDRESS_OFFSET</a>, <a class="el" href="fb__eeprom_8c_source.html#l00062">eeprom_NodeParam</a>, <a class="el" href="fb__eeprom_8c_source.html#l00063">eeprom_NodeParamLen</a>, <a class="el" href="fb__eeprom_8h_source.html#l00056">MAX_EEPROM_SIZE</a>, <a class="el" href="fb__eeprom_8h_source.html#l00046">NODEPARAM_SIZE</a>, and <a class="el" href="fb__eeprom_8c_source.html#l00084">prog_ee()</a>.</p>

<p>Referenced by <a class="el" href="fb__prot_8c_source.html#l00904">fbprot_Init()</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dynsection">
<div class="center"><img src="fb__eeprom_8c_a96f365c9a61f6dd9b856c7da3d6fefde_cgraph.png" border="0" usemap="#fb__eeprom_8c_a96f365c9a61f6dd9b856c7da3d6fefde_cgraph_map" alt=""></div>
<map name="fb__eeprom_8c_a96f365c9a61f6dd9b856c7da3d6fefde_cgraph_map" id="fb__eeprom_8c_a96f365c9a61f6dd9b856c7da3d6fefde_cgraph">
<area shape="rect" id="node3" href="fb__eeprom_8c.html#a6ab1e3cc3c300d12592e39648da8c022" title="Store on byte on eeprom." alt="" coords="225,5,292,35"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dynsection">
<div class="center"><img src="fb__eeprom_8c_a96f365c9a61f6dd9b856c7da3d6fefde_icgraph.png" border="0" usemap="#fb__eeprom_8c_a96f365c9a61f6dd9b856c7da3d6fefde_icgraph_map" alt=""></div>
<map name="fb__eeprom_8c_a96f365c9a61f6dd9b856c7da3d6fefde_icgraph_map" id="fb__eeprom_8c_a96f365c9a61f6dd9b856c7da3d6fefde_icgraph">
<area shape="rect" id="node3" href="fb__prot_8c.html#a3e2ec796b82409111b3a88a764b17e4b" title="Read configuration from eeprom is existant or set default values and write them to..." alt="" coords="225,5,303,35"/><area shape="rect" id="node5" href="fb__in8__app_8c.html#a840291bc02cba5474a4cb46a9b9566fe" title="The start point of the program, init all libraries, start the bus interface, the..." alt="" coords="352,5,403,35"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a68f918bbf3e9cd0ec46a706bb5c8b9d3"></a><!-- doxytag: member="fb_eeprom.c::eeprom_ParamWrite" ref="a68f918bbf3e9cd0ec46a706bb5c8b9d3" args="(uint16_t addr, uint8_t len, uint8_t *dat)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void eeprom_ParamWrite </td>
          <td>(</td>
          <td class="paramtype">uint16_t&nbsp;</td>
          <td class="paramname"> <em>addr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t&nbsp;</td>
          <td class="paramname"> <em>len</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t *&nbsp;</td>
          <td class="paramname"> <em>dat</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Write data to the eeprom cache and trigger background process to write eeprom cache to real eeprom. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>addr</em>&nbsp;</td><td>start address of the data in the eeprom </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>len</em>&nbsp;</td><td>length of data </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>dat</em>&nbsp;</td><td>data to write in the eeprom </td></tr>
  </table>
  </dd>
</dl>

<p>References <a class="el" href="fb__eeprom_8c_source.html#l00052">eeprom_cmds::addr</a>, <a class="el" href="msg__queue_8h_source.html#l00110">AllocMsg()</a>, <a class="el" href="fb__eeprom_8h_source.html#l00048">APPLICATION_MEM_BASE_ADR</a>, <a class="el" href="fb__eeprom_8h_source.html#l00049">APPLICATION_MEM_SIZE</a>, <a class="el" href="fb__eeprom_8h_source.html#l00045">BASE_ADDRESS_OFFSET</a>, <a class="el" href="fb__eeprom_8c_source.html#l00051">eeprom_cmds::count</a>, <a class="el" href="fb__eeprom_8c_source.html#l00054">eeprom_cmds::data</a>, <a class="el" href="msg__queue_8h_source.html#l00070">msg::data</a>, <a class="el" href="fb__eeprom_8c_source.html#l00062">eeprom_NodeParam</a>, <a class="el" href="fb__eeprom_8h_source.html#l00046">NODEPARAM_SIZE</a>, <a class="el" href="fb__eeprom_8c_source.html#l00053">eeprom_cmds::offset</a>, <a class="el" href="msg__queue_8c_source.html#l00085">queuemsg()</a>, <a class="el" href="fb__hal_8h_source.html#l00083">systemState</a>, <a class="el" href="fb__eeprom_8h_source.html#l00050">SYSTEMSTATE</a>, <a class="el" href="fb__eeprom_8c_source.html#l00152">trigger_eeprom()</a>, <a class="el" href="fb__eeprom_8h_source.html#l00051">USERRAM_BASE_ADR</a>, and <a class="el" href="fb__eeprom_8h_source.html#l00052">USERRAM_SIZE</a>.</p>

<p>Referenced by <a class="el" href="fb__prot_8c_source.html#l00566">A_Memory_Write()</a>, <a class="el" href="fb__prot_8c_source.html#l00358">A_PhysicalAddress_Write()</a>, and <a class="el" href="fb__relais__app_8c_source.html#l00505">switchObjects()</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dynsection">
<div class="center"><img src="fb__eeprom_8c_a68f918bbf3e9cd0ec46a706bb5c8b9d3_cgraph.png" border="0" usemap="#fb__eeprom_8c_a68f918bbf3e9cd0ec46a706bb5c8b9d3_cgraph_map" alt=""></div>
<map name="fb__eeprom_8c_a68f918bbf3e9cd0ec46a706bb5c8b9d3_cgraph_map" id="fb__eeprom_8c_a68f918bbf3e9cd0ec46a706bb5c8b9d3_cgraph">
<area shape="rect" id="node3" href="msg__queue_8h.html#aadc5609c7a2263c8cae4ab0d8eae7c4d" title="Allocate a new message." alt="" coords="212,5,287,35"/><area shape="rect" id="node9" href="msg__queue_8h.html#af35d846267d1aaaf1df04c8bff03047e" title="Add a new message to the message queue." alt="" coords="208,59,291,88"/><area shape="rect" id="node11" href="fb__eeprom_8c.html#ac92e88b86efd0e0e32beaee667bfc226" title="Start to write the first byte to eeprom." alt="" coords="196,112,303,141"/><area shape="rect" id="node5" href="msg__queue_8h.html#aa3b6fa424df78c0dbbbaa16a7dd32acb" title="Allocate space for a message and return a pointer to it." alt="" coords="353,5,431,35"/><area shape="rect" id="node7" href="fb__hal_8h.html#a29aed42c30189a510295e50c98f34afc" title="Hold application and set blink code to PORTB pin 0, our prog pin and LED." alt="" coords="480,5,533,35"/><area shape="rect" id="node13" href="fb__eeprom_8c.html#a6ab1e3cc3c300d12592e39648da8c022" title="Store on byte on eeprom." alt="" coords="359,112,425,141"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dynsection">
<div class="center"><img src="fb__eeprom_8c_a68f918bbf3e9cd0ec46a706bb5c8b9d3_icgraph.png" border="0" usemap="#fb__eeprom_8c_a68f918bbf3e9cd0ec46a706bb5c8b9d3_icgraph_map" alt=""></div>
<map name="fb__eeprom_8c_a68f918bbf3e9cd0ec46a706bb5c8b9d3_icgraph_map" id="fb__eeprom_8c_a68f918bbf3e9cd0ec46a706bb5c8b9d3_icgraph">
<area shape="rect" id="node3" href="fb__prot_8c.html#afae8acdc71d1ebff494c621459c097cf" title="Write recieved data to the eeprom." alt="" coords="221,5,344,35"/><area shape="rect" id="node5" href="fb__prot_8c.html#ac3b30c7591e51974ab895440929395c6" title="Set the received address as our new device address." alt="" coords="196,59,369,88"/><area shape="rect" id="node7" href="fb__relais__app_8c.html#aac9e4f65925a5a959cb5df9ed091b3b7" title="Switch the objects to state in portValue and save value to eeprom if necessary." alt="" coords="231,112,335,141"/><area shape="rect" id="node9" href="fb__relais__app_8c.html#aabc97de0ba2150af0af7d2ddb8293824" title="Function is called when microcontroller gets power or if the application must be..." alt="" coords="432,59,555,88"/><area shape="rect" id="node11" href="fb__relais__app_8c.html#a30773cfc4105728c9628fca36c8c7c20" title="Function is called if A_GroupValue_Write is received." alt="" coords="441,112,545,141"/><area shape="rect" id="node13" href="fb__relais__app_8c.html#a3cabe34d9b90083ff13af0188e622539" title="Timer1 is used as application timer." alt="" coords="419,165,568,195"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a4106e144334e369c48eed9dfe23e593c"></a><!-- doxytag: member="fb_eeprom.c::eeprom_print" ref="a4106e144334e369c48eed9dfe23e593c" args="(void)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void eeprom_print </td>
          <td>(</td>
          <td class="paramtype">void&nbsp;</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Print the complete eeprom to DEBUG defined. </p>

<p>References <a class="el" href="fb__eeprom_8c_source.html#l00052">eeprom_cmds::addr</a>, <a class="el" href="freebus-debug_8h_source.html#l00069">DEBUG_NEWLINE_BLOCKING</a>, <a class="el" href="freebus-debug_8h_source.html#l00055">DEBUG_PUTC_BLOCKING</a>, <a class="el" href="freebus-debug_8h_source.html#l00065">DEBUG_PUTHEX_BLOCKING</a>, and <a class="el" href="fb__eeprom_8c_source.html#l00062">eeprom_NodeParam</a>.</p>

<p>Referenced by <a class="el" href="fb__prot_8c_source.html#l00904">fbprot_Init()</a>.</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dynsection">
<div class="center"><img src="fb__eeprom_8c_a4106e144334e369c48eed9dfe23e593c_icgraph.png" border="0" usemap="#fb__eeprom_8c_a4106e144334e369c48eed9dfe23e593c_icgraph_map" alt=""></div>
<map name="fb__eeprom_8c_a4106e144334e369c48eed9dfe23e593c_icgraph_map" id="fb__eeprom_8c_a4106e144334e369c48eed9dfe23e593c_icgraph">
<area shape="rect" id="node3" href="fb__prot_8c.html#a3e2ec796b82409111b3a88a764b17e4b" title="Read configuration from eeprom is existant or set default values and write them to..." alt="" coords="153,5,231,35"/><area shape="rect" id="node5" href="fb__in8__app_8c.html#a840291bc02cba5474a4cb46a9b9566fe" title="The start point of the program, init all libraries, start the bus interface, the..." alt="" coords="280,5,331,35"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a27dee4c5a0efad576a37c10e5f737334"></a><!-- doxytag: member="fb_eeprom.c::ISR" ref="a27dee4c5a0efad576a37c10e5f737334" args="(EE_RDY_vect)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">ISR </td>
          <td>(</td>
          <td class="paramtype">EE_RDY_vect&nbsp;</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Interrupt handler to write queued eeprom data byte for byte to eeprom without blocking the controller. </p>
<dl class="return"><dt><b>Returns:</b></dt><dd></dd></dl>

<p><dl class="todo"><dt><b><a class="el" href="todo.html#_todo000085">Todo:</a></b></dt><dd>ist noch unsauber </dd></dl>
</p>

<p>References <a class="el" href="fb__eeprom_8c_source.html#l00052">eeprom_cmds::addr</a>, <a class="el" href="fb__eeprom_8c_source.html#l00051">eeprom_cmds::count</a>, <a class="el" href="fb__eeprom_8c_source.html#l00054">eeprom_cmds::data</a>, <a class="el" href="msg__queue_8h_source.html#l00070">msg::data</a>, <a class="el" href="msg__queue_8c_source.html#l00116">dequeuemsg()</a>, <a class="el" href="fb__eeprom_8c_source.html#l00053">eeprom_cmds::offset</a>, and <a class="el" href="fb__eeprom_8c_source.html#l00084">prog_ee()</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dynsection">
<div class="center"><img src="fb__eeprom_8c_a27dee4c5a0efad576a37c10e5f737334_cgraph.png" border="0" usemap="#fb__eeprom_8c_a27dee4c5a0efad576a37c10e5f737334_cgraph_map" alt=""></div>
<map name="fb__eeprom_8c_a27dee4c5a0efad576a37c10e5f737334_cgraph_map" id="fb__eeprom_8c_a27dee4c5a0efad576a37c10e5f737334_cgraph">
<area shape="rect" id="node3" href="msg__queue_8h.html#a76c904b1fd4cb70e06c96422f8a58e43" title="Remove a message from the queue." alt="" coords="96,5,192,35"/><area shape="rect" id="node7" href="fb__eeprom_8c.html#a6ab1e3cc3c300d12592e39648da8c022" title="Store on byte on eeprom." alt="" coords="111,59,177,88"/><area shape="rect" id="node5" href="msg__queue_8h.html#afec1149f3bb049af42978cf90c775ca6" title="Free the message and mark it as MSG_FREE." alt="" coords="241,5,313,35"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a6ab1e3cc3c300d12592e39648da8c022"></a><!-- doxytag: member="fb_eeprom.c::prog_ee" ref="a6ab1e3cc3c300d12592e39648da8c022" args="(uint16_t addr, uint8_t dat)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static void prog_ee </td>
          <td>(</td>
          <td class="paramtype">uint16_t&nbsp;</td>
          <td class="paramname"> <em>addr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t&nbsp;</td>
          <td class="paramname"> <em>dat</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Store on byte on eeprom. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>addr</em>&nbsp;</td><td>Adress in eeprom to save data </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>dat</em>&nbsp;</td><td>Data to store </td></tr>
  </table>
  </dd>
</dl>

<p>Referenced by <a class="el" href="fb__eeprom_8c_source.html#l00268">eeprom_ParamSetDefault()</a>, <a class="el" href="fb__eeprom_8c_source.html#l00126">ISR()</a>, <a class="el" href="fb__eeprom_8c_source.html#l00152">trigger_eeprom()</a>, and <a class="el" href="fb__eeprom_8c_source.html#l00107">write_memory_p()</a>.</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dynsection">
<div class="center"><img src="fb__eeprom_8c_a6ab1e3cc3c300d12592e39648da8c022_icgraph.png" border="0" usemap="#fb__eeprom_8c_a6ab1e3cc3c300d12592e39648da8c022_icgraph_map" alt=""></div>
<map name="fb__eeprom_8c_a6ab1e3cc3c300d12592e39648da8c022_icgraph_map" id="fb__eeprom_8c_a6ab1e3cc3c300d12592e39648da8c022_icgraph">
<area shape="rect" id="node3" href="fb__eeprom_8c.html#a96f365c9a61f6dd9b856c7da3d6fefde" title="store the default parameter directly to the eeprom" alt="" coords="123,5,293,35"/><area shape="rect" id="node9" href="fb__eeprom_8c.html#a27dee4c5a0efad576a37c10e5f737334" title="Interrupt handler to write queued eeprom data byte for byte to eeprom without blocking..." alt="" coords="187,59,229,88"/><area shape="rect" id="node11" href="fb__eeprom_8c.html#ac92e88b86efd0e0e32beaee667bfc226" title="Start to write the first byte to eeprom." alt="" coords="155,112,261,141"/><area shape="rect" id="node27" href="fb__eeprom_8c.html#a422cd185036099f4434f337562b3cb1b" title="Write directly to the eeprom, don&#39;t use the eeprom cache." alt="" coords="149,165,267,195"/><area shape="rect" id="node5" href="fb__prot_8c.html#a3e2ec796b82409111b3a88a764b17e4b" title="Read configuration from eeprom is existant or set default values and write them to..." alt="" coords="379,5,456,35"/><area shape="rect" id="node7" href="fb__in8__app_8c.html#a840291bc02cba5474a4cb46a9b9566fe" title="The start point of the program, init all libraries, start the bus interface, the..." alt="" coords="604,5,655,35"/><area shape="rect" id="node13" href="fb__eeprom_8c.html#a68f918bbf3e9cd0ec46a706bb5c8b9d3" title="Write data to the eeprom cache and trigger background process to write eeprom cache..." alt="" coords="347,112,488,141"/><area shape="rect" id="node15" href="fb__prot_8c.html#afae8acdc71d1ebff494c621459c097cf" title="Write recieved data to the eeprom." alt="" coords="568,59,691,88"/><area shape="rect" id="node17" href="fb__prot_8c.html#ac3b30c7591e51974ab895440929395c6" title="Set the received address as our new device address." alt="" coords="543,112,716,141"/><area shape="rect" id="node19" href="fb__relais__app_8c.html#aac9e4f65925a5a959cb5df9ed091b3b7" title="Switch the objects to state in portValue and save value to eeprom if necessary." alt="" coords="577,165,681,195"/><area shape="rect" id="node21" href="fb__relais__app_8c.html#aabc97de0ba2150af0af7d2ddb8293824" title="Function is called when microcontroller gets power or if the application must be..." alt="" coords="779,112,901,141"/><area shape="rect" id="node23" href="fb__relais__app_8c.html#a30773cfc4105728c9628fca36c8c7c20" title="Function is called if A_GroupValue_Write is received." alt="" coords="788,165,892,195"/><area shape="rect" id="node25" href="fb__relais__app_8c.html#a3cabe34d9b90083ff13af0188e622539" title="Timer1 is used as application timer." alt="" coords="765,219,915,248"/><area shape="rect" id="node29" href="fb__2-dimmer__app_8h.html#aae3384a1209f19fced106416ac96670e" title="Set parameters to defined values if controller got power the first time." alt="" coords="343,165,492,195"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="ac92e88b86efd0e0e32beaee667bfc226"></a><!-- doxytag: member="fb_eeprom.c::trigger_eeprom" ref="ac92e88b86efd0e0e32beaee667bfc226" args="(void)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static void trigger_eeprom </td>
          <td>(</td>
          <td class="paramtype">void&nbsp;</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [inline, static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Start to write the first byte to eeprom. </p>
<p>The rest of the data is written to the eeprom with the ISR EE_RDY_vect. </p>

<p><dl class="todo"><dt><b><a class="el" href="todo.html#_todo000086">Todo:</a></b></dt><dd>Aenderung ist binaercompatibel </dd></dl>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000087">Todo:</a></b></dt><dd>compare with revision 1049. if eeprom_msg is NULL that if case will fail </dd></dl>
<dl class="bug"><dt><b><a class="el" href="bug.html#_bug000001">Bug:</a></b></dt><dd>if case will fail when eeprom_msg is NULL (the case when no message is queued) compare with revision 1049 </dd></dl>
</p>

<p>References <a class="el" href="fb__eeprom_8c_source.html#l00052">eeprom_cmds::addr</a>, <a class="el" href="fb__eeprom_8c_source.html#l00054">eeprom_cmds::data</a>, <a class="el" href="msg__queue_8h_source.html#l00070">msg::data</a>, <a class="el" href="msg__queue_8h_source.html#l00058">MSG_ALLOC</a>, <a class="el" href="msg__queue_8h_source.html#l00059">MSG_SENDING</a>, <a class="el" href="fb__eeprom_8c_source.html#l00053">eeprom_cmds::offset</a>, <a class="el" href="fb__eeprom_8c_source.html#l00084">prog_ee()</a>, and <a class="el" href="msg__queue_8h_source.html#l00066">msg::state</a>.</p>

<p>Referenced by <a class="el" href="fb__eeprom_8c_source.html#l00210">eeprom_ParamWrite()</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dynsection">
<div class="center"><img src="fb__eeprom_8c_ac92e88b86efd0e0e32beaee667bfc226_cgraph.png" border="0" usemap="#fb__eeprom_8c_ac92e88b86efd0e0e32beaee667bfc226_cgraph_map" alt=""></div>
<map name="fb__eeprom_8c_ac92e88b86efd0e0e32beaee667bfc226_cgraph_map" id="fb__eeprom_8c_ac92e88b86efd0e0e32beaee667bfc226_cgraph">
<area shape="rect" id="node3" href="fb__eeprom_8c.html#a6ab1e3cc3c300d12592e39648da8c022" title="Store on byte on eeprom." alt="" coords="164,5,231,35"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dynsection">
<div class="center"><img src="fb__eeprom_8c_ac92e88b86efd0e0e32beaee667bfc226_icgraph.png" border="0" usemap="#fb__eeprom_8c_ac92e88b86efd0e0e32beaee667bfc226_icgraph_map" alt=""></div>
<map name="fb__eeprom_8c_ac92e88b86efd0e0e32beaee667bfc226_icgraph_map" id="fb__eeprom_8c_ac92e88b86efd0e0e32beaee667bfc226_icgraph">
<area shape="rect" id="node3" href="fb__eeprom_8c.html#a68f918bbf3e9cd0ec46a706bb5c8b9d3" title="Write data to the eeprom cache and trigger background process to write eeprom cache..." alt="" coords="163,59,304,88"/><area shape="rect" id="node5" href="fb__prot_8c.html#afae8acdc71d1ebff494c621459c097cf" title="Write recieved data to the eeprom." alt="" coords="379,5,501,35"/><area shape="rect" id="node7" href="fb__prot_8c.html#ac3b30c7591e51974ab895440929395c6" title="Set the received address as our new device address." alt="" coords="353,59,527,88"/><area shape="rect" id="node9" href="fb__relais__app_8c.html#aac9e4f65925a5a959cb5df9ed091b3b7" title="Switch the objects to state in portValue and save value to eeprom if necessary." alt="" coords="388,112,492,141"/><area shape="rect" id="node11" href="fb__relais__app_8c.html#aabc97de0ba2150af0af7d2ddb8293824" title="Function is called when microcontroller gets power or if the application must be..." alt="" coords="589,59,712,88"/><area shape="rect" id="node13" href="fb__relais__app_8c.html#a30773cfc4105728c9628fca36c8c7c20" title="Function is called if A_GroupValue_Write is received." alt="" coords="599,112,703,141"/><area shape="rect" id="node15" href="fb__relais__app_8c.html#a3cabe34d9b90083ff13af0188e622539" title="Timer1 is used as application timer." alt="" coords="576,165,725,195"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a422cd185036099f4434f337562b3cb1b"></a><!-- doxytag: member="fb_eeprom.c::write_memory_p" ref="a422cd185036099f4434f337562b3cb1b" args="(uint16_t addr, uint8_t dat)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void write_memory_p </td>
          <td>(</td>
          <td class="paramtype">uint16_t&nbsp;</td>
          <td class="paramname"> <em>addr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t&nbsp;</td>
          <td class="paramname"> <em>dat</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Write directly to the eeprom, don't use the eeprom cache. </p>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000084">Todo:</a></b></dt><dd>Funktion <a class="el" href="fb__eeprom_8c.html#a422cd185036099f4434f337562b3cb1b" title="Write directly to the eeprom, don&#39;t use the eeprom cache.">write_memory_p()</a> duch <a class="el" href="fb__eeprom_8h.html#a7b1be2223a2fe16a4791caa396ca5253" title="store the default parameter directly to the eeprom">eeprom_ParamSetDefault()</a> ersetzen </dd></dl>
<p>You have to call eeprom_init() to sync eeprom cache to eeprom data. In normal situation you should use write_eeprom_block instead!</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>addr</em>&nbsp;</td><td></td></tr>
    <tr><td valign="top"></td><td valign="top"><em>dat</em>&nbsp;</td><td></td></tr>
  </table>
  </dd>
</dl>

<p>References <a class="el" href="fb__eeprom_8c_source.html#l00084">prog_ee()</a>.</p>

<p>Referenced by <a class="el" href="fb__2-dimmer__app_8c_source.html#l00174">setApplicationDefaults()</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dynsection">
<div class="center"><img src="fb__eeprom_8c_a422cd185036099f4434f337562b3cb1b_cgraph.png" border="0" usemap="#fb__eeprom_8c_a422cd185036099f4434f337562b3cb1b_cgraph_map" alt=""></div>
<map name="fb__eeprom_8c_a422cd185036099f4434f337562b3cb1b_cgraph_map" id="fb__eeprom_8c_a422cd185036099f4434f337562b3cb1b_cgraph">
<area shape="rect" id="node3" href="fb__eeprom_8c.html#a6ab1e3cc3c300d12592e39648da8c022" title="Store on byte on eeprom." alt="" coords="172,5,239,35"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dynsection">
<div class="center"><img src="fb__eeprom_8c_a422cd185036099f4434f337562b3cb1b_icgraph.png" border="0" usemap="#fb__eeprom_8c_a422cd185036099f4434f337562b3cb1b_icgraph_map" alt=""></div>
<map name="fb__eeprom_8c_a422cd185036099f4434f337562b3cb1b_icgraph_map" id="fb__eeprom_8c_a422cd185036099f4434f337562b3cb1b_icgraph">
<area shape="rect" id="node3" href="fb__2-dimmer__app_8h.html#aae3384a1209f19fced106416ac96670e" title="Set parameters to defined values if controller got power the first time." alt="" coords="172,5,321,35"/></map>
</div>
</p>

</div>
</div>
<hr/><h2>Variable Documentation</h2>
<a class="anchor" id="ab39ebd5d0ee54f5e9d3a406a52e6f1df"></a><!-- doxytag: member="fb_eeprom.c::eeprom_msg" ref="ab39ebd5d0ee54f5e9d3a406a52e6f1df" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="structmsg.html">msg</a>* <a class="el" href="fb__eeprom_8c.html#ab39ebd5d0ee54f5e9d3a406a52e6f1df">eeprom_msg</a><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>EEprom msg queue. </p>

</div>
</div>
<a class="anchor" id="a8b54a9207abfa04fdd10537033a94a37"></a><!-- doxytag: member="fb_eeprom.c::eeprom_NodeParam" ref="a8b54a9207abfa04fdd10537033a94a37" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint8_t* <a class="el" href="fb__eeprom_8c.html#a8b54a9207abfa04fdd10537033a94a37">eeprom_NodeParam</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>parameter structure (pointer) </p>

<p>Referenced by <a class="el" href="fb__eeprom_8c_source.html#l00302">eeprom_Init()</a>, <a class="el" href="fb__eeprom_8c_source.html#l00178">eeprom_ParamRead()</a>, <a class="el" href="fb__eeprom_8c_source.html#l00268">eeprom_ParamSetDefault()</a>, <a class="el" href="fb__eeprom_8c_source.html#l00210">eeprom_ParamWrite()</a>, and <a class="el" href="fb__eeprom_8c_source.html#l00323">eeprom_print()</a>.</p>

</div>
</div>
<a class="anchor" id="ac361d05f7daac2a71b7f7d881c5e1663"></a><!-- doxytag: member="fb_eeprom.c::eeprom_NodeParamLen" ref="ac361d05f7daac2a71b7f7d881c5e1663" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint16_t <a class="el" href="fb__eeprom_8c.html#ac361d05f7daac2a71b7f7d881c5e1663">eeprom_NodeParamLen</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>length of the paramater structure </p>

<p>Referenced by <a class="el" href="fb__eeprom_8c_source.html#l00302">eeprom_Init()</a>, and <a class="el" href="fb__eeprom_8c_source.html#l00268">eeprom_ParamSetDefault()</a>.</p>

</div>
</div>
</div>
<hr size="1"/><address style="text-align: right;"><small>Generated by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.6.2 </small></address>
</body>
</html>
