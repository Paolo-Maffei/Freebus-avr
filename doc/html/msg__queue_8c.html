<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>FreeBusAVR: lib/msg_queue.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- Generated by Doxygen 1.6.3 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="main.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Data&nbsp;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div class="tabs">
    <ul>
      <li><a href="files.html"><span>File&nbsp;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
</div>
<div class="contents">
<h1>lib/msg_queue.c File Reference</h1>
<p>Management of messagequeues.  
<a href="#_details">More...</a></p>
<code>#include &quot;<a class="el" href="fb_8h_source.html">fb.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="fb__hardware_8h_source.html">fb_hardware.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="fb__hal_8h_source.html">fb_hal.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="msg__queue_8h_source.html">msg_queue.h</a>&quot;</code><br/>
<div class="dynheader">
Include dependency graph for msg_queue.c:</div>
<div class="dynsection">
<div class="center"><img src="msg__queue_8c__incl.png" border="0" usemap="#lib_2msg__queue_8c_map" alt=""/></div>
<map name="lib_2msg__queue_8c_map" id="lib_2msg__queue_8c">
<area shape="rect" id="node3" href="fb_8h.html" title="Define general values used in bus communication." alt="" coords="5,83,48,112"/><area shape="rect" id="node5" href="fb__hardware_8h.html" title="Hardware specific options which includes the platforms (like ATmega8, ATmega168...." alt="" coords="181,237,283,267"/><area shape="rect" id="node7" href="fb__hal_8h.html" title="Definitions on Hardware Abstration Layer." alt="" coords="181,83,248,112"/><area shape="rect" id="node13" href="msg__queue_8h.html" title="Definitions for the message queue system used for telegrams and communucation like..." alt="" coords="331,160,429,189"/></map>
</div>
<table border="0" cellpadding="0" cellspacing="0">
<tr><td colspan="2"><h2>Defines</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="msg__queue_8c.html#a66c8b5eec73bd840535be1e13798ea1a">MSG_POOL_SIZE</a>&nbsp;&nbsp;&nbsp;18</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">the maximum number of messages which can be stored  <a href="#a66c8b5eec73bd840535be1e13798ea1a"></a><br/></td></tr>
<tr><td colspan="2"><h2>Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="structmsg.html">msg</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="msg__queue_8c.html#ad79d9162c65e803240d20adab3ea60f0">AllocMsgI</a> (void)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Allocate space for a message and return a pointer to it.  <a href="#ad79d9162c65e803240d20adab3ea60f0"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="msg__queue_8c.html#a55bd3e56fa777322e696f46ca800de15">queuemsg</a> (struct <a class="el" href="structmsg.html">msg</a> **ptr, struct <a class="el" href="structmsg.html">msg</a> *pmsg, void(*trigger)(void))</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Add a new message to the message queue.  <a href="#a55bd3e56fa777322e696f46ca800de15"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="msg__queue_8c.html#ae178f7ee7b04415bb277e140382effcb">dequeuemsg</a> (struct <a class="el" href="structmsg.html">msg</a> **ptr)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Remove a message from the queue.  <a href="#ae178f7ee7b04415bb277e140382effcb"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="msg__queue_8c.html#a1c1fa45fff8b8f09c2834e5673c01556">msg_queue_init</a> (void)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Init the message queue system and save default values.  <a href="#a1c1fa45fff8b8f09c2834e5673c01556"></a><br/></td></tr>
<tr><td colspan="2"><h2>Variables</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="structmsg.html">msg</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="msg__queue_8c.html#aad77f750019d2df78abe151e27f39562">msg_pool</a> [MSG_POOL_SIZE]</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">The message queue which will be used for all message types.  <a href="#aad77f750019d2df78abe151e27f39562"></a><br/></td></tr>
</table>
<hr/><a name="_details"></a><h2>Detailed Description</h2>
<p>Management of messagequeues. </p>
<dl class="author"><dt><b>Author:</b></dt><dd>Dirk Opfer </dd></dl>
<dl class="date"><dt><b>Date:</b></dt><dd>Mon Oct 29 20:01:34 2007 </dd></dl>
<hr/><h2>Define Documentation</h2>
<a class="anchor" id="a66c8b5eec73bd840535be1e13798ea1a"></a><!-- doxytag: member="msg_queue.c::MSG_POOL_SIZE" ref="a66c8b5eec73bd840535be1e13798ea1a" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define MSG_POOL_SIZE&nbsp;&nbsp;&nbsp;18</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>the maximum number of messages which can be stored </p>

</div>
</div>
<hr/><h2>Function Documentation</h2>
<a class="anchor" id="ad79d9162c65e803240d20adab3ea60f0"></a><!-- doxytag: member="msg_queue.c::AllocMsgI" ref="ad79d9162c65e803240d20adab3ea60f0" args="(void)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="structmsg.html">msg</a>* AllocMsgI </td>
          <td>(</td>
          <td class="paramtype">void&nbsp;</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [read]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Allocate space for a message and return a pointer to it. </p>
<p>Function will call panic(PANIC_NO_MSG) if no more space for messages is left.</p>
<dl class="return"><dt><b>Returns:</b></dt><dd>Pointer to the msg* struct </dd></dl>

<p>References <a class="el" href="msg__queue_8h_source.html#l00053">COUNT_ARRAY_ELEMENTS</a>, <a class="el" href="msg__queue_8h_source.html#l00067">msg::flags</a>, <a class="el" href="msg__queue_8h_source.html#l00069">msg::len</a>, <a class="el" href="msg__queue_8h_source.html#l00058">MSG_ALLOC</a>, <a class="el" href="msg__queue_8h_source.html#l00049">MSG_AUTOFREE</a>, <a class="el" href="msg__queue_8h_source.html#l00057">MSG_FREE</a>, <a class="el" href="msg__queue_8c_source.html#l00045">msg_pool</a>, <a class="el" href="msg__queue_8h_source.html#l00072">msg::next</a>, <a class="el" href="fb__hal_8c_source.html#l00972">panic()</a>, <a class="el" href="fb__hal_8h_source.html#l00071">PANIC_NO_MSG</a>, and <a class="el" href="msg__queue_8h_source.html#l00066">msg::state</a>.</p>

<p>Referenced by <a class="el" href="msg__queue_8h_source.html#l00110">AllocMsg()</a>, <a class="el" href="fb__prot_8c_source.html#l00319">fb_new_msg()</a>, <a class="el" href="fb__2-dimmer__app_8c_source.html#l00261">readApplication()</a>, <a class="el" href="fb__prot_8c_source.html#l00163">sendExtTelegram()</a>, <a class="el" href="fb__prot_8c_source.html#l00208">sendTelegram()</a>, <a class="el" href="fb__hal_8c_source.html#l00224">sendTestTelegram()</a>, and <a class="el" href="fb__hal_8c_source.html#l00566">timer_rec_chars()</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dynsection">
<div class="center"><img src="msg__queue_8c_ad79d9162c65e803240d20adab3ea60f0_cgraph.png" border="0" usemap="#msg__queue_8c_ad79d9162c65e803240d20adab3ea60f0_cgraph_map" alt=""></div>
<map name="msg__queue_8c_ad79d9162c65e803240d20adab3ea60f0_cgraph_map" id="msg__queue_8c_ad79d9162c65e803240d20adab3ea60f0_cgraph">
<area shape="rect" id="node3" href="fb__hal_8h.html#a29aed42c30189a510295e50c98f34afc" title="Hold application and set blink code to PORTB pin 0, our prog pin and LED." alt="" coords="133,5,187,35"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dynsection">
<div class="center"><img src="msg__queue_8c_ad79d9162c65e803240d20adab3ea60f0_icgraph.png" border="0" usemap="#msg__queue_8c_ad79d9162c65e803240d20adab3ea60f0_icgraph_map" alt=""></div>
<map name="msg__queue_8c_ad79d9162c65e803240d20adab3ea60f0_icgraph_map" id="msg__queue_8c_ad79d9162c65e803240d20adab3ea60f0_icgraph">
<area shape="rect" id="node3" href="msg__queue_8h.html#aadc5609c7a2263c8cae4ab0d8eae7c4d" title="Allocate a new message." alt="" coords="172,219,252,248"/><area shape="rect" id="node27" href="fb__prot_8c.html#a1ca66f4c62a2c7c7ff2c8ebef64465da" title="Create a new telegram and and return pointer to it." alt="" coords="160,404,264,433"/><area shape="rect" id="node43" href="fb__app_8h.html#ace6b0e9279dd6bc5c4238fd4bac237ba" title="Read status from port and return it." alt="" coords="149,531,275,560"/><area shape="rect" id="node47" href="fb__prot_8c.html#ade80ef84f4f14d25a2283b43d9c1a54f" title="Send telegram as response to signal current state of the port to other devices." alt="" coords="143,584,281,613"/><area shape="rect" id="node49" href="fb__prot_8c.html#a990a78673785da5bb024bfaf60e0984a" title="Send telegram as response to signal current state of the port to other devices." alt="" coords="155,637,269,667"/><area shape="rect" id="node59" href="fb__hal_8c.html#ab475358073d6ed6f59de0b9fd41e65ee" title="That function can be use to send a test telegramm to the bus, e.g." alt="" coords="139,703,285,732"/><area shape="rect" id="node63" href="fb__hal_8c.html#adbc1536a5853b8f6c824462a53cf4f67" title="A start bit was received in the past now read bit for bit until the end of the octet..." alt="" coords="147,781,277,811"/><area shape="rect" id="node5" href="fb__eeprom_8c.html#a68f918bbf3e9cd0ec46a706bb5c8b9d3" title="Write data to the eeprom cache and trigger background process to write eeprom cache..." alt="" coords="347,219,507,248"/><area shape="rect" id="node19" href="lib_2uart_8c.html#a8eaa1ed3292777a3ed02045bd4b612c3" title="Queue a character and start background sending to rs232." alt="" coords="383,85,471,115"/><area shape="rect" id="node7" href="fb__prot_8c.html#afae8acdc71d1ebff494c621459c097cf" title="Write recieved data to the eeprom." alt="" coords="600,272,736,301"/><area shape="rect" id="node9" href="fb__prot_8c.html#ac3b30c7591e51974ab895440929395c6" title="Set the received address as our new device address." alt="" coords="573,165,763,195"/><area shape="rect" id="node11" href="fb__relais__app_8c.html#aac9e4f65925a5a959cb5df9ed091b3b7" title="Switch the objects to state in portValue and save value to eeprom if necessary." alt="" coords="608,219,728,248"/><area shape="rect" id="node13" href="fb__relais__app_8c.html#aabc97de0ba2150af0af7d2ddb8293824" title="Function is called when microcontroller gets power or if the application must be..." alt="" coords="835,165,976,195"/><area shape="rect" id="node15" href="fb__relais__app_8c.html#a30773cfc4105728c9628fca36c8c7c20" title="Function is called if A_GroupValue_Write is received." alt="" coords="848,219,963,248"/><area shape="rect" id="node17" href="fb__relais__app_8c.html#a3cabe34d9b90083ff13af0188e622539" title="Timer1 is used as application timer." alt="" coords="817,272,993,301"/><area shape="rect" id="node21" href="lib_2uart_8c.html#a1e9aadc7cf5409fa2408900b44ee1f87" title="Queue a character and write it as a hex value to rs232." alt="" coords="627,112,709,141"/><area shape="rect" id="node23" href="lib_2uart_8c.html#a235e7f4c195d6d877cc0bb2facff043b" title="Queue a newline and write it to the rs232." alt="" coords="615,5,721,35"/><area shape="rect" id="node25" href="lib_2uart_8c.html#ae52facc0a56086a365bb0018160d8d71" title="Display string on rs232." alt="" coords="625,59,711,88"/><area shape="rect" id="node29" href="fb__prot_8c.html#a4a0be801ed4f2d9b2cbce548adf56a76" title="Read the values from the ADC converter." alt="" coords="613,468,723,497"/><area shape="rect" id="node31" href="fb__prot_8c.html#a37d55968595e78e21dc1dba21418acf4" title="Is called if information for the BCU type is requested." alt="" coords="569,325,767,355"/><area shape="rect" id="node33" href="fb__prot_8c.html#af2931210aae10a2c39698d2f1fb3c98c" title="Read data from eeprom and return send it as telegram back to the requester." alt="" coords="601,403,735,432"/><area shape="rect" id="node35" href="fb__prot_8c.html#ae42ed05d4ccf0a841bdaa32fe7af4478" title="Returns the address of the device." alt="" coords="333,377,520,407"/><area shape="rect" id="node37" href="fb__prot_8c.html#a440973c20d3055721521a359aee68536" title="Sicherungslayer." alt="" coords="385,324,468,353"/><area shape="rect" id="node45" href="fb__prot_8c.html#ae56aada1e48493023c8f3ecf7a1e71a7" title="A read request to the application." alt="" coords="349,532,504,561"/><area shape="rect" id="node51" href="fb__in8__app_8c.html#a8d1473313842fe123fec771c086af269" title="Port Function: Jalousie." alt="" coords="357,636,496,665"/><area shape="rect" id="node53" href="fb__in8__app_8c.html#a3cabe34d9b90083ff13af0188e622539" title="Timer1 is used as application timer." alt="" coords="580,636,756,665"/><area shape="rect" id="node55" href="fb__in8__app_8c.html#a71a91b98ae9a796dac4ab23c7e3ff6d8" title="Port Function: switch." alt="" coords="360,689,493,719"/><area shape="rect" id="node61" href="fb__in8__app_8c.html#a840291bc02cba5474a4cb46a9b9566fe" title="The start point of the program, init all libraries, start the bus interface, the..." alt="" coords="400,743,453,772"/><area shape="rect" id="node65" href="fb__hal_8c.html#aec43762dc86e029b395d4e5819192c2d" title="The ISR handles which function must be called." alt="" coords="405,796,448,825"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="ae178f7ee7b04415bb277e140382effcb"></a><!-- doxytag: member="msg_queue.c::dequeuemsg" ref="ae178f7ee7b04415bb277e140382effcb" args="(struct msg **ptr)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void dequeuemsg </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structmsg.html">msg</a> **&nbsp;</td>
          <td class="paramname"> <em>ptr</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Remove a message from the queue. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>ptr</em>&nbsp;</td><td>Pointer to the message which should be removed. </td></tr>
  </table>
  </dd>
</dl>

<p>References <a class="el" href="freebus-atmega16_8h_source.html#l00048">DISABLE_IRQS</a>, <a class="el" href="freebus-atmega16_8h_source.html#l00049">ENABLE_IRQS</a>, <a class="el" href="msg__queue_8h_source.html#l00067">msg::flags</a>, <a class="el" href="msg__queue_8h_source.html#l00099">FreeMsg()</a>, <a class="el" href="msg__queue_8h_source.html#l00049">MSG_AUTOFREE</a>, and <a class="el" href="msg__queue_8h_source.html#l00072">msg::next</a>.</p>

<p>Referenced by <a class="el" href="fb__eeprom_8c_source.html#l00130">ISR()</a>, <a class="el" href="fb__hal_8c_source.html#l00856">tx_complete()</a>, and <a class="el" href="fb__hal_8c_source.html#l00886">tx_error()</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dynsection">
<div class="center"><img src="msg__queue_8c_ae178f7ee7b04415bb277e140382effcb_cgraph.png" border="0" usemap="#msg__queue_8c_ae178f7ee7b04415bb277e140382effcb_cgraph_map" alt=""></div>
<map name="msg__queue_8c_ae178f7ee7b04415bb277e140382effcb_cgraph_map" id="msg__queue_8c_ae178f7ee7b04415bb277e140382effcb_cgraph">
<area shape="rect" id="node3" href="msg__queue_8h.html#afec1149f3bb049af42978cf90c775ca6" title="Free the message and mark it as MSG_FREE." alt="" coords="151,5,223,35"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dynsection">
<div class="center"><img src="msg__queue_8c_ae178f7ee7b04415bb277e140382effcb_icgraph.png" border="0" usemap="#msg__queue_8c_ae178f7ee7b04415bb277e140382effcb_icgraph_map" alt=""></div>
<map name="msg__queue_8c_ae178f7ee7b04415bb277e140382effcb_icgraph_map" id="msg__queue_8c_ae178f7ee7b04415bb277e140382effcb_icgraph">
<area shape="rect" id="node3" href="fb__eeprom_8c.html#a1830429d15e4ec8062725ab771275327" title="Interrupt handler to write queued eeprom data byte for byte to eeprom without blocking..." alt="" coords="196,5,239,35"/><area shape="rect" id="node5" href="fb__hal_8c.html#a02bd6a0eef1e1be4a306236d886f04bb" title="Postive acknowledge received, dequeue message." alt="" coords="163,59,272,88"/><area shape="rect" id="node14" href="fb__hal_8c.html#afcdb445c1b6cc3e39d904592286349ee" title="Negative acknowledge received, check repeat counter and if repeat is not expired..." alt="" coords="180,112,255,141"/><area shape="rect" id="node7" href="fb__hal_8c.html#a4f090f79722be364605b7c776db2a78a" title="Telegram received." alt="" coords="325,7,448,36"/><area shape="rect" id="node11" href="fb__hal_8c.html#af44a3cacd6e2ffabfab5a4628b796a79" title="That function is called if the timeout of 384µs tiggered." alt="" coords="327,60,447,89"/><area shape="rect" id="node9" href="fb__hal_8c.html#aec43762dc86e029b395d4e5819192c2d" title="The ISR handles which function must be called." alt="" coords="503,87,545,116"/><area shape="rect" id="node17" href="fb__hal_8c.html#a3cef2c79df784b2c7e52dde126b0e0d0" title="Telegram send completely but ack wasn&#39;t received in timerframe, set error flag..." alt="" coords="321,164,452,193"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a1c1fa45fff8b8f09c2834e5673c01556"></a><!-- doxytag: member="msg_queue.c::msg_queue_init" ref="a1c1fa45fff8b8f09c2834e5673c01556" args="(void)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void msg_queue_init </td>
          <td>(</td>
          <td class="paramtype">void&nbsp;</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Init the message queue system and save default values. </p>

<p>References <a class="el" href="msg__queue_8h_source.html#l00053">COUNT_ARRAY_ELEMENTS</a>, <a class="el" href="msg__queue_8h_source.html#l00057">MSG_FREE</a>, <a class="el" href="msg__queue_8c_source.html#l00045">msg_pool</a>, and <a class="el" href="msg__queue_8h_source.html#l00066">msg::state</a>.</p>

<p>Referenced by <a class="el" href="fb__2-dimmer__app_8c_source.html#l00563">main()</a>.</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dynsection">
<div class="center"><img src="msg__queue_8c_a1c1fa45fff8b8f09c2834e5673c01556_icgraph.png" border="0" usemap="#msg__queue_8c_a1c1fa45fff8b8f09c2834e5673c01556_icgraph_map" alt=""></div>
<map name="msg__queue_8c_a1c1fa45fff8b8f09c2834e5673c01556_icgraph_map" id="msg__queue_8c_a1c1fa45fff8b8f09c2834e5673c01556_icgraph">
<area shape="rect" id="node3" href="fb__2-dimmer__app_8c.html#a840291bc02cba5474a4cb46a9b9566fe" title="The start point of the program, init all libraries, start the bus interface, the..." alt="" coords="168,5,219,35"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a55bd3e56fa777322e696f46ca800de15"></a><!-- doxytag: member="msg_queue.c::queuemsg" ref="a55bd3e56fa777322e696f46ca800de15" args="(struct msg **ptr, struct msg *pmsg, void(*trigger)(void))" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void queuemsg </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structmsg.html">msg</a> **&nbsp;</td>
          <td class="paramname"> <em>ptr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structmsg.html">msg</a> *&nbsp;</td>
          <td class="paramname"> <em>pmsg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void(*)(void)&nbsp;</td>
          <td class="paramname"> <em>trigger</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Add a new message to the message queue. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>ptr</em>&nbsp;</td><td></td></tr>
    <tr><td valign="top"></td><td valign="top"><em>pmsg</em>&nbsp;</td><td></td></tr>
    <tr><td valign="top"></td><td valign="top"><em>trigger</em>&nbsp;</td><td></td></tr>
  </table>
  </dd>
</dl>

<p>References <a class="el" href="freebus-atmega16_8h_source.html#l00048">DISABLE_IRQS</a>, <a class="el" href="freebus-atmega16_8h_source.html#l00049">ENABLE_IRQS</a>, and <a class="el" href="msg__queue_8h_source.html#l00072">msg::next</a>.</p>

<p>Referenced by <a class="el" href="fb__eeprom_8c_source.html#l00216">eeprom_ParamWrite()</a>, <a class="el" href="fb__hal_8c_source.html#l00961">fb_hal_txqueue_msg()</a>, and <a class="el" href="lib_2uart_8c_source.html#l00199">uart_putc()</a>.</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dynsection">
<div class="center"><img src="msg__queue_8c_a55bd3e56fa777322e696f46ca800de15_icgraph.png" border="0" usemap="#msg__queue_8c_a55bd3e56fa777322e696f46ca800de15_icgraph_map" alt=""></div>
<map name="msg__queue_8c_a55bd3e56fa777322e696f46ca800de15_icgraph_map" id="msg__queue_8c_a55bd3e56fa777322e696f46ca800de15_icgraph">
<area shape="rect" id="node3" href="fb__eeprom_8c.html#a68f918bbf3e9cd0ec46a706bb5c8b9d3" title="Write data to the eeprom cache and trigger background process to write eeprom cache..." alt="" coords="136,528,277,557"/><area shape="rect" id="node17" href="fb__hal_8c.html#abbf23a2adcf8b8280c8ce17d4a12951b" title="Queue message for sending." alt="" coords="136,245,277,275"/><area shape="rect" id="node53" href="lib_2uart_8c.html#a8eaa1ed3292777a3ed02045bd4b612c3" title="Queue a character and start background sending to rs232." alt="" coords="169,661,244,691"/><area shape="rect" id="node5" href="fb__prot_8c.html#afae8acdc71d1ebff494c621459c097cf" title="Write recieved data to the eeprom." alt="" coords="575,432,697,461"/><area shape="rect" id="node7" href="fb__prot_8c.html#ac3b30c7591e51974ab895440929395c6" title="Set the received address as our new device address." alt="" coords="327,581,500,611"/><area shape="rect" id="node9" href="fb__relais__app_8c.html#aac9e4f65925a5a959cb5df9ed091b3b7" title="Switch the objects to state in portValue and save value to eeprom if necessary." alt="" coords="361,528,465,557"/><area shape="rect" id="node11" href="fb__relais__app_8c.html#aabc97de0ba2150af0af7d2ddb8293824" title="Function is called when microcontroller gets power or if the application must be..." alt="" coords="575,485,697,515"/><area shape="rect" id="node13" href="fb__relais__app_8c.html#a30773cfc4105728c9628fca36c8c7c20" title="Function is called if A_GroupValue_Write is received." alt="" coords="584,539,688,568"/><area shape="rect" id="node15" href="fb__relais__app_8c.html#a3cabe34d9b90083ff13af0188e622539" title="Timer1 is used as application timer." alt="" coords="561,592,711,621"/><area shape="rect" id="node19" href="fb__prot_8c.html#a4a0be801ed4f2d9b2cbce548adf56a76" title="Read the values from the ADC converter." alt="" coords="585,325,687,355"/><area shape="rect" id="node21" href="fb__prot_8c.html#a37d55968595e78e21dc1dba21418acf4" title="Is called if information for the BCU type is requested." alt="" coords="551,379,721,408"/><area shape="rect" id="node23" href="fb__prot_8c.html#af2931210aae10a2c39698d2f1fb3c98c" title="Read data from eeprom and return send it as telegram back to the requester." alt="" coords="575,272,697,301"/><area shape="rect" id="node25" href="fb__prot_8c.html#ae42ed05d4ccf0a841bdaa32fe7af4478" title="Returns the address of the device." alt="" coords="327,59,500,88"/><area shape="rect" id="node27" href="fb__prot_8c.html#a440973c20d3055721521a359aee68536" title="Sicherungslayer." alt="" coords="376,373,451,403"/><area shape="rect" id="node33" href="fb__app_8h.html#ace6b0e9279dd6bc5c4238fd4bac237ba" title="Read status from port and return it." alt="" coords="359,5,468,35"/><area shape="rect" id="node37" href="fb__prot_8c.html#ade80ef84f4f14d25a2283b43d9c1a54f" title="Send telegram as response to signal current state of the port to other devices." alt="" coords="352,165,475,195"/><area shape="rect" id="node39" href="fb__prot_8c.html#a990a78673785da5bb024bfaf60e0984a" title="Send telegram as response to signal current state of the port to other devices." alt="" coords="363,112,464,141"/><area shape="rect" id="node49" href="fb__hal_8c.html#ab475358073d6ed6f59de0b9fd41e65ee" title="That function can be use to send a test telegramm to the bus, e.g." alt="" coords="349,219,477,248"/><area shape="rect" id="node35" href="fb__prot_8c.html#ae56aada1e48493023c8f3ecf7a1e71a7" title="A read request to the application." alt="" coords="565,5,707,35"/><area shape="rect" id="node41" href="fb__in8__app_8c.html#a8d1473313842fe123fec771c086af269" title="Port Function: Jalousie." alt="" coords="572,112,700,141"/><area shape="rect" id="node43" href="fb__in8__app_8c.html#a3cabe34d9b90083ff13af0188e622539" title="Timer1 is used as application timer." alt="" coords="771,112,920,141"/><area shape="rect" id="node45" href="fb__in8__app_8c.html#a71a91b98ae9a796dac4ab23c7e3ff6d8" title="Port Function: switch." alt="" coords="576,165,696,195"/><area shape="rect" id="node51" href="fb__in8__app_8c.html#a840291bc02cba5474a4cb46a9b9566fe" title="The start point of the program, init all libraries, start the bus interface, the..." alt="" coords="611,219,661,248"/><area shape="rect" id="node55" href="lib_2uart_8c.html#a1e9aadc7cf5409fa2408900b44ee1f87" title="Queue a character and write it as a hex value to rs232." alt="" coords="377,635,449,664"/><area shape="rect" id="node57" href="lib_2uart_8c.html#a235e7f4c195d6d877cc0bb2facff043b" title="Queue a newline and write it to the rs232." alt="" coords="367,688,460,717"/><area shape="rect" id="node59" href="lib_2uart_8c.html#ae52facc0a56086a365bb0018160d8d71" title="Display string on rs232." alt="" coords="376,741,451,771"/></map>
</div>
</p>

</div>
</div>
<hr/><h2>Variable Documentation</h2>
<a class="anchor" id="aad77f750019d2df78abe151e27f39562"></a><!-- doxytag: member="msg_queue.c::msg_pool" ref="aad77f750019d2df78abe151e27f39562" args="[MSG_POOL_SIZE]" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="structmsg.html">msg</a> <a class="el" href="msg__queue_8c.html#aad77f750019d2df78abe151e27f39562">msg_pool</a>[MSG_POOL_SIZE]</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>The message queue which will be used for all message types. </p>

<p>Referenced by <a class="el" href="msg__queue_8c_source.html#l00061">AllocMsgI()</a>, and <a class="el" href="msg__queue_8c_source.html#l00140">msg_queue_init()</a>.</p>

</div>
</div>
</div>
<hr class="footer"/><address style="text-align: right;"><small>Generated on Wed Jun 9 17:27:04 2010 for FreeBusAVR by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.6.3 </small></address>
</body>
</html>
