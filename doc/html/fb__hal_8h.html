<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>FreeBusAVR: include/fb_hal.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- Generated by Doxygen 1.6.2 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="main.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Data&nbsp;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div class="tabs">
    <ul>
      <li><a href="files.html"><span>File&nbsp;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
</div>
<div class="contents">
<h1>include/fb_hal.h File Reference</h1>
<p>Definitions on Hardware Abstration Layer.  
<a href="#_details">More...</a></p>
<code>#include &lt;avr/io.h&gt;</code><br/>
<code>#include &lt;avr/interrupt.h&gt;</code><br/>
<code>#include &quot;<a class="el" href="msg__queue_8h_source.html">msg_queue.h</a>&quot;</code><br/>
<div class="dynheader">
Include dependency graph for fb_hal.h:</div>
<div class="dynsection">
<div class="center"><img src="fb__hal_8h__incl.png" border="0" usemap="#include_2fb__hal_8h_map" alt=""/></div>
<map name="include_2fb__hal_8h_map" id="include_2fb__hal_8h">
<area shape="rect" id="node7" href="msg__queue_8h.html" title="Definitions for the message queue system used for telegrams and communucation like..." alt="" coords="213,83,312,112"/><area shape="rect" id="node9" href="fb__hardware_8h.html" title="Hardware specific options which includes the platforms (like ATmega8, ATmega168...." alt="" coords="212,160,313,189"/></map>
</div>
<div class="dynheader">
This graph shows which files directly or indirectly include this file:</div>
<div class="dynsection">
<div class="center"><img src="fb__hal_8h__dep__incl.png" border="0" usemap="#include_2fb__hal_8hdep_map" alt=""/></div>
<map name="include_2fb__hal_8hdep_map" id="include_2fb__hal_8hdep">
<area shape="rect" id="node3" href="fb__2-dimmer__app_8c.html" title="Dimmer application based on the Gira 1032 2 channel dimmer." alt="" coords="5,83,219,112"/><area shape="rect" id="node5" href="fb__in8__app_8c.html" title="The application for 8 binary inputs Manufactorer code is 0x04 = Jung &#160;Device type..." alt="" coords="243,83,387,112"/><area shape="rect" id="node7" href="fb__relais__app_8c.html" title="The relais application to switch 8 relais Manufactorer code is 0x04 = Jung &#160;Device..." alt="" coords="411,83,576,112"/><area shape="rect" id="node9" href="fb__eeprom_8c.html" title="The eeprom is divided into two parts. The complete size of the eeprom is 256+18+24..." alt="" coords="600,83,709,112"/><area shape="rect" id="node11" href="fb__hal_8c.html" title="Freebus Hardware Layer. Implementation of a software&#45; uart + timer handling This..." alt="" coords="733,83,816,112"/><area shape="rect" id="node13" href="fb__prot_8c.html" title="Handle all requests which are EIB bases like write current address or group address..." alt="" coords="840,83,928,112"/><area shape="rect" id="node15" href="msg__queue_8c.html" title="Management of messagequeues." alt="" coords="952,83,1069,112"/></map>
</div>

<p><a href="fb__hal_8h_source.html">Go to the source code of this file.</a></p>
<table border="0" cellpadding="0" cellspacing="0">
<tr><td colspan="2"><h2>Defines</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="fb__hal_8h.html#aa163a3608cbfcbcd50b1bd619cfd4508">HAL_EXT</a>&nbsp;&nbsp;&nbsp;extern</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Set HAL_EXT to extern to make clear it is include from an external source like a lib.  <a href="#aa163a3608cbfcbcd50b1bd619cfd4508"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="fb__hal_8h.html#a529d90c5411df26d904a2fa1ea75f088">FB_FRAME_ERR</a>&nbsp;&nbsp;&nbsp;(1 &lt;&lt; 7)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Error error, e.g. stop bit is missing.  <a href="#a529d90c5411df26d904a2fa1ea75f088"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="fb__hal_8h.html#ac16eee46dc37a0c4c35b6e3e40fa5637">FB_PARITY_ERR</a>&nbsp;&nbsp;&nbsp;(1 &lt;&lt; 6)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Parity error in octet.  <a href="#ac16eee46dc37a0c4c35b6e3e40fa5637"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="fb__hal_8h.html#aa8e43e2058f1516200f5d701fb071ca8">FB_COLLISION</a>&nbsp;&nbsp;&nbsp;(1 &lt;&lt; 5)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Collision detected.  <a href="#aa8e43e2058f1516200f5d701fb071ca8"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="fb__hal_8h.html#af2d482f2d953338c0597858a0f7571b7">FB_CHAR_REC</a>&nbsp;&nbsp;&nbsp;(1 &lt;&lt; 3)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">In character receive mode.  <a href="#af2d482f2d953338c0597858a0f7571b7"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="fb__hal_8h.html#ab26a4ae4e4ada896a31f54f982289c32">FB_BUS_FREE</a>&nbsp;&nbsp;&nbsp;(1 &lt;&lt; 2)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">EIB bus is free and messages can be send.  <a href="#ab26a4ae4e4ada896a31f54f982289c32"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="fb__hal_8h.html#a7bc94fd4a0297fc0e5901119a1221705">FB_ACK_REC</a>&nbsp;&nbsp;&nbsp;(1 &lt;&lt; 1)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">In acknowledge receive mode.  <a href="#a7bc94fd4a0297fc0e5901119a1221705"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="fb__hal_8h.html#af3040cb5e83cff0109eeaa7317ba2d45">FB_MESSAGE</a>&nbsp;&nbsp;&nbsp;(1 &lt;&lt; 0)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Message type is a EIB message.  <a href="#af3040cb5e83cff0109eeaa7317ba2d45"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="fb__hal_8h.html#a29e413f6725b2ba32d165ffaa35b01e5">OFF</a>&nbsp;&nbsp;&nbsp;0U</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Global Define: OFF = 0.  <a href="#a29e413f6725b2ba32d165ffaa35b01e5"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="fb__hal_8h.html#ad76d1750a6cdeebd506bfcd6752554d2">ON</a>&nbsp;&nbsp;&nbsp;1U</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Global Define: ON = 1.  <a href="#ad76d1750a6cdeebd506bfcd6752554d2"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="fb__hal_8h.html#a3c1a27aacf1dd33edffa2422da638d0f">IO_INPUT</a>&nbsp;&nbsp;&nbsp;0U</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Portpin-Direction is Input.  <a href="#a3c1a27aacf1dd33edffa2422da638d0f"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="fb__hal_8h.html#aae48313230e7f773bf495ada1171c506">IO_OUTPUT</a>&nbsp;&nbsp;&nbsp;1U</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Portpin-Direction is Output.  <a href="#aae48313230e7f773bf495ada1171c506"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="fb__hal_8h.html#a3a73bcf1a2e852ef3035725ff088a9e1">PANIC_MEMORY</a>&nbsp;&nbsp;&nbsp;0x01</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Memory error, is set when no memory is left and it is tried to allocate memory.  <a href="#a3a73bcf1a2e852ef3035725ff088a9e1"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="fb__hal_8h.html#aecc96d1e182add83fb6cda0b2319d418">PANIC_RESOURCE</a>&nbsp;&nbsp;&nbsp;0x02</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">No more resources are available.  <a href="#aecc96d1e182add83fb6cda0b2319d418"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="fb__hal_8h.html#ac954f3924dbc5e5bff23d4be72aa9b67">PANIC_EEPROM</a>&nbsp;&nbsp;&nbsp;0x03</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Error in eeprom.  <a href="#ac954f3924dbc5e5bff23d4be72aa9b67"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="fb__hal_8h.html#a0e1835b0358e59cc10ca44e68c4ad1d4">PANIC_NO_MSG</a>&nbsp;&nbsp;&nbsp;0x04</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">No more space for messages is left in allocated message queue.  <a href="#a0e1835b0358e59cc10ca44e68c4ad1d4"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="fb__hal_8h.html#a46388d9db8422abfea56ae2323f7a77c">_NOP</a>()&nbsp;&nbsp;&nbsp;do { __asm__ __volatile__ (&quot;nop&quot;); } while (0)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">define _NOP which calls assembler routine nop.  <a href="#a46388d9db8422abfea56ae2323f7a77c"></a><br/></td></tr>
<tr><td colspan="2"><h2>Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">HAL_EXT uint8_t&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="fb__hal_8h.html#afa7a39eafe5190b954bac9e77ea52e2d">fbhal_checkProgTaster</a> (void)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Check the programm button and set programming mode and switch LED depending on programming mode.  <a href="#afa7a39eafe5190b954bac9e77ea52e2d"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">HAL_EXT void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="fb__hal_8h.html#a89a6ed807cf111efb29a00f42e35cc3a">fbhal_Init</a> (void)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Set input/output mode to PORTs, init timers and interrupts.  <a href="#a89a6ed807cf111efb29a00f42e35cc3a"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">HAL_EXT void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="fb__hal_8h.html#a3e4f31f4b97d833e7ef5fb9615def386">fb_send_ack</a> (uint8_t value)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Function to set the ack value for the response to a telegram which must be send in a absolutly excat timing.  <a href="#a3e4f31f4b97d833e7ef5fb9615def386"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">HAL_EXT void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="fb__hal_8h.html#a4111a79334fb10bc9c786f510256c20b">fb_hal_restart</a> (void)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Restart the application by activating the watchdog and block the program.  <a href="#a4111a79334fb10bc9c786f510256c20b"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">HAL_EXT uint8_t&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="fb__hal_8h.html#af70a4606fe5ce0777a371e0c6c3540fb">fb_hal_txqueue_msg</a> (struct <a class="el" href="structmsg.html">msg</a> *tx)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Queue message for sending.  <a href="#af70a4606fe5ce0777a371e0c6c3540fb"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">HAL_EXT void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="fb__hal_8h.html#a4b15ee32b7b560554e0f6d6945dde9d4">sendTestTelegram</a> (void)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">That function can be use to send a test telegramm to the bus, e.g.  <a href="#a4b15ee32b7b560554e0f6d6945dde9d4"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">HAL_EXT void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="fb__hal_8h.html#a29aed42c30189a510295e50c98f34afc">panic</a> (uint8_t reason)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Hold application and set blink code to PORTB pin 0, our prog pin and LED.  <a href="#a29aed42c30189a510295e50c98f34afc"></a><br/></td></tr>
<tr><td colspan="2"><h2>Variables</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">HAL_EXT uint8_t&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="fb__hal_8h.html#a53ac9c8b9cfb94746b9f5b39bf152620">systemState</a></td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Holds the system state.  <a href="#a53ac9c8b9cfb94746b9f5b39bf152620"></a><br/></td></tr>
</table>
<hr/><a name="_details"></a><h2>Detailed Description</h2>
<p>Definitions on Hardware Abstration Layer. </p>
<dl class="author"><dt><b>Author:</b></dt><dd>Dirk Opfer, Matthias Fechner, Christian Bode </dd></dl>
<dl class="date"><dt><b>Date:</b></dt><dd>Tue Jan 08 11:19:00 2008 </dd></dl>
<hr/><h2>Define Documentation</h2>
<a class="anchor" id="a46388d9db8422abfea56ae2323f7a77c"></a><!-- doxytag: member="fb_hal.h::_NOP" ref="a46388d9db8422abfea56ae2323f7a77c" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define _NOP</td>
          <td>(</td>
&nbsp;</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td>&nbsp;&nbsp;&nbsp;do { __asm__ __volatile__ (&quot;nop&quot;); } while (0)</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>define _NOP which calls assembler routine nop. </p>
<p>Can be used to wait some time and/or to prevent compiler from removing code in optimization (empty loops to wait etc.) </p>

<p>Referenced by <a class="el" href="fb__2-dimmer__app_8c_source.html#l00563">main()</a>.</p>

</div>
</div>
<a class="anchor" id="a7bc94fd4a0297fc0e5901119a1221705"></a><!-- doxytag: member="fb_hal.h::FB_ACK_REC" ref="a7bc94fd4a0297fc0e5901119a1221705" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define FB_ACK_REC&nbsp;&nbsp;&nbsp;(1 &lt;&lt; 1)</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>In acknowledge receive mode. </p>

</div>
</div>
<a class="anchor" id="ab26a4ae4e4ada896a31f54f982289c32"></a><!-- doxytag: member="fb_hal.h::FB_BUS_FREE" ref="ab26a4ae4e4ada896a31f54f982289c32" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define FB_BUS_FREE&nbsp;&nbsp;&nbsp;(1 &lt;&lt; 2)</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>EIB bus is free and messages can be send. </p>

<p>Referenced by <a class="el" href="fb__hal_8c_source.html#l01010">fbhal_Init()</a>, <a class="el" href="fb__hal_8c_source.html#l00375">ISR()</a>, <a class="el" href="fb__hal_8c_source.html#l00937">retrigger_tx()</a>, <a class="el" href="fb__hal_8c_source.html#l00224">sendTestTelegram()</a>, and <a class="el" href="fb__hal_8c_source.html#l00740">timer_bus_free()</a>.</p>

</div>
</div>
<a class="anchor" id="af2d482f2d953338c0597858a0f7571b7"></a><!-- doxytag: member="fb_hal.h::FB_CHAR_REC" ref="af2d482f2d953338c0597858a0f7571b7" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define FB_CHAR_REC&nbsp;&nbsp;&nbsp;(1 &lt;&lt; 3)</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>In character receive mode. </p>

</div>
</div>
<a class="anchor" id="aa8e43e2058f1516200f5d701fb071ca8"></a><!-- doxytag: member="fb_hal.h::FB_COLLISION" ref="aa8e43e2058f1516200f5d701fb071ca8" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define FB_COLLISION&nbsp;&nbsp;&nbsp;(1 &lt;&lt; 5)</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Collision detected. </p>

<p>Referenced by <a class="el" href="fb__hal_8c_source.html#l00535">checkForCollisions()</a>, and <a class="el" href="fb__hal_8c_source.html#l00893">tx_error()</a>.</p>

</div>
</div>
<a class="anchor" id="a529d90c5411df26d904a2fa1ea75f088"></a><!-- doxytag: member="fb_hal.h::FB_FRAME_ERR" ref="a529d90c5411df26d904a2fa1ea75f088" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define FB_FRAME_ERR&nbsp;&nbsp;&nbsp;(1 &lt;&lt; 7)</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Error error, e.g. stop bit is missing. </p>

<p>Referenced by <a class="el" href="fb__hal_8c_source.html#l00572">timer_rec_chars()</a>, and <a class="el" href="fb__hal_8c_source.html#l00636">timer_timeout()</a>.</p>

</div>
</div>
<a class="anchor" id="af3040cb5e83cff0109eeaa7317ba2d45"></a><!-- doxytag: member="fb_hal.h::FB_MESSAGE" ref="af3040cb5e83cff0109eeaa7317ba2d45" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define FB_MESSAGE&nbsp;&nbsp;&nbsp;(1 &lt;&lt; 0)</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Message type is a EIB message. </p>

<p>Referenced by <a class="el" href="fb__hal_8c_source.html#l00636">timer_timeout()</a>.</p>

</div>
</div>
<a class="anchor" id="ac16eee46dc37a0c4c35b6e3e40fa5637"></a><!-- doxytag: member="fb_hal.h::FB_PARITY_ERR" ref="ac16eee46dc37a0c4c35b6e3e40fa5637" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define FB_PARITY_ERR&nbsp;&nbsp;&nbsp;(1 &lt;&lt; 6)</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Parity error in octet. </p>

<p>Referenced by <a class="el" href="fb__hal_8c_source.html#l00572">timer_rec_chars()</a>, and <a class="el" href="fb__hal_8c_source.html#l00636">timer_timeout()</a>.</p>

</div>
</div>
<a class="anchor" id="aa163a3608cbfcbcd50b1bd619cfd4508"></a><!-- doxytag: member="fb_hal.h::HAL_EXT" ref="aa163a3608cbfcbcd50b1bd619cfd4508" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define HAL_EXT&nbsp;&nbsp;&nbsp;extern</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Set HAL_EXT to extern to make clear it is include from an external source like a lib. </p>

</div>
</div>
<a class="anchor" id="a3c1a27aacf1dd33edffa2422da638d0f"></a><!-- doxytag: member="fb_hal.h::IO_INPUT" ref="a3c1a27aacf1dd33edffa2422da638d0f" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define IO_INPUT&nbsp;&nbsp;&nbsp;0U</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Portpin-Direction is Input. </p>

<p>Referenced by <a class="el" href="fb__hal_8c_source.html#l01010">fbhal_Init()</a>, and <a class="el" href="fb__in8__app_8c_source.html#l00330">restartApplication()</a>.</p>

</div>
</div>
<a class="anchor" id="aae48313230e7f773bf495ada1171c506"></a><!-- doxytag: member="fb_hal.h::IO_OUTPUT" ref="aae48313230e7f773bf495ada1171c506" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define IO_OUTPUT&nbsp;&nbsp;&nbsp;1U</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Portpin-Direction is Output. </p>

<p>Referenced by <a class="el" href="fb__hal_8c_source.html#l01010">fbhal_Init()</a>, <a class="el" href="fb__hal_8c_source.html#l00979">panic()</a>, and <a class="el" href="fb__in8__app_8c_source.html#l00330">restartApplication()</a>.</p>

</div>
</div>
<a class="anchor" id="a29e413f6725b2ba32d165ffaa35b01e5"></a><!-- doxytag: member="fb_hal.h::OFF" ref="a29e413f6725b2ba32d165ffaa35b01e5" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define OFF&nbsp;&nbsp;&nbsp;0U</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Global Define: OFF = 0. </p>

<p>Referenced by <a class="el" href="fb__hal_8c_source.html#l00535">checkForCollisions()</a>, <a class="el" href="fb__hal_8c_source.html#l01010">fbhal_Init()</a>, and <a class="el" href="fb__hal_8c_source.html#l00979">panic()</a>.</p>

</div>
</div>
<a class="anchor" id="ad76d1750a6cdeebd506bfcd6752554d2"></a><!-- doxytag: member="fb_hal.h::ON" ref="ad76d1750a6cdeebd506bfcd6752554d2" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define ON&nbsp;&nbsp;&nbsp;1U</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Global Define: ON = 1. </p>

<p>Referenced by <a class="el" href="fb__hal_8c_source.html#l00422">ISR()</a>, and <a class="el" href="fb__hal_8c_source.html#l00979">panic()</a>.</p>

</div>
</div>
<a class="anchor" id="ac954f3924dbc5e5bff23d4be72aa9b67"></a><!-- doxytag: member="fb_hal.h::PANIC_EEPROM" ref="ac954f3924dbc5e5bff23d4be72aa9b67" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define PANIC_EEPROM&nbsp;&nbsp;&nbsp;0x03</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Error in eeprom. </p>

</div>
</div>
<a class="anchor" id="a3a73bcf1a2e852ef3035725ff088a9e1"></a><!-- doxytag: member="fb_hal.h::PANIC_MEMORY" ref="a3a73bcf1a2e852ef3035725ff088a9e1" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define PANIC_MEMORY&nbsp;&nbsp;&nbsp;0x01</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Memory error, is set when no memory is left and it is tried to allocate memory. </p>

</div>
</div>
<a class="anchor" id="a0e1835b0358e59cc10ca44e68c4ad1d4"></a><!-- doxytag: member="fb_hal.h::PANIC_NO_MSG" ref="a0e1835b0358e59cc10ca44e68c4ad1d4" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define PANIC_NO_MSG&nbsp;&nbsp;&nbsp;0x04</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>No more space for messages is left in allocated message queue. </p>

<p>Referenced by <a class="el" href="msg__queue_8c_source.html#l00061">AllocMsgI()</a>.</p>

</div>
</div>
<a class="anchor" id="aecc96d1e182add83fb6cda0b2319d418"></a><!-- doxytag: member="fb_hal.h::PANIC_RESOURCE" ref="aecc96d1e182add83fb6cda0b2319d418" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define PANIC_RESOURCE&nbsp;&nbsp;&nbsp;0x02</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>No more resources are available. </p>

</div>
</div>
<hr/><h2>Function Documentation</h2>
<a class="anchor" id="a4111a79334fb10bc9c786f510256c20b"></a><!-- doxytag: member="fb_hal.h::fb_hal_restart" ref="a4111a79334fb10bc9c786f510256c20b" args="(void)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">HAL_EXT void fb_hal_restart </td>
          <td>(</td>
          <td class="paramtype">void&nbsp;</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Restart the application by activating the watchdog and block the program. </p>

<p>References <a class="el" href="freebus-atmega16_8h_source.html#l00130">ENABLE_WATCHDOG</a>.</p>

<p>Referenced by <a class="el" href="fb__prot_8c_source.html#l00637">A_Restart()</a>.</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dynsection">
<div class="center"><img src="fb__hal_8h_a4111a79334fb10bc9c786f510256c20b_icgraph.png" border="0" usemap="#fb__hal_8h_a4111a79334fb10bc9c786f510256c20b_icgraph_map" alt=""></div>
<map name="fb__hal_8h_a4111a79334fb10bc9c786f510256c20b_icgraph_map" id="fb__hal_8h_a4111a79334fb10bc9c786f510256c20b_icgraph">
<area shape="rect" id="node3" href="fb__prot_8c.html#a088341f3603f5de9eb4817a8199391c6" title="Restart the program on the microcontroller." alt="" coords="155,5,235,35"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="af70a4606fe5ce0777a371e0c6c3540fb"></a><!-- doxytag: member="fb_hal.h::fb_hal_txqueue_msg" ref="af70a4606fe5ce0777a371e0c6c3540fb" args="(struct msg *tx)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">HAL_EXT uint8_t fb_hal_txqueue_msg </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structmsg.html">msg</a> *&nbsp;</td>
          <td class="paramname"> <em>tx</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Queue message for sending. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>tx</em>&nbsp;</td><td>Pointer to message</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd></dd></dl>

<p>References <a class="el" href="msg__queue_8c_source.html#l00085">queuemsg()</a>, and <a class="el" href="fb__hal_8c_source.html#l00937">retrigger_tx()</a>.</p>

<p>Referenced by <a class="el" href="fb__prot_8c_source.html#l00594">A_ADC_Read()</a>, <a class="el" href="fb__prot_8c_source.html#l00486">A_DeviceDescriptor_Read()</a>, <a class="el" href="fb__prot_8c_source.html#l00517">A_Memory_Read()</a>, <a class="el" href="fb__prot_8c_source.html#l00386">A_PhysicalAddress_Read()</a>, <a class="el" href="fb__prot_8c_source.html#l00459">ncd_resp()</a>, <a class="el" href="fb__2-dimmer__app_8c_source.html#l00261">readApplication()</a>, <a class="el" href="fb__prot_8c_source.html#l00163">sendExtTelegram()</a>, <a class="el" href="fb__prot_8c_source.html#l00208">sendTelegram()</a>, and <a class="el" href="fb__hal_8c_source.html#l00224">sendTestTelegram()</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dynsection">
<div class="center"><img src="fb__hal_8h_af70a4606fe5ce0777a371e0c6c3540fb_cgraph.png" border="0" usemap="#fb__hal_8h_af70a4606fe5ce0777a371e0c6c3540fb_cgraph_map" alt=""></div>
<map name="fb__hal_8h_af70a4606fe5ce0777a371e0c6c3540fb_cgraph_map" id="fb__hal_8h_af70a4606fe5ce0777a371e0c6c3540fb_cgraph">
<area shape="rect" id="node3" href="msg__queue_8h.html#af35d846267d1aaaf1df04c8bff03047e" title="Add a new message to the message queue." alt="" coords="197,5,280,35"/><area shape="rect" id="node5" href="fb__hal_8c.html#abc433410f75bf996dab8e7fa672205c0" title="Function is called from message queue system to trigger the interrupt for transmitting..." alt="" coords="196,59,281,88"/><area shape="rect" id="node7" href="fb__hal_8c.html#a8155185b5b41794d6ead2aba9870b9fa" title="Generate the telegram checksum and copy the next octet to send to fb_frame." alt="" coords="332,59,431,88"/><area shape="rect" id="node9" href="fb__hal_8c.html#a5a622f74cb37183309cbf6a3678fb129" title="Generate an EIB frame and calculate the checksum." alt="" coords="499,32,563,61"/><area shape="rect" id="node11" href="fb__hal_8c.html#aa4a5a78d404751d2731d41c606c430fc" title="Set the next state in sending mode." alt="" coords="480,85,581,115"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dynsection">
<div class="center"><img src="fb__hal_8h_af70a4606fe5ce0777a371e0c6c3540fb_icgraph.png" border="0" usemap="#fb__hal_8h_af70a4606fe5ce0777a371e0c6c3540fb_icgraph_map" alt=""></div>
<map name="fb__hal_8h_af70a4606fe5ce0777a371e0c6c3540fb_icgraph_map" id="fb__hal_8h_af70a4606fe5ce0777a371e0c6c3540fb_icgraph">
<area shape="rect" id="node3" href="fb__prot_8c.html#a4a0be801ed4f2d9b2cbce548adf56a76" title="Read the values from the ADC converter." alt="" coords="452,5,553,35"/><area shape="rect" id="node5" href="fb__prot_8c.html#a37d55968595e78e21dc1dba21418acf4" title="Is called if information for the BCU type is requested." alt="" coords="417,59,588,88"/><area shape="rect" id="node7" href="fb__prot_8c.html#af2931210aae10a2c39698d2f1fb3c98c" title="Read data from eeprom and return send it as telegram back to the requester." alt="" coords="441,165,564,195"/><area shape="rect" id="node9" href="fb__prot_8c.html#ae42ed05d4ccf0a841bdaa32fe7af4478" title="Returns the address of the device." alt="" coords="195,215,368,244"/><area shape="rect" id="node11" href="fb__prot_8c.html#a440973c20d3055721521a359aee68536" title="Sicherungslayer." alt="" coords="244,111,319,140"/><area shape="rect" id="node18" href="fb__app_8h.html#ace6b0e9279dd6bc5c4238fd4bac237ba" title="Read status from port and return it." alt="" coords="227,268,336,297"/><area shape="rect" id="node22" href="fb__prot_8c.html#ade80ef84f4f14d25a2283b43d9c1a54f" title="Send telegram as response to signal current state of the port to other devices." alt="" coords="220,321,343,351"/><area shape="rect" id="node24" href="fb__prot_8c.html#a990a78673785da5bb024bfaf60e0984a" title="Send telegram as response to signal current state of the port to other devices." alt="" coords="231,375,332,404"/><area shape="rect" id="node34" href="fb__hal_8c.html#ab475358073d6ed6f59de0b9fd41e65ee" title="That function can be use to send a test telegramm to the bus, e.g." alt="" coords="217,453,345,483"/><area shape="rect" id="node16" href="fb__prot_8c.html#afae8acdc71d1ebff494c621459c097cf" title="Write recieved data to the eeprom." alt="" coords="441,112,564,141"/><area shape="rect" id="node20" href="fb__prot_8c.html#ae56aada1e48493023c8f3ecf7a1e71a7" title="A read request to the application." alt="" coords="432,268,573,297"/><area shape="rect" id="node26" href="fb__in8__app_8c.html#a8d1473313842fe123fec771c086af269" title="Port Function: Jalousie." alt="" coords="439,373,567,403"/><area shape="rect" id="node28" href="fb__in8__app_8c.html#a3cabe34d9b90083ff13af0188e622539" title="Timer1 is used as application timer." alt="" coords="637,373,787,403"/><area shape="rect" id="node30" href="fb__in8__app_8c.html#a71a91b98ae9a796dac4ab23c7e3ff6d8" title="Port Function: switch." alt="" coords="443,427,563,456"/><area shape="rect" id="node36" href="fb__in8__app_8c.html#a840291bc02cba5474a4cb46a9b9566fe" title="The start point of the program, init all libraries, start the bus interface, the..." alt="" coords="477,480,528,509"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a3e4f31f4b97d833e7ef5fb9615def386"></a><!-- doxytag: member="fb_hal.h::fb_send_ack" ref="a3e4f31f4b97d833e7ef5fb9615def386" args="(uint8_t value)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">HAL_EXT void fb_send_ack </td>
          <td>(</td>
          <td class="paramtype">uint8_t&nbsp;</td>
          <td class="paramname"> <em>value</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Function to set the ack value for the response to a telegram which must be send in a absolutly excat timing. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>value</em>&nbsp;</td><td>Ackvalue can be FB_ACK, FB_NACK, FB_BUSY and FB_NONE </td></tr>
  </table>
  </dd>
</dl>

<p>References <a class="el" href="freebus-debug_8h_source.html#l00057">DEBUG_PUTS</a>, <a class="el" href="fb_8h_source.html#l00031">FB_ACK</a>, and <a class="el" href="fb__hal_8c_source.html#l00145">fb_ackvalue</a>.</p>

<p>Referenced by <a class="el" href="fb__prot_8c_source.html#l00594">A_ADC_Read()</a>, <a class="el" href="fb__prot_8c_source.html#l00486">A_DeviceDescriptor_Read()</a>, <a class="el" href="fb__prot_8c_source.html#l00669">A_GroupValue_Read()</a>, <a class="el" href="fb__prot_8c_source.html#l00698">A_GroupValue_Write()</a>, <a class="el" href="fb__prot_8c_source.html#l00517">A_Memory_Read()</a>, <a class="el" href="fb__prot_8c_source.html#l00566">A_Memory_Write()</a>, <a class="el" href="fb__prot_8c_source.html#l00386">A_PhysicalAddress_Read()</a>, <a class="el" href="fb__prot_8c_source.html#l00358">A_PhysicalAddress_Write()</a>, <a class="el" href="fb__prot_8c_source.html#l00655">Ignore()</a>, <a class="el" href="fb__prot_8c_source.html#l00416">T_Connect_Req()</a>, <a class="el" href="fb__prot_8c_source.html#l00439">T_Disconnect_Req()</a>, and <a class="el" href="fb__hal_8c_source.html#l00636">timer_timeout()</a>.</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dynsection">
<div class="center"><img src="fb__hal_8h_a3e4f31f4b97d833e7ef5fb9615def386_icgraph.png" border="0" usemap="#fb__hal_8h_a3e4f31f4b97d833e7ef5fb9615def386_icgraph_map" alt=""></div>
<map name="fb__hal_8h_a3e4f31f4b97d833e7ef5fb9615def386_icgraph_map" id="fb__hal_8h_a3e4f31f4b97d833e7ef5fb9615def386_icgraph">
<area shape="rect" id="node3" href="fb__prot_8c.html#a4a0be801ed4f2d9b2cbce548adf56a76" title="Read the values from the ADC converter." alt="" coords="203,5,312,35"/><area shape="rect" id="node5" href="fb__prot_8c.html#a37d55968595e78e21dc1dba21418acf4" title="Is called if information for the BCU type is requested." alt="" coords="159,59,356,88"/><area shape="rect" id="node7" href="fb__prot_8c.html#ae56aada1e48493023c8f3ecf7a1e71a7" title="A read request to the application." alt="" coords="180,112,335,141"/><area shape="rect" id="node9" href="fb__prot_8c.html#abb5d4fc672e3e3e123f5f3e6e9f901e3" title="Is called if a broadcast is received with a matching group address (eg." alt="" coords="179,165,336,195"/><area shape="rect" id="node11" href="fb__prot_8c.html#af2931210aae10a2c39698d2f1fb3c98c" title="Read data from eeprom and return send it as telegram back to the requester." alt="" coords="191,219,324,248"/><area shape="rect" id="node13" href="fb__prot_8c.html#afae8acdc71d1ebff494c621459c097cf" title="Write recieved data to the eeprom." alt="" coords="189,272,325,301"/><area shape="rect" id="node15" href="fb__prot_8c.html#ae42ed05d4ccf0a841bdaa32fe7af4478" title="Returns the address of the device." alt="" coords="164,325,351,355"/><area shape="rect" id="node17" href="fb__prot_8c.html#ac3b30c7591e51974ab895440929395c6" title="Set the received address as our new device address." alt="" coords="163,379,352,408"/><area shape="rect" id="node19" href="fb__prot_8c.html#a5928e9483083ad86d6c82f0b0ca533af" title="Send aknowledge to certain message." alt="" coords="225,432,289,461"/><area shape="rect" id="node21" href="fb__prot_8c.html#a3b317425f1358ea37c8fca124e29c277" title="Called to start a connection to a physical address." alt="" coords="193,485,321,515"/><area shape="rect" id="node23" href="fb__prot_8c.html#a0675ad49aa389619806157f585c466ee" title="Release the transport connection." alt="" coords="184,539,331,568"/><area shape="rect" id="node25" href="fb__hal_8c.html#af44a3cacd6e2ffabfab5a4628b796a79" title="That function is called if the timeout of 384µs tiggered." alt="" coords="197,592,317,621"/><area shape="rect" id="node27" href="fb__hal_8c.html#aec43762dc86e029b395d4e5819192c2d" title="The ISR handles which function must be called." alt="" coords="407,592,449,621"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="afa7a39eafe5190b954bac9e77ea52e2d"></a><!-- doxytag: member="fb_hal.h::fbhal_checkProgTaster" ref="afa7a39eafe5190b954bac9e77ea52e2d" args="(void)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">HAL_EXT uint8_t fbhal_checkProgTaster </td>
          <td>(</td>
          <td class="paramtype">void&nbsp;</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Check the programm button and set programming mode and switch LED depending on programming mode. </p>
<p>Programm button is on PB0 and pin 4 on Freebus connector.</p>
<p>Function detects the state of the prog button (debounced) and sets the programming mode. This is done only every 16th call, because the µC needs some time to switch from output to input mode and so we got more negative duty cylce for the prog led.</p>
<dl class="bug"><dt><b><a class="el" href="bug.html#_bug000002">Bug:</a></b></dt><dd>The macro SET_IO_PROG(IO_OUTPUT) could not be used here, because this sets the DDR and also the PORT = 0. This won't work. </dd></dl>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000092">Todo:</a></b></dt><dd>Check if this function is working fine. </dd></dl>
<dl class="author"><dt><b>Author:</b></dt><dd>Matthias Fechner, Tobias Buss </dd></dl>

<p>References <a class="el" href="freebus-debug_8h_source.html#l00057">DEBUG_PUTS</a>, <a class="el" href="delay_8h_source.html#l00048">delay</a>, <a class="el" href="freebus-atmega16_8h_source.html#l00185">PROG_DDR</a>, <a class="el" href="freebus-atmega16_8h_source.html#l00187">PROG_PIN</a>, <a class="el" href="freebus-atmega16_8h_source.html#l00184">PROG_PORT</a>, <a class="el" href="fb_8h_source.html#l00041">SS_PROG</a>, and <a class="el" href="fb__hal_8h_source.html#l00083">systemState</a>.</p>

<p>Referenced by <a class="el" href="fb__in8__app_8c_source.html#l00870">main()</a>.</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dynsection">
<div class="center"><img src="fb__hal_8h_afa7a39eafe5190b954bac9e77ea52e2d_icgraph.png" border="0" usemap="#fb__hal_8h_afa7a39eafe5190b954bac9e77ea52e2d_icgraph_map" alt=""></div>
<map name="fb__hal_8h_afa7a39eafe5190b954bac9e77ea52e2d_icgraph_map" id="fb__hal_8h_afa7a39eafe5190b954bac9e77ea52e2d_icgraph">
<area shape="rect" id="node3" href="fb__in8__app_8c.html#a840291bc02cba5474a4cb46a9b9566fe" title="The start point of the program, init all libraries, start the bus interface, the..." alt="" coords="208,5,259,35"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a89a6ed807cf111efb29a00f42e35cc3a"></a><!-- doxytag: member="fb_hal.h::fbhal_Init" ref="a89a6ed807cf111efb29a00f42e35cc3a" args="(void)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">HAL_EXT void fbhal_Init </td>
          <td>(</td>
          <td class="paramtype">void&nbsp;</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Set input/output mode to PORTs, init timers and interrupts. </p>

<p><dl class="todo"><dt><b><a class="el" href="todo.html#_todo000105">Todo:</a></b></dt><dd>Timer und Interrupt-Register konfigurieren </dd></dl>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000106">Todo:</a></b></dt><dd>define a macro for following instructions in freebus-atmegaxxx.h </dd></dl>
</p>

<p>References <a class="el" href="freebus-atmega16_8h_source.html#l00052">CONFIGURE_INT0</a>, <a class="el" href="fb__hal_8c_source.html#l00093">EIB_BIT_TIME</a>, <a class="el" href="fb__hal_8c_source.html#l00097">EIB_NONE_MODE</a>, <a class="el" href="fb__hal_8c_source.html#l00094">EIB_TX_LOWTIME</a>, <a class="el" href="fb__hal_8h_source.html#l00053">FB_BUS_FREE</a>, <a class="el" href="fb__hal_8c_source.html#l00140">fb_frame</a>, <a class="el" href="fb__hal_8c_source.html#l00142">fbstat</a>, <a class="el" href="fb__hal_8h_source.html#l00064">IO_INPUT</a>, <a class="el" href="fb__hal_8h_source.html#l00065">IO_OUTPUT</a>, <a class="el" href="fb__hal_8c_source.html#l00190">next_rx_state()</a>, <a class="el" href="fb__hal_8h_source.html#l00061">OFF</a>, <a class="el" href="fb__hal_8c_source.html#l00148">operationMode</a>, <a class="el" href="fb__hal_8c_source.html#l00141">rxframe</a>, <a class="el" href="fb__hal_8h_source.html#l00083">systemState</a>, and <a class="el" href="fb__hal_8c_source.html#l00117">TS_WAITING_CHARS</a>.</p>

<p>Referenced by <a class="el" href="fb__in8__app_8c_source.html#l00870">main()</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dynsection">
<div class="center"><img src="fb__hal_8h_a89a6ed807cf111efb29a00f42e35cc3a_cgraph.png" border="0" usemap="#fb__hal_8h_a89a6ed807cf111efb29a00f42e35cc3a_cgraph_map" alt=""></div>
<map name="fb__hal_8h_a89a6ed807cf111efb29a00f42e35cc3a_cgraph_map" id="fb__hal_8h_a89a6ed807cf111efb29a00f42e35cc3a_cgraph">
<area shape="rect" id="node3" href="fb__hal_8c.html#abe9ce1ff59cb1eb49f7e651549139764" title="Set the next state while in receiving mode." alt="" coords="128,5,229,35"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dynsection">
<div class="center"><img src="fb__hal_8h_a89a6ed807cf111efb29a00f42e35cc3a_icgraph.png" border="0" usemap="#fb__hal_8h_a89a6ed807cf111efb29a00f42e35cc3a_icgraph_map" alt=""></div>
<map name="fb__hal_8h_a89a6ed807cf111efb29a00f42e35cc3a_icgraph_map" id="fb__hal_8h_a89a6ed807cf111efb29a00f42e35cc3a_icgraph">
<area shape="rect" id="node3" href="fb__in8__app_8c.html#a840291bc02cba5474a4cb46a9b9566fe" title="The start point of the program, init all libraries, start the bus interface, the..." alt="" coords="128,5,179,35"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a29aed42c30189a510295e50c98f34afc"></a><!-- doxytag: member="fb_hal.h::panic" ref="a29aed42c30189a510295e50c98f34afc" args="(uint8_t reason)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">HAL_EXT void panic </td>
          <td>(</td>
          <td class="paramtype">uint8_t&nbsp;</td>
          <td class="paramname"> <em>reason</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Hold application and set blink code to PORTB pin 0, our prog pin and LED. </p>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000104">Todo:</a></b></dt><dd>Replace that function with a mechanism that not completely kills the controller application </dd></dl>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>reason</em>&nbsp;</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000117">Todo:</a></b></dt><dd>Replace that function with a mechanism that not completely kills the controller application </dd></dl>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>reason</em>&nbsp;</td><td></td></tr>
  </table>
  </dd>
</dl>

<p>Referenced by <a class="el" href="msg__queue_8c_source.html#l00061">AllocMsgI()</a>.</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dynsection">
<div class="center"><img src="fb__hal_8h_a29aed42c30189a510295e50c98f34afc_icgraph.png" border="0" usemap="#fb__hal_8h_a29aed42c30189a510295e50c98f34afc_icgraph_map" alt=""></div>
<map name="fb__hal_8h_a29aed42c30189a510295e50c98f34afc_icgraph_map" id="fb__hal_8h_a29aed42c30189a510295e50c98f34afc_icgraph">
<area shape="rect" id="node3" href="msg__queue_8c.html#ad79d9162c65e803240d20adab3ea60f0" title="Allocate space for a message and return a pointer to it." alt="" coords="113,584,196,613"/><area shape="rect" id="node5" href="msg__queue_8h.html#aadc5609c7a2263c8cae4ab0d8eae7c4d" title="Allocate a new message." alt="" coords="279,219,359,248"/><area shape="rect" id="node29" href="fb__prot_8c.html#a1ca66f4c62a2c7c7ff2c8ebef64465da" title="Create a new telegram and and return pointer to it." alt="" coords="267,404,371,433"/><area shape="rect" id="node45" href="fb__app_8h.html#ace6b0e9279dd6bc5c4238fd4bac237ba" title="Read status from port and return it." alt="" coords="256,531,381,560"/><area shape="rect" id="node49" href="fb__prot_8c.html#ade80ef84f4f14d25a2283b43d9c1a54f" title="Send telegram as response to signal current state of the port to other devices." alt="" coords="249,584,388,613"/><area shape="rect" id="node51" href="fb__prot_8c.html#a990a78673785da5bb024bfaf60e0984a" title="Send telegram as response to signal current state of the port to other devices." alt="" coords="261,637,376,667"/><area shape="rect" id="node61" href="fb__hal_8c.html#ab475358073d6ed6f59de0b9fd41e65ee" title="That function can be use to send a test telegramm to the bus, e.g." alt="" coords="245,703,392,732"/><area shape="rect" id="node65" href="fb__hal_8c.html#adbc1536a5853b8f6c824462a53cf4f67" title="A start bit was received in the past now read bit for bit until the end of the octet..." alt="" coords="253,781,384,811"/><area shape="rect" id="node7" href="fb__eeprom_8c.html#a68f918bbf3e9cd0ec46a706bb5c8b9d3" title="Write data to the eeprom cache and trigger background process to write eeprom cache..." alt="" coords="453,219,613,248"/><area shape="rect" id="node21" href="lib_2uart_8c.html#a8eaa1ed3292777a3ed02045bd4b612c3" title="Queue a character and start background sending to rs232." alt="" coords="489,85,577,115"/><area shape="rect" id="node9" href="fb__prot_8c.html#afae8acdc71d1ebff494c621459c097cf" title="Write recieved data to the eeprom." alt="" coords="707,272,843,301"/><area shape="rect" id="node11" href="fb__prot_8c.html#ac3b30c7591e51974ab895440929395c6" title="Set the received address as our new device address." alt="" coords="680,165,869,195"/><area shape="rect" id="node13" href="fb__relais__app_8c.html#aac9e4f65925a5a959cb5df9ed091b3b7" title="Switch the objects to state in portValue and save value to eeprom if necessary." alt="" coords="715,219,835,248"/><area shape="rect" id="node15" href="fb__relais__app_8c.html#aabc97de0ba2150af0af7d2ddb8293824" title="Function is called when microcontroller gets power or if the application must be..." alt="" coords="941,165,1083,195"/><area shape="rect" id="node17" href="fb__relais__app_8c.html#a30773cfc4105728c9628fca36c8c7c20" title="Function is called if A_GroupValue_Write is received." alt="" coords="955,219,1069,248"/><area shape="rect" id="node19" href="fb__relais__app_8c.html#a3cabe34d9b90083ff13af0188e622539" title="Timer1 is used as application timer." alt="" coords="924,272,1100,301"/><area shape="rect" id="node23" href="lib_2uart_8c.html#a1e9aadc7cf5409fa2408900b44ee1f87" title="Queue a character and write it as a hex value to rs232." alt="" coords="733,112,816,141"/><area shape="rect" id="node25" href="lib_2uart_8c.html#a235e7f4c195d6d877cc0bb2facff043b" title="Queue a newline and write it to the rs232." alt="" coords="721,5,828,35"/><area shape="rect" id="node27" href="lib_2uart_8c.html#ae52facc0a56086a365bb0018160d8d71" title="Display string on rs232." alt="" coords="732,59,817,88"/><area shape="rect" id="node31" href="fb__prot_8c.html#a4a0be801ed4f2d9b2cbce548adf56a76" title="Read the values from the ADC converter." alt="" coords="720,468,829,497"/><area shape="rect" id="node33" href="fb__prot_8c.html#a37d55968595e78e21dc1dba21418acf4" title="Is called if information for the BCU type is requested." alt="" coords="676,325,873,355"/><area shape="rect" id="node35" href="fb__prot_8c.html#af2931210aae10a2c39698d2f1fb3c98c" title="Read data from eeprom and return send it as telegram back to the requester." alt="" coords="708,403,841,432"/><area shape="rect" id="node37" href="fb__prot_8c.html#ae42ed05d4ccf0a841bdaa32fe7af4478" title="Returns the address of the device." alt="" coords="440,377,627,407"/><area shape="rect" id="node39" href="fb__prot_8c.html#a440973c20d3055721521a359aee68536" title="Sicherungslayer." alt="" coords="492,324,575,353"/><area shape="rect" id="node47" href="fb__prot_8c.html#ae56aada1e48493023c8f3ecf7a1e71a7" title="A read request to the application." alt="" coords="456,532,611,561"/><area shape="rect" id="node53" href="fb__in8__app_8c.html#a8d1473313842fe123fec771c086af269" title="Port Function: Jalousie." alt="" coords="464,636,603,665"/><area shape="rect" id="node55" href="fb__in8__app_8c.html#a3cabe34d9b90083ff13af0188e622539" title="Timer1 is used as application timer." alt="" coords="687,636,863,665"/><area shape="rect" id="node57" href="fb__in8__app_8c.html#a71a91b98ae9a796dac4ab23c7e3ff6d8" title="Port Function: switch." alt="" coords="467,689,600,719"/><area shape="rect" id="node63" href="fb__in8__app_8c.html#a840291bc02cba5474a4cb46a9b9566fe" title="The start point of the program, init all libraries, start the bus interface, the..." alt="" coords="507,743,560,772"/><area shape="rect" id="node67" href="fb__hal_8c.html#aec43762dc86e029b395d4e5819192c2d" title="The ISR handles which function must be called." alt="" coords="512,796,555,825"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a4b15ee32b7b560554e0f6d6945dde9d4"></a><!-- doxytag: member="fb_hal.h::sendTestTelegram" ref="a4b15ee32b7b560554e0f6d6945dde9d4" args="(void)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">HAL_EXT void sendTestTelegram </td>
          <td>(</td>
          <td class="paramtype">void&nbsp;</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>That function can be use to send a test telegramm to the bus, e.g. </p>
<p>to measure signal levels in circuit. </p>

<p>References <a class="el" href="msg__queue_8c_source.html#l00061">AllocMsgI()</a>, <a class="el" href="fb__prot_8h_source.html#l00102">fbus_hdr::apci</a>, <a class="el" href="fb__prot_8h_source.html#l00097">fbus_hdr::ctrl</a>, <a class="el" href="msg__queue_8h_source.html#l00070">msg::data</a>, <a class="el" href="freebus-debug_8h_source.html#l00067">DEBUG_NEWLINE</a>, <a class="el" href="freebus-debug_8h_source.html#l00057">DEBUG_PUTS</a>, <a class="el" href="fb__prot_8h_source.html#l00099">fbus_hdr::dest</a>, <a class="el" href="fb__eeprom_8c_source.html#l00178">eeprom_ParamRead()</a>, <a class="el" href="fb__hal_8h_source.html#l00053">FB_BUS_FREE</a>, <a class="el" href="fb__hal_8c_source.html#l00968">fb_hal_txqueue_msg()</a>, <a class="el" href="fb__hal_8c_source.html#l00142">fbstat</a>, <a class="el" href="msg__queue_8h_source.html#l00069">msg::len</a>, <a class="el" href="fb__prot_8h_source.html#l00100">fbus_hdr::npci</a>, <a class="el" href="fb__prot_8h_source.html#l00082">PA_ADDRESS_HIGH</a>, <a class="el" href="fb__prot_8h_source.html#l00083">PA_ADDRESS_LOW</a>, <a class="el" href="msg__queue_8h_source.html#l00071">msg::repeat</a>, <a class="el" href="fb__prot_8h_source.html#l00098">fbus_hdr::src</a>, and <a class="el" href="fb__prot_8h_source.html#l00101">fbus_hdr::tpci</a>.</p>

<p>Referenced by <a class="el" href="fb__in8__app_8c_source.html#l00870">main()</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dynsection">
<div class="center"><img src="fb__hal_8h_a4b15ee32b7b560554e0f6d6945dde9d4_cgraph.png" border="0" usemap="#fb__hal_8h_a4b15ee32b7b560554e0f6d6945dde9d4_cgraph_map" alt=""></div>
<map name="fb__hal_8h_a4b15ee32b7b560554e0f6d6945dde9d4_cgraph_map" id="fb__hal_8h_a4b15ee32b7b560554e0f6d6945dde9d4_cgraph">
<area shape="rect" id="node3" href="msg__queue_8h.html#aa3b6fa424df78c0dbbbaa16a7dd32acb" title="Allocate space for a message and return a pointer to it." alt="" coords="213,5,291,35"/><area shape="rect" id="node7" href="fb__eeprom_8h.html#a93b2810dc3abdedaa3dfa772943fb5ca" title="Read data from the eeprom cache and return it." alt="" coords="183,59,321,88"/><area shape="rect" id="node9" href="fb__hal_8h.html#af70a4606fe5ce0777a371e0c6c3540fb" title="Queue message for sending." alt="" coords="181,112,323,141"/><area shape="rect" id="node5" href="fb__hal_8h.html#a29aed42c30189a510295e50c98f34afc" title="Hold application and set blink code to PORTB pin 0, our prog pin and LED." alt="" coords="388,5,441,35"/><area shape="rect" id="node11" href="msg__queue_8h.html#af35d846267d1aaaf1df04c8bff03047e" title="Add a new message to the message queue." alt="" coords="373,85,456,115"/><area shape="rect" id="node13" href="fb__hal_8c.html#abc433410f75bf996dab8e7fa672205c0" title="Function is called from message queue system to trigger the interrupt for transmitting..." alt="" coords="372,139,457,168"/><area shape="rect" id="node15" href="fb__hal_8c.html#a8155185b5b41794d6ead2aba9870b9fa" title="Generate the telegram checksum and copy the next octet to send to fb_frame." alt="" coords="508,139,607,168"/><area shape="rect" id="node17" href="fb__hal_8c.html#a5a622f74cb37183309cbf6a3678fb129" title="Generate an EIB frame and calculate the checksum." alt="" coords="675,112,739,141"/><area shape="rect" id="node19" href="fb__hal_8c.html#aa4a5a78d404751d2731d41c606c430fc" title="Set the next state in sending mode." alt="" coords="656,165,757,195"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dynsection">
<div class="center"><img src="fb__hal_8h_a4b15ee32b7b560554e0f6d6945dde9d4_icgraph.png" border="0" usemap="#fb__hal_8h_a4b15ee32b7b560554e0f6d6945dde9d4_icgraph_map" alt=""></div>
<map name="fb__hal_8h_a4b15ee32b7b560554e0f6d6945dde9d4_icgraph_map" id="fb__hal_8h_a4b15ee32b7b560554e0f6d6945dde9d4_icgraph">
<area shape="rect" id="node3" href="fb__in8__app_8c.html#a840291bc02cba5474a4cb46a9b9566fe" title="The start point of the program, init all libraries, start the bus interface, the..." alt="" coords="181,5,232,35"/></map>
</div>
</p>

</div>
</div>
<hr/><h2>Variable Documentation</h2>
<a class="anchor" id="a53ac9c8b9cfb94746b9f5b39bf152620"></a><!-- doxytag: member="fb_hal.h::systemState" ref="a53ac9c8b9cfb94746b9f5b39bf152620" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">HAL_EXT uint8_t <a class="el" href="fb__hal_8h.html#a53ac9c8b9cfb94746b9f5b39bf152620">systemState</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Holds the system state. </p>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000079">Todo:</a></b></dt><dd>give more detailed explaination </dd></dl>

<p>Referenced by <a class="el" href="fb__prot_8c_source.html#l00386">A_PhysicalAddress_Read()</a>, <a class="el" href="fb__prot_8c_source.html#l00358">A_PhysicalAddress_Write()</a>, <a class="el" href="fb__eeprom_8c_source.html#l00178">eeprom_ParamRead()</a>, <a class="el" href="fb__eeprom_8c_source.html#l00210">eeprom_ParamWrite()</a>, <a class="el" href="fb__hal_8c_source.html#l00266">fbhal_checkProgTaster()</a>, and <a class="el" href="fb__hal_8c_source.html#l01010">fbhal_Init()</a>.</p>

</div>
</div>
</div>
<hr size="1"/><address style="text-align: right;"><small>Generated by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.6.2 </small></address>
</body>
</html>
