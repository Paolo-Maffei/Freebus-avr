<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>FreeBusAVR: lib/fb_hal.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- Generated by Doxygen 1.6.2 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="main.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Data&nbsp;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div class="tabs">
    <ul>
      <li><a href="files.html"><span>File&nbsp;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
</div>
<div class="contents">
<h1>lib/fb_hal.c File Reference</h1>
<p>Freebus Hardware Layer. Implementation of a software- uart + timer handling This file consists of function which are bound to the hardware For further information check the pdf 03_02_02 Communication Medium TP 1 v1.0 AS.PDF.  
<a href="#_details">More...</a></p>
<code>#include &quot;<a class="el" href="fb_8h_source.html">fb.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="fb__hardware_8h_source.html">fb_hardware.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="freebus-debug_8h_source.html">freebus-debug.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="fb__eeprom_8h_source.html">fb_eeprom.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="fb__prot_8h_source.html">fb_prot.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="fb__hal_8h_source.html">fb_hal.h</a>&quot;</code><br/>
<div class="dynheader">
Include dependency graph for fb_hal.c:</div>
<div class="dynsection">
<div class="center"><img src="fb__hal_8c__incl.png" border="0" usemap="#lib_2fb__hal_8c_map" alt=""/></div>
<map name="lib_2fb__hal_8c_map" id="lib_2fb__hal_8c">
<area shape="rect" id="node3" href="fb_8h.html" title="Define general values used in bus communication." alt="" coords="21,160,63,189"/><area shape="rect" id="node5" href="fb__hardware_8h.html" title="Hardware specific options which includes the platforms (like ATmega8, ATmega168...." alt="" coords="9,237,110,267"/><area shape="rect" id="node7" href="freebus-debug_8h.html" title="Header file to map debugging between several output devices. Possible outputs are..." alt="" coords="347,83,462,112"/><area shape="rect" id="node15" href="fb__eeprom_8h.html" title="Handling the access and mapping to the eeprom." alt="" coords="486,83,579,112"/><area shape="rect" id="node17" href="fb__prot_8h.html" title="Define the protocol specific definitions Implementation of the communication protocol..." alt="" coords="101,83,173,112"/><area shape="rect" id="node23" href="fb__hal_8h.html" title="Definitions on Hardware Abstration Layer." alt="" coords="211,83,278,112"/><area shape="rect" id="node11" href="lcd-lib_8h.html" title="lcd&#45;lib.h" alt="" coords="418,160,485,189"/><area shape="rect" id="node13" href="delay_8h.html" title="Functions to delay the execution." alt="" coords="419,237,483,267"/><area shape="rect" id="node20" href="msg__queue_8h.html" title="Definitions for the message queue system used for telegrams and communucation like..." alt="" coords="87,160,186,189"/></map>
</div>
<table border="0" cellpadding="0" cellspacing="0">
<tr><td colspan="2"><h2>Defines</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="fb__hal_8c.html#a7bb97dbc2abccfc6ec4a1da276be1352">EIB_BIT_TIME</a>&nbsp;&nbsp;&nbsp;104U</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">duration of one bit on the EIB  <a href="#a7bb97dbc2abccfc6ec4a1da276be1352"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="fb__hal_8c.html#a832e9cd092f6ebab14ef4410263d165c">EIB_TX_LOWTIME</a>&nbsp;&nbsp;&nbsp;40U</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">How long we hold the level on that value (35us).  <a href="#a832e9cd092f6ebab14ef4410263d165c"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="fb__hal_8c.html#ac6eb4519f1b43004d78120e297b7cc29">EIB_TX_HIGHTIME</a>&nbsp;&nbsp;&nbsp;EIB_BIT_TIME-EIB_TX_LOWTIME</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">for the rest of the time the bus is high  <a href="#ac6eb4519f1b43004d78120e297b7cc29"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="fb__hal_8c.html#ac7553420ae73a48c64bc99ebae0cb1ed">EIB_NONE_MODE</a>&nbsp;&nbsp;&nbsp;0</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">the receive and sending part is in idle mode  <a href="#ac7553420ae73a48c64bc99ebae0cb1ed"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="fb__hal_8c.html#a45a3ce976119aa33a25ed9f6bd62800b">EIB_SEND_MODE</a>&nbsp;&nbsp;&nbsp;(1&lt;&lt;0)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">defines that we're in send mode, if the ISR is triggered the send functions are called  <a href="#a45a3ce976119aa33a25ed9f6bd62800b"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="fb__hal_8c.html#a39180a8413181162f840090a165a53c9">EIB_RECEIVE_MODE</a>&nbsp;&nbsp;&nbsp;(1&lt;&lt;1)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">defines that we're in receive mode, if the ISR is triggered the receive functions are called  <a href="#a39180a8413181162f840090a165a53c9"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="fb__hal_8c.html#a56e22527b5751ef05494c349efbf3efc">EIB_CHECK_FOR_COLLISION</a>&nbsp;&nbsp;&nbsp;(1&lt;&lt;2)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">defined if in transmit mode we have to check if a collision occured  <a href="#a56e22527b5751ef05494c349efbf3efc"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="fb__hal_8c.html#a4840974af68cdfcf383a6408cf7897fa">START_TX</a>()</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">start timer: Timer0 using only timer0 to have timer1 and timer2 free for the application  <a href="#a4840974af68cdfcf383a6408cf7897fa"></a><br/></td></tr>
<tr><td colspan="2"><h2>Enumerations</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">enum &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="fb__hal_8c.html#af24054d97e225ff81412767e9e92780b">etimer_state</a> { <br/>
&nbsp;&nbsp;<a class="el" href="fb__hal_8c.html#af24054d97e225ff81412767e9e92780ba95f116553b8e2d1cd7be8a22840d1cf2">TS_WAITING_CHARS</a> =  0x00, 
<a class="el" href="fb__hal_8c.html#af24054d97e225ff81412767e9e92780ba4edb33432ce91da9dbc2877fa520fc2f">TS_WAITING_TIMEOUT</a>, 
<a class="el" href="fb__hal_8c.html#af24054d97e225ff81412767e9e92780ba33c7a599ee9d3fbffdd9424fa8103a74">TS_WAITING_ACK</a>, 
<a class="el" href="fb__hal_8c.html#af24054d97e225ff81412767e9e92780baea28c3b68095d1841dc25772ee911ccf">TS_WAITING_ACK_RESP</a>, 
<br/>
&nbsp;&nbsp;<a class="el" href="fb__hal_8c.html#af24054d97e225ff81412767e9e92780baafdffc11056a3e174f83508e3977d6e2">TS_WAITING_BUS_FREE</a>
<br/>
 }</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight"><p>Status for receiving mode, is used in the ISR to decide which function must be called next. </p>
 <a href="fb__hal_8c.html#af24054d97e225ff81412767e9e92780b">More...</a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">enum &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="fb__hal_8c.html#ad04bb26f006f4041eeedd64c90e10dcb">etx_state</a> { <br/>
&nbsp;&nbsp;<a class="el" href="fb__hal_8c.html#ad04bb26f006f4041eeedd64c90e10dcba95f419c69e376d2b98405394bdb5fa1c">TX_NONE</a> =  0x00, 
<a class="el" href="fb__hal_8c.html#ad04bb26f006f4041eeedd64c90e10dcba392e67967765fc36b13fa57431d05e6d">TX_SEND_DATA</a>, 
<a class="el" href="fb__hal_8c.html#ad04bb26f006f4041eeedd64c90e10dcba0e7b1023eb5c47a8c27126c4c6320e3c">TX_SEND_CHECKSUM</a>, 
<a class="el" href="fb__hal_8c.html#ad04bb26f006f4041eeedd64c90e10dcba9b380c6ca3d4b5a70e5649ca12f180ff">TX_WAITING_ACK</a>, 
<br/>
&nbsp;&nbsp;<a class="el" href="fb__hal_8c.html#ad04bb26f006f4041eeedd64c90e10dcbaae441d024d64d59f65315abb3112bfec">TX_ERROR</a>
<br/>
 }</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight"><p>Status for transmitting mode, is used in the ISR to decide which function must be called next. </p>
 <a href="fb__hal_8c.html#ad04bb26f006f4041eeedd64c90e10dcb">More...</a><br/></td></tr>
<tr><td colspan="2"><h2>Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="fb__hal_8c.html#aa4a5a78d404751d2731d41c606c430fc">next_tx_state</a> (enum <a class="el" href="fb__hal_8c.html#ad04bb26f006f4041eeedd64c90e10dcb">etx_state</a> new_state)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Set the next state in sending mode.  <a href="#aa4a5a78d404751d2731d41c606c430fc"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="fb__hal_8c.html#abe9ce1ff59cb1eb49f7e651549139764">next_rx_state</a> (enum <a class="el" href="fb__hal_8c.html#af24054d97e225ff81412767e9e92780b">etimer_state</a> new_state)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Set the next state while in receiving mode.  <a href="#abe9ce1ff59cb1eb49f7e651549139764"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="fb__hal_8c.html#a000fea78ba4ec6b5cb844d931242184c">freebus_sleep_mode</a> ()</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Enter sleep_mode to save power.  <a href="#a000fea78ba4ec6b5cb844d931242184c"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="fb__hal_8c.html#a8155185b5b41794d6ead2aba9870b9fa">tx_send_data</a> ()</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Generate the telegram checksum and copy the next octet to send to fb_frame.  <a href="#a8155185b5b41794d6ead2aba9870b9fa"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="fb__hal_8c.html#a02bd6a0eef1e1be4a306236d886f04bb">tx_complete</a> ()</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Postive acknowledge received, dequeue message.  <a href="#a02bd6a0eef1e1be4a306236d886f04bb"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="fb__hal_8c.html#afcdb445c1b6cc3e39d904592286349ee">tx_error</a> ()</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Negative acknowledge received, check repeat counter and if repeat is not expired resend telegram.  <a href="#afcdb445c1b6cc3e39d904592286349ee"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="fb__hal_8c.html#a5a622f74cb37183309cbf6a3678fb129">fb_putc</a> (const uint8_t c)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Generate an EIB frame and calculate the checksum.  <a href="#a5a622f74cb37183309cbf6a3678fb129"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="fb__hal_8c.html#adbc1536a5853b8f6c824462a53cf4f67">timer_rec_chars</a> (void)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">A start bit was received in the past now read bit for bit until the end of the octet is received (10 bit).  <a href="#adbc1536a5853b8f6c824462a53cf4f67"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="fb__hal_8c.html#af44a3cacd6e2ffabfab5a4628b796a79">timer_timeout</a> (void)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">That function is called if the timeout of 384탎 tiggered.  <a href="#af44a3cacd6e2ffabfab5a4628b796a79"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="fb__hal_8c.html#a4738339212f7be2d3090deb995953529">timer_ack</a> (void)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Telegram received completly now decided which telegram type was recieved and if it is necessary to send confirmation back.  <a href="#a4738339212f7be2d3090deb995953529"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="fb__hal_8c.html#a4f090f79722be364605b7c776db2a78a">timer_bus_free</a> (void)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Telegram received.  <a href="#a4f090f79722be364605b7c776db2a78a"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="fb__hal_8c.html#a3cef2c79df784b2c7e52dde126b0e0d0">timer_resp_tout</a> (void)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Telegram send completely but ack wasn't received in timerframe, set error flag in control structure.  <a href="#a3cef2c79df784b2c7e52dde126b0e0d0"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="fb__hal_8c.html#a1a372817454f06132f80e02fbc7005df">tx_send_checksum</a> ()</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Put the checksum in fb_frame and set state machine to wait for ack.  <a href="#a1a372817454f06132f80e02fbc7005df"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="fb__hal_8c.html#a1e9ccf79644054a2acf54780c4ee0fee">tx_wait_ack</a> ()</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">All data + checksum transmitted, stop IRQ and wait for acknowledge.  <a href="#a1e9ccf79644054a2acf54780c4ee0fee"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="fb__hal_8c.html#a3e63d2a0ec530f41c556c9187fabcf80">checkForCollisions</a> ()</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Check if we have a collision on the bus and retrigger the timer0 interrupt.  <a href="#a3e63d2a0ec530f41c556c9187fabcf80"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="fb__hal_8c.html#ab475358073d6ed6f59de0b9fd41e65ee">sendTestTelegram</a> ()</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">That function can be use to send a test telegramm to the bus, e.g.  <a href="#ab475358073d6ed6f59de0b9fd41e65ee"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">uint8_t&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="fb__hal_8c.html#a85ef2600dfae61cd15f445efbc31fb60">fbhal_checkProgTaster</a> (void)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Check the programm button and set programming mode and switch LED depending on programming mode.  <a href="#a85ef2600dfae61cd15f445efbc31fb60"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="fb__hal_8c.html#a296f7c3289677f2b99af85e65dfd04e0">fb_send_ack</a> (uint8_t value)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Function to set the ack value for the response to a telegram which must be send in a absolutly excat timing.  <a href="#a296f7c3289677f2b99af85e65dfd04e0"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="fb__hal_8c.html#adc42490ec5de72809d53c35e57198de6">fb_hal_restart</a> (void)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Restart the application by activating the watchdog and block the program.  <a href="#adc42490ec5de72809d53c35e57198de6"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="fb__hal_8c.html#afea150fcd685610cb9f7672fce361e53">ISR</a> (INT0_vect)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">A falling edge triggers this interrupt.  <a href="#afea150fcd685610cb9f7672fce361e53"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="fb__hal_8c.html#aec43762dc86e029b395d4e5819192c2d">ISR</a> (TIMER0_COMPA_vect)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">The ISR handles which function must be called.  <a href="#aec43762dc86e029b395d4e5819192c2d"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="aa513bd38a02761593d0217c8497033ac"></a><!-- doxytag: member="fb_hal.c::ISR" ref="aa513bd38a02761593d0217c8497033ac" args="(TIMER0_COMPB_vect)" -->
&nbsp;</td><td class="memItemRight" valign="bottom"><b>ISR</b> (TIMER0_COMPB_vect)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="fb__hal_8c.html#abc433410f75bf996dab8e7fa672205c0">retrigger_tx</a> (void)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Function is called from message queue system to trigger the interrupt for transmitting data.  <a href="#abc433410f75bf996dab8e7fa672205c0"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">uint8_t&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="fb__hal_8c.html#abbf23a2adcf8b8280c8ce17d4a12951b">fb_hal_txqueue_msg</a> (struct <a class="el" href="structmsg.html">msg</a> *tx)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Queue message for sending.  <a href="#abbf23a2adcf8b8280c8ce17d4a12951b"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="fb__hal_8c.html#a30c6b413389944e9362e0bb20467962e">panic</a> (uint8_t reason)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Hold application and set blink code to PORTB pin 0, our prog pin and LED.  <a href="#a30c6b413389944e9362e0bb20467962e"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="fb__hal_8c.html#a1d2bce7e6ac0dd55aa811e53722ea4be">fbhal_Init</a> (void)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Set input/output mode to PORTs, init timers and interrupts.  <a href="#a1d2bce7e6ac0dd55aa811e53722ea4be"></a><br/></td></tr>
<tr><td colspan="2"><h2>Variables</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static enum <a class="el" href="fb__hal_8c.html#af24054d97e225ff81412767e9e92780b">etimer_state</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="fb__hal_8c.html#a917217e208d04fa3254181b9ddfa2f12">rx_state</a></td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">save the next state while be in receiving mode  <a href="#a917217e208d04fa3254181b9ddfa2f12"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static enum <a class="el" href="fb__hal_8c.html#ad04bb26f006f4041eeedd64c90e10dcb">etx_state</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="fb__hal_8c.html#a7c331c7fe91b2ca727e65c7262fdc5ae">tx_state</a></td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">save the next state while be in transmitting mode  <a href="#a7c331c7fe91b2ca727e65c7262fdc5ae"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static volatile uint16_t&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="fb__hal_8c.html#a41f5a7da095fd642694f9c6a222ede72">fb_frame</a></td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">the current octet to transmit, including start, parity and stop bit  <a href="#a41f5a7da095fd642694f9c6a222ede72"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static volatile uint16_t&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="fb__hal_8c.html#a6c6b8bbd9bffb5b0c907b3b903b9ea8f">rxframe</a></td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">hold data of the octet while receiving data. That variable is filled bit per bit.  <a href="#a6c6b8bbd9bffb5b0c907b3b903b9ea8f"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static volatile uint8_t&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="fb__hal_8c.html#af342e7c63def35b89b53992fdbd53eb3">fbstat</a></td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">the status for transmition (error status, all ok)  <a href="#af342e7c63def35b89b53992fdbd53eb3"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static struct <a class="el" href="structmsg.html">msg</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="fb__hal_8c.html#adbfedca471e27c2d257fc90093e5f3de">rx_ptr</a></td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">store a recieved telegramm here.  <a href="#adbfedca471e27c2d257fc90093e5f3de"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static struct <a class="el" href="structmsg.html">msg</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="fb__hal_8c.html#a008e953d2cc04433cec1a2467459164a">tx_ptr</a></td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">store telegram which should be sent  <a href="#a008e953d2cc04433cec1a2467459164a"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static volatile uint8_t&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="fb__hal_8c.html#aabc55f9c0f54b21d7dc8409b5a8474da">fb_ackvalue</a></td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">if a response byte should be send back set this variable to FB_ACK, FB_NACK, FB_BUSY or FB_NONE  <a href="#aabc55f9c0f54b21d7dc8409b5a8474da"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static volatile uint8_t&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="fb__hal_8c.html#af481e250ef03f4b453d59719312d6014">wr_cnt</a></td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">number of octet in telegram to send  <a href="#af481e250ef03f4b453d59719312d6014"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static volatile uint8_t&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="fb__hal_8c.html#a89896b172be5ecbbe195b793a91fe4f4">checksum</a></td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">checksum of the EIB telegram (over all octets)  <a href="#a89896b172be5ecbbe195b793a91fe4f4"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">uint8_t&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="fb__hal_8c.html#a895b38744b07b801d5765dcf50de0b16">operationMode</a></td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">defines if sending or receiving data  <a href="#a895b38744b07b801d5765dcf50de0b16"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static volatile uint8_t&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="fb__hal_8c.html#a1769822e1fa84e6790b15ba3ec99d32e">timer0_skips</a></td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">counter for skipping timer0 interrupts  <a href="#a1769822e1fa84e6790b15ba3ec99d32e"></a><br/></td></tr>
</table>
<hr/><a name="_details"></a><h2>Detailed Description</h2>
<p>Freebus Hardware Layer. Implementation of a software- uart + timer handling This file consists of function which are bound to the hardware For further information check the pdf 03_02_02 Communication Medium TP 1 v1.0 AS.PDF. </p>
<dl class="author"><dt><b>Author:</b></dt><dd>Dirk Opfer, Matthias Fechner, Christian Bode, Dirk Armbrust </dd></dl>
<dl class="date"><dt><b>Date:</b></dt><dd>Fri Oct 26 17:22:16 2007</dd></dl>
<p>One bit has the length of 104us (35us date and 69us wait time).<br/>
 One character is then 11*104us=1144us.</p>
<p>After a character we have a waiting time of 2 bits that means 208us before we start with the next start bit.</p>
<p>When the telgram is complete the ackknowledge is sent after 13 bit wait time that means 13*104us=1352us</p>
<p>After the acknowledge the device have to wait 50 bits that means bus is free after 50*104us=5200us + wait time for priority The wait time for priority depends on the priority and is:</p>
<ul>
<li>low (4) or high (3): wait 3 bits 3*104us=312us</li>
<li>system (2) or alarm (1): no waiting time</li>
</ul>
<p>The IACK or INACK has no waiting time and will immediatly be transmitted.</p>
<p>So the waiting time for received mode will be: -EXT INT triggered: Timer0 wait 104탎 for bit 0 -Timer0 wait 104탎 for each next bit (bit 1, 2, 3, 4, 5, 6, 7, P, S) till full character received -Timer0 wait 2*104탎 (wait time between character) = 208탎 and start ACK timer with TIMER0 1352탎, enable EXT INT -Loop the last two steps till we have not received a bit for</p>
<p>If compiled with -DDEBUG_TIMING the 8 IO line are used to output debugging:</p>
<ul>
<li>PIN8: 1=receive mode, 0=send mode</li>
</ul>
<ul>
<li>Receive Mode:<ul>
<li>PIN1: 1=start bit received, 0=function left</li>
<li>PIN2: 1=start overflow interrupt, 0=function left</li>
<li>PIN3: 1=read bit (timer_rec_chars), 0=function left</li>
<li>PIN4: 1=read bit information, 0=bit finished</li>
<li>PIN5: 1=timeout reached (timer_timeout), 0=function left</li>
<li>PIN6: 1=sent ACK (timer_ack), 0=function left</li>
<li>PIN7: 1=bus free (timer_bus_free), 0=function left</li>
</ul>
</li>
</ul>
<ul>
<li>Send Mode:<ul>
<li>PIN1: 1=prepare telegram, 0=function left</li>
<li>PIN2: 1=start overflow interrupt, 0=function left</li>
<li>PIN3: 1=send bit, 0=working on send bit finished</li>
<li>PIN4: 1=check for collision, 0=function left</li>
<li>PIN5: 1=prepare data for ACK, 0=function left</li>
<li>PIN6: 1=waiting for ACK, 0=function left</li>
<li>PIN7: 1=telegram complete, 0=function left</li>
<li>PIN5, PIN6, PIN7: 1=tx_error, repeat telegram, 0=function left</li>
</ul>
</li>
</ul>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000089">Todo:</a></b></dt><dd>Die Timerwerte sollten nochmal nachgerechnet/nachgemessen werden. </dd></dl>
<hr/><h2>Define Documentation</h2>
<a class="anchor" id="a7bb97dbc2abccfc6ec4a1da276be1352"></a><!-- doxytag: member="fb_hal.c::EIB_BIT_TIME" ref="a7bb97dbc2abccfc6ec4a1da276be1352" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define EIB_BIT_TIME&nbsp;&nbsp;&nbsp;104U</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>duration of one bit on the EIB </p>

<p>Referenced by <a class="el" href="fb__hal_8c_source.html#l01010">fbhal_Init()</a>, and <a class="el" href="fb__hal_8c_source.html#l00375">ISR()</a>.</p>

</div>
</div>
<a class="anchor" id="a56e22527b5751ef05494c349efbf3efc"></a><!-- doxytag: member="fb_hal.c::EIB_CHECK_FOR_COLLISION" ref="a56e22527b5751ef05494c349efbf3efc" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define EIB_CHECK_FOR_COLLISION&nbsp;&nbsp;&nbsp;(1&lt;&lt;2)</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>defined if in transmit mode we have to check if a collision occured </p>

<p>Referenced by <a class="el" href="fb__hal_8c_source.html#l00535">checkForCollisions()</a>, and <a class="el" href="fb__hal_8c_source.html#l00422">ISR()</a>.</p>

</div>
</div>
<a class="anchor" id="ac7553420ae73a48c64bc99ebae0cb1ed"></a><!-- doxytag: member="fb_hal.c::EIB_NONE_MODE" ref="ac7553420ae73a48c64bc99ebae0cb1ed" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define EIB_NONE_MODE&nbsp;&nbsp;&nbsp;0</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>the receive and sending part is in idle mode </p>

<p>Referenced by <a class="el" href="fb__hal_8c_source.html#l01010">fbhal_Init()</a>.</p>

</div>
</div>
<a class="anchor" id="a39180a8413181162f840090a165a53c9"></a><!-- doxytag: member="fb_hal.c::EIB_RECEIVE_MODE" ref="a39180a8413181162f840090a165a53c9" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define EIB_RECEIVE_MODE&nbsp;&nbsp;&nbsp;(1&lt;&lt;1)</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>defines that we're in receive mode, if the ISR is triggered the receive functions are called </p>

<p>Referenced by <a class="el" href="fb__hal_8c_source.html#l00375">ISR()</a>, <a class="el" href="fb__hal_8c_source.html#l00863">tx_complete()</a>, and <a class="el" href="fb__hal_8c_source.html#l00835">tx_wait_ack()</a>.</p>

</div>
</div>
<a class="anchor" id="a45a3ce976119aa33a25ed9f6bd62800b"></a><!-- doxytag: member="fb_hal.c::EIB_SEND_MODE" ref="a45a3ce976119aa33a25ed9f6bd62800b" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define EIB_SEND_MODE&nbsp;&nbsp;&nbsp;(1&lt;&lt;0)</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>defines that we're in send mode, if the ISR is triggered the send functions are called </p>

<p>Referenced by <a class="el" href="fb__hal_8c_source.html#l00422">ISR()</a>, and <a class="el" href="fb__hal_8c_source.html#l00797">tx_send_data()</a>.</p>

</div>
</div>
<a class="anchor" id="ac6eb4519f1b43004d78120e297b7cc29"></a><!-- doxytag: member="fb_hal.c::EIB_TX_HIGHTIME" ref="ac6eb4519f1b43004d78120e297b7cc29" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define EIB_TX_HIGHTIME&nbsp;&nbsp;&nbsp;EIB_BIT_TIME-EIB_TX_LOWTIME</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>for the rest of the time the bus is high </p>

</div>
</div>
<a class="anchor" id="a832e9cd092f6ebab14ef4410263d165c"></a><!-- doxytag: member="fb_hal.c::EIB_TX_LOWTIME" ref="a832e9cd092f6ebab14ef4410263d165c" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define EIB_TX_LOWTIME&nbsp;&nbsp;&nbsp;40U</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>How long we hold the level on that value (35us). </p>

<p>Referenced by <a class="el" href="fb__hal_8c_source.html#l01010">fbhal_Init()</a>.</p>

</div>
</div>
<a class="anchor" id="a4840974af68cdfcf383a6408cf7897fa"></a><!-- doxytag: member="fb_hal.c::START_TX" ref="a4840974af68cdfcf383a6408cf7897fa" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define START_TX</td>
          <td>(</td>
&nbsp;</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<b>Value:</b><div class="fragment"><pre class="fragment">{ \
          <a class="code" href="freebus-atmega16_8h.html#a86442d04a91688ab51d7f3354e157735" title="disable interrupt INT0">DISABLE_RX_INT</a>();                  <span class="comment">/* disable INT0 interrupt while sending */</span> \
          <a class="code" href="fb__hal_8c.html#a895b38744b07b801d5765dcf50de0b16" title="defines if sending or receiving data">operationMode</a>=<a class="code" href="fb__hal_8c.html#a45a3ce976119aa33a25ed9f6bd62800b" title="defines that we&amp;#39;re in send mode, if the ISR is triggered the send functions are...">EIB_SEND_MODE</a>;       <span class="comment">/* set send mode for operation */</span> \
<span class="comment">/*          RELOAD_TIMER0(255,(1&lt;&lt;CS00));  */</span> \
 \
          TCNT0  = <a class="code" href="fb__hal_8c.html#a7bb97dbc2abccfc6ec4a1da276be1352" title="duration of one bit on the EIB">EIB_BIT_TIME</a>-10;          <span class="comment">/* TX start after 10탎 */</span>\
          TIFR0  = (1&lt;&lt;OCF0A)|(1&lt;&lt;OCF0B) ;   <span class="comment">/* clear pending interrups */</span> \
          TIMSK0 |= (( 1&lt;&lt;OCIE0A )|( 1&lt;&lt;OCIE0B )); <span class="comment">/* enable OCRA, OCRB interrupts */</span>  \
          TCCR0B = (1&lt;&lt;CS01);                <span class="comment">/* start the timer */</span> \
          DEBUG_PIN8_OFF(); }
</pre></div>
<p>start timer: Timer0 using only timer0 to have timer1 and timer2 free for the application </p>

<p>Referenced by <a class="el" href="fb__hal_8c_source.html#l00937">retrigger_tx()</a>, <a class="el" href="fb__hal_8c_source.html#l00717">timer_ack()</a>, and <a class="el" href="fb__hal_8c_source.html#l00740">timer_bus_free()</a>.</p>

</div>
</div>
<hr/><h2>Enumeration Type Documentation</h2>
<a class="anchor" id="af24054d97e225ff81412767e9e92780b"></a><!-- doxytag: member="fb_hal.c::etimer_state" ref="af24054d97e225ff81412767e9e92780b" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">enum <a class="el" href="fb__hal_8c.html#af24054d97e225ff81412767e9e92780b">etimer_state</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Status for receiving mode, is used in the ISR to decide which function must be called next. </p>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000090">Todo:</a></b></dt><dd>define a macro for following instructions in freebus-atmegaxxx.h </dd></dl>
<dl><dt><b>Enumerator: </b></dt><dd><table border="0" cellspacing="2" cellpadding="0">
<tr><td valign="top"><em><a class="anchor" id="af24054d97e225ff81412767e9e92780ba95f116553b8e2d1cd7be8a22840d1cf2"></a><!-- doxytag: member="TS_WAITING_CHARS" ref="af24054d97e225ff81412767e9e92780ba95f116553b8e2d1cd7be8a22840d1cf2" args="" -->TS_WAITING_CHARS</em>&nbsp;</td><td>
<p>normal operation, waiting for characters </p>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="af24054d97e225ff81412767e9e92780ba4edb33432ce91da9dbc2877fa520fc2f"></a><!-- doxytag: member="TS_WAITING_TIMEOUT" ref="af24054d97e225ff81412767e9e92780ba4edb33432ce91da9dbc2877fa520fc2f" args="" -->TS_WAITING_TIMEOUT</em>&nbsp;</td><td>
<p>frame received, waiting for timeout or more data ca. 300탎 </p>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="af24054d97e225ff81412767e9e92780ba33c7a599ee9d3fbffdd9424fa8103a74"></a><!-- doxytag: member="TS_WAITING_ACK" ref="af24054d97e225ff81412767e9e92780ba33c7a599ee9d3fbffdd9424fa8103a74" args="" -->TS_WAITING_ACK</em>&nbsp;</td><td>
<p>data received, time to send ack 1.2ms </p>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="af24054d97e225ff81412767e9e92780baea28c3b68095d1841dc25772ee911ccf"></a><!-- doxytag: member="TS_WAITING_ACK_RESP" ref="af24054d97e225ff81412767e9e92780baea28c3b68095d1841dc25772ee911ccf" args="" -->TS_WAITING_ACK_RESP</em>&nbsp;</td><td>
<p>no ack received </p>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="af24054d97e225ff81412767e9e92780baafdffc11056a3e174f83508e3977d6e2"></a><!-- doxytag: member="TS_WAITING_BUS_FREE" ref="af24054d97e225ff81412767e9e92780baafdffc11056a3e174f83508e3977d6e2" args="" -->TS_WAITING_BUS_FREE</em>&nbsp;</td><td>
<p>data received, waiting for timeout or more data 5ms </p>
</td></tr>
</table>
</dd>
</dl>

</div>
</div>
<a class="anchor" id="ad04bb26f006f4041eeedd64c90e10dcb"></a><!-- doxytag: member="fb_hal.c::etx_state" ref="ad04bb26f006f4041eeedd64c90e10dcb" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">enum <a class="el" href="fb__hal_8c.html#ad04bb26f006f4041eeedd64c90e10dcb">etx_state</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Status for transmitting mode, is used in the ISR to decide which function must be called next. </p>
<dl><dt><b>Enumerator: </b></dt><dd><table border="0" cellspacing="2" cellpadding="0">
<tr><td valign="top"><em><a class="anchor" id="ad04bb26f006f4041eeedd64c90e10dcba95f419c69e376d2b98405394bdb5fa1c"></a><!-- doxytag: member="TX_NONE" ref="ad04bb26f006f4041eeedd64c90e10dcba95f419c69e376d2b98405394bdb5fa1c" args="" -->TX_NONE</em>&nbsp;</td><td>
<p>doing nothing </p>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="ad04bb26f006f4041eeedd64c90e10dcba392e67967765fc36b13fa57431d05e6d"></a><!-- doxytag: member="TX_SEND_DATA" ref="ad04bb26f006f4041eeedd64c90e10dcba392e67967765fc36b13fa57431d05e6d" args="" -->TX_SEND_DATA</em>&nbsp;</td><td>
<p>currently sending data </p>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="ad04bb26f006f4041eeedd64c90e10dcba0e7b1023eb5c47a8c27126c4c6320e3c"></a><!-- doxytag: member="TX_SEND_CHECKSUM" ref="ad04bb26f006f4041eeedd64c90e10dcba0e7b1023eb5c47a8c27126c4c6320e3c" args="" -->TX_SEND_CHECKSUM</em>&nbsp;</td><td>
<p>sending checksum </p>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="ad04bb26f006f4041eeedd64c90e10dcba9b380c6ca3d4b5a70e5649ca12f180ff"></a><!-- doxytag: member="TX_WAITING_ACK" ref="ad04bb26f006f4041eeedd64c90e10dcba9b380c6ca3d4b5a70e5649ca12f180ff" args="" -->TX_WAITING_ACK</em>&nbsp;</td><td>
<p>waiting for ACK </p>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="ad04bb26f006f4041eeedd64c90e10dcbaae441d024d64d59f65315abb3112bfec"></a><!-- doxytag: member="TX_ERROR" ref="ad04bb26f006f4041eeedd64c90e10dcbaae441d024d64d59f65315abb3112bfec" args="" -->TX_ERROR</em>&nbsp;</td><td>
<p>error in sending data occured </p>
</td></tr>
</table>
</dd>
</dl>

</div>
</div>
<hr/><h2>Function Documentation</h2>
<a class="anchor" id="a3e63d2a0ec530f41c556c9187fabcf80"></a><!-- doxytag: member="fb_hal.c::checkForCollisions" ref="a3e63d2a0ec530f41c556c9187fabcf80" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static void checkForCollisions </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [inline, static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Check if we have a collision on the bus and retrigger the timer0 interrupt. </p>
<p>The function is called after 35탎.</p>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000095">Todo:</a></b></dt><dd>implement collition detection </dd></dl>
<dl class="return"><dt><b>Returns:</b></dt><dd></dd></dl>

<p><p>Bustiming: Bitzeit fuer High-Pegel (104us - 35us = 69us) </p>
</p>

<p>References <a class="el" href="fb__hal_8c_source.html#l00100">EIB_CHECK_FOR_COLLISION</a>, <a class="el" href="fb__hal_8h_source.html#l00050">FB_COLLISION</a>, <a class="el" href="fb__hal_8c_source.html#l00140">fb_frame</a>, <a class="el" href="fb__hal_8c_source.html#l00142">fbstat</a>, <a class="el" href="fb__hal_8h_source.html#l00061">OFF</a>, <a class="el" href="fb__hal_8c_source.html#l00148">operationMode</a>, <a class="el" href="fb__2-dimmer__app_8c_source.html#l00046">TIMSK</a>, <a class="el" href="fb__hal_8c_source.html#l00130">TX_ERROR</a>, and <a class="el" href="fb__hal_8c_source.html#l00138">tx_state</a>.</p>

</div>
</div>
<a class="anchor" id="adc42490ec5de72809d53c35e57198de6"></a><!-- doxytag: member="fb_hal.c::fb_hal_restart" ref="adc42490ec5de72809d53c35e57198de6" args="(void)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void fb_hal_restart </td>
          <td>(</td>
          <td class="paramtype">void&nbsp;</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Restart the application by activating the watchdog and block the program. </p>

<p>References <a class="el" href="freebus-atmega16_8h_source.html#l00130">ENABLE_WATCHDOG</a>.</p>

<p>Referenced by <a class="el" href="fb__prot_8c_source.html#l00637">A_Restart()</a>.</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dynsection">
<div class="center"><img src="fb__hal_8c_adc42490ec5de72809d53c35e57198de6_icgraph.png" border="0" usemap="#fb__hal_8c_adc42490ec5de72809d53c35e57198de6_icgraph_map" alt=""></div>
<map name="fb__hal_8c_adc42490ec5de72809d53c35e57198de6_icgraph_map" id="fb__hal_8c_adc42490ec5de72809d53c35e57198de6_icgraph">
<area shape="rect" id="node3" href="fb__prot_8c.html#a088341f3603f5de9eb4817a8199391c6" title="Restart the program on the microcontroller." alt="" coords="155,5,235,35"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="abbf23a2adcf8b8280c8ce17d4a12951b"></a><!-- doxytag: member="fb_hal.c::fb_hal_txqueue_msg" ref="abbf23a2adcf8b8280c8ce17d4a12951b" args="(struct msg *tx)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint8_t fb_hal_txqueue_msg </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structmsg.html">msg</a> *&nbsp;</td>
          <td class="paramname"> <em>tx</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Queue message for sending. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>tx</em>&nbsp;</td><td>Pointer to message</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd></dd></dl>

<p>References <a class="el" href="msg__queue_8c_source.html#l00085">queuemsg()</a>, and <a class="el" href="fb__hal_8c_source.html#l00937">retrigger_tx()</a>.</p>

<p>Referenced by <a class="el" href="fb__prot_8c_source.html#l00594">A_ADC_Read()</a>, <a class="el" href="fb__prot_8c_source.html#l00486">A_DeviceDescriptor_Read()</a>, <a class="el" href="fb__prot_8c_source.html#l00517">A_Memory_Read()</a>, <a class="el" href="fb__prot_8c_source.html#l00386">A_PhysicalAddress_Read()</a>, <a class="el" href="fb__prot_8c_source.html#l00459">ncd_resp()</a>, <a class="el" href="fb__2-dimmer__app_8c_source.html#l00261">readApplication()</a>, <a class="el" href="fb__prot_8c_source.html#l00163">sendExtTelegram()</a>, <a class="el" href="fb__prot_8c_source.html#l00208">sendTelegram()</a>, and <a class="el" href="fb__hal_8c_source.html#l00224">sendTestTelegram()</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dynsection">
<div class="center"><img src="fb__hal_8c_abbf23a2adcf8b8280c8ce17d4a12951b_cgraph.png" border="0" usemap="#fb__hal_8c_abbf23a2adcf8b8280c8ce17d4a12951b_cgraph_map" alt=""></div>
<map name="fb__hal_8c_abbf23a2adcf8b8280c8ce17d4a12951b_cgraph_map" id="fb__hal_8c_abbf23a2adcf8b8280c8ce17d4a12951b_cgraph">
<area shape="rect" id="node3" href="msg__queue_8h.html#af35d846267d1aaaf1df04c8bff03047e" title="Add a new message to the message queue." alt="" coords="197,5,280,35"/><area shape="rect" id="node5" href="fb__hal_8c.html#abc433410f75bf996dab8e7fa672205c0" title="Function is called from message queue system to trigger the interrupt for transmitting..." alt="" coords="196,59,281,88"/><area shape="rect" id="node7" href="fb__hal_8c.html#a8155185b5b41794d6ead2aba9870b9fa" title="Generate the telegram checksum and copy the next octet to send to fb_frame." alt="" coords="332,59,431,88"/><area shape="rect" id="node9" href="fb__hal_8c.html#a5a622f74cb37183309cbf6a3678fb129" title="Generate an EIB frame and calculate the checksum." alt="" coords="499,32,563,61"/><area shape="rect" id="node11" href="fb__hal_8c.html#aa4a5a78d404751d2731d41c606c430fc" title="Set the next state in sending mode." alt="" coords="480,85,581,115"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dynsection">
<div class="center"><img src="fb__hal_8c_abbf23a2adcf8b8280c8ce17d4a12951b_icgraph.png" border="0" usemap="#fb__hal_8c_abbf23a2adcf8b8280c8ce17d4a12951b_icgraph_map" alt=""></div>
<map name="fb__hal_8c_abbf23a2adcf8b8280c8ce17d4a12951b_icgraph_map" id="fb__hal_8c_abbf23a2adcf8b8280c8ce17d4a12951b_icgraph">
<area shape="rect" id="node3" href="fb__prot_8c.html#a4a0be801ed4f2d9b2cbce548adf56a76" title="Read the values from the ADC converter." alt="" coords="452,5,553,35"/><area shape="rect" id="node5" href="fb__prot_8c.html#a37d55968595e78e21dc1dba21418acf4" title="Is called if information for the BCU type is requested." alt="" coords="417,59,588,88"/><area shape="rect" id="node7" href="fb__prot_8c.html#af2931210aae10a2c39698d2f1fb3c98c" title="Read data from eeprom and return send it as telegram back to the requester." alt="" coords="441,165,564,195"/><area shape="rect" id="node9" href="fb__prot_8c.html#ae42ed05d4ccf0a841bdaa32fe7af4478" title="Returns the address of the device." alt="" coords="195,215,368,244"/><area shape="rect" id="node11" href="fb__prot_8c.html#a440973c20d3055721521a359aee68536" title="Sicherungslayer." alt="" coords="244,111,319,140"/><area shape="rect" id="node18" href="fb__app_8h.html#ace6b0e9279dd6bc5c4238fd4bac237ba" title="Read status from port and return it." alt="" coords="227,268,336,297"/><area shape="rect" id="node22" href="fb__prot_8c.html#ade80ef84f4f14d25a2283b43d9c1a54f" title="Send telegram as response to signal current state of the port to other devices." alt="" coords="220,321,343,351"/><area shape="rect" id="node24" href="fb__prot_8c.html#a990a78673785da5bb024bfaf60e0984a" title="Send telegram as response to signal current state of the port to other devices." alt="" coords="231,375,332,404"/><area shape="rect" id="node34" href="fb__hal_8c.html#ab475358073d6ed6f59de0b9fd41e65ee" title="That function can be use to send a test telegramm to the bus, e.g." alt="" coords="217,453,345,483"/><area shape="rect" id="node16" href="fb__prot_8c.html#afae8acdc71d1ebff494c621459c097cf" title="Write recieved data to the eeprom." alt="" coords="441,112,564,141"/><area shape="rect" id="node20" href="fb__prot_8c.html#ae56aada1e48493023c8f3ecf7a1e71a7" title="A read request to the application." alt="" coords="432,268,573,297"/><area shape="rect" id="node26" href="fb__in8__app_8c.html#a8d1473313842fe123fec771c086af269" title="Port Function: Jalousie." alt="" coords="439,373,567,403"/><area shape="rect" id="node28" href="fb__in8__app_8c.html#a3cabe34d9b90083ff13af0188e622539" title="Timer1 is used as application timer." alt="" coords="637,373,787,403"/><area shape="rect" id="node30" href="fb__in8__app_8c.html#a71a91b98ae9a796dac4ab23c7e3ff6d8" title="Port Function: switch." alt="" coords="443,427,563,456"/><area shape="rect" id="node36" href="fb__in8__app_8c.html#a840291bc02cba5474a4cb46a9b9566fe" title="The start point of the program, init all libraries, start the bus interface, the..." alt="" coords="477,480,528,509"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a5a622f74cb37183309cbf6a3678fb129"></a><!-- doxytag: member="fb_hal.c::fb_putc" ref="a5a622f74cb37183309cbf6a3678fb129" args="(const uint8_t c)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static void fb_putc </td>
          <td>(</td>
          <td class="paramtype">const uint8_t&nbsp;</td>
          <td class="paramname"> <em>c</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [inline, static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Generate an EIB frame and calculate the checksum. </p>
<p>The EIB frame is saved in fb_frame.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>c</em>&nbsp;</td><td>The byte to transfer </td></tr>
  </table>
  </dd>
</dl>

<p>References <a class="el" href="fb__hal_8c_source.html#l00140">fb_frame</a>.</p>

<p>Referenced by <a class="el" href="fb__hal_8c_source.html#l00717">timer_ack()</a>, <a class="el" href="fb__hal_8c_source.html#l00820">tx_send_checksum()</a>, and <a class="el" href="fb__hal_8c_source.html#l00797">tx_send_data()</a>.</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dynsection">
<div class="center"><img src="fb__hal_8c_a5a622f74cb37183309cbf6a3678fb129_icgraph.png" border="0" usemap="#fb__hal_8c_a5a622f74cb37183309cbf6a3678fb129_icgraph_map" alt=""></div>
<map name="fb__hal_8c_a5a622f74cb37183309cbf6a3678fb129_icgraph_map" id="fb__hal_8c_a5a622f74cb37183309cbf6a3678fb129_icgraph">
<area shape="rect" id="node3" href="fb__hal_8c.html#a4738339212f7be2d3090deb995953529" title="Telegram received completly now decided which telegram type was recieved and if it..." alt="" coords="347,7,435,36"/><area shape="rect" id="node7" href="fb__hal_8c.html#a1a372817454f06132f80e02fbc7005df" title="Put the checksum in fb_frame and set state machine to wait for ack." alt="" coords="129,59,279,88"/><area shape="rect" id="node10" href="fb__hal_8c.html#a8155185b5b41794d6ead2aba9870b9fa" title="Generate the telegram checksum and copy the next octet to send to fb_frame." alt="" coords="147,137,261,167"/><area shape="rect" id="node5" href="fb__hal_8c.html#aec43762dc86e029b395d4e5819192c2d" title="The ISR handles which function must be called." alt="" coords="560,84,603,113"/><area shape="rect" id="node13" href="fb__hal_8c.html#abc433410f75bf996dab8e7fa672205c0" title="Function is called from message queue system to trigger the interrupt for transmitting..." alt="" coords="340,215,441,244"/><area shape="rect" id="node52" href="fb__hal_8c.html#a4f090f79722be364605b7c776db2a78a" title="Telegram received." alt="" coords="329,161,452,191"/><area shape="rect" id="node15" href="fb__hal_8c.html#abbf23a2adcf8b8280c8ce17d4a12951b" title="Queue message for sending." alt="" coords="501,215,661,244"/><area shape="rect" id="node17" href="fb__prot_8c.html#a4a0be801ed4f2d9b2cbce548adf56a76" title="Read the values from the ADC converter." alt="" coords="989,5,1099,35"/><area shape="rect" id="node19" href="fb__prot_8c.html#a37d55968595e78e21dc1dba21418acf4" title="Is called if information for the BCU type is requested." alt="" coords="945,59,1143,88"/><area shape="rect" id="node21" href="fb__prot_8c.html#af2931210aae10a2c39698d2f1fb3c98c" title="Read data from eeprom and return send it as telegram back to the requester." alt="" coords="977,165,1111,195"/><area shape="rect" id="node23" href="fb__prot_8c.html#ae42ed05d4ccf0a841bdaa32fe7af4478" title="Returns the address of the device." alt="" coords="709,215,896,244"/><area shape="rect" id="node25" href="fb__prot_8c.html#a440973c20d3055721521a359aee68536" title="Sicherungslayer." alt="" coords="761,111,844,140"/><area shape="rect" id="node32" href="fb__app_8h.html#ace6b0e9279dd6bc5c4238fd4bac237ba" title="Read status from port and return it." alt="" coords="740,268,865,297"/><area shape="rect" id="node36" href="fb__prot_8c.html#ade80ef84f4f14d25a2283b43d9c1a54f" title="Send telegram as response to signal current state of the port to other devices." alt="" coords="733,321,872,351"/><area shape="rect" id="node38" href="fb__prot_8c.html#a990a78673785da5bb024bfaf60e0984a" title="Send telegram as response to signal current state of the port to other devices." alt="" coords="745,375,860,404"/><area shape="rect" id="node48" href="fb__hal_8c.html#ab475358073d6ed6f59de0b9fd41e65ee" title="That function can be use to send a test telegramm to the bus, e.g." alt="" coords="729,453,876,483"/><area shape="rect" id="node30" href="fb__prot_8c.html#afae8acdc71d1ebff494c621459c097cf" title="Write recieved data to the eeprom." alt="" coords="976,112,1112,141"/><area shape="rect" id="node34" href="fb__prot_8c.html#ae56aada1e48493023c8f3ecf7a1e71a7" title="A read request to the application." alt="" coords="967,268,1121,297"/><area shape="rect" id="node40" href="fb__in8__app_8c.html#a8d1473313842fe123fec771c086af269" title="Port Function: Jalousie." alt="" coords="975,373,1113,403"/><area shape="rect" id="node42" href="fb__in8__app_8c.html#a3cabe34d9b90083ff13af0188e622539" title="Timer1 is used as application timer." alt="" coords="1193,373,1369,403"/><area shape="rect" id="node44" href="fb__in8__app_8c.html#a71a91b98ae9a796dac4ab23c7e3ff6d8" title="Port Function: switch." alt="" coords="977,427,1111,456"/><area shape="rect" id="node50" href="fb__in8__app_8c.html#a840291bc02cba5474a4cb46a9b9566fe" title="The start point of the program, init all libraries, start the bus interface, the..." alt="" coords="1017,480,1071,509"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a296f7c3289677f2b99af85e65dfd04e0"></a><!-- doxytag: member="fb_hal.c::fb_send_ack" ref="a296f7c3289677f2b99af85e65dfd04e0" args="(uint8_t value)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void fb_send_ack </td>
          <td>(</td>
          <td class="paramtype">uint8_t&nbsp;</td>
          <td class="paramname"> <em>value</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Function to set the ack value for the response to a telegram which must be send in a absolutly excat timing. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>value</em>&nbsp;</td><td>Ackvalue can be FB_ACK, FB_NACK, FB_BUSY and FB_NONE </td></tr>
  </table>
  </dd>
</dl>

<p>References <a class="el" href="freebus-debug_8h_source.html#l00057">DEBUG_PUTS</a>, <a class="el" href="fb_8h_source.html#l00031">FB_ACK</a>, and <a class="el" href="fb__hal_8c_source.html#l00145">fb_ackvalue</a>.</p>

<p>Referenced by <a class="el" href="fb__prot_8c_source.html#l00594">A_ADC_Read()</a>, <a class="el" href="fb__prot_8c_source.html#l00486">A_DeviceDescriptor_Read()</a>, <a class="el" href="fb__prot_8c_source.html#l00669">A_GroupValue_Read()</a>, <a class="el" href="fb__prot_8c_source.html#l00698">A_GroupValue_Write()</a>, <a class="el" href="fb__prot_8c_source.html#l00517">A_Memory_Read()</a>, <a class="el" href="fb__prot_8c_source.html#l00566">A_Memory_Write()</a>, <a class="el" href="fb__prot_8c_source.html#l00386">A_PhysicalAddress_Read()</a>, <a class="el" href="fb__prot_8c_source.html#l00358">A_PhysicalAddress_Write()</a>, <a class="el" href="fb__prot_8c_source.html#l00655">Ignore()</a>, <a class="el" href="fb__prot_8c_source.html#l00416">T_Connect_Req()</a>, <a class="el" href="fb__prot_8c_source.html#l00439">T_Disconnect_Req()</a>, and <a class="el" href="fb__hal_8c_source.html#l00636">timer_timeout()</a>.</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dynsection">
<div class="center"><img src="fb__hal_8c_a296f7c3289677f2b99af85e65dfd04e0_icgraph.png" border="0" usemap="#fb__hal_8c_a296f7c3289677f2b99af85e65dfd04e0_icgraph_map" alt=""></div>
<map name="fb__hal_8c_a296f7c3289677f2b99af85e65dfd04e0_icgraph_map" id="fb__hal_8c_a296f7c3289677f2b99af85e65dfd04e0_icgraph">
<area shape="rect" id="node3" href="fb__prot_8c.html#a4a0be801ed4f2d9b2cbce548adf56a76" title="Read the values from the ADC converter." alt="" coords="203,5,312,35"/><area shape="rect" id="node5" href="fb__prot_8c.html#a37d55968595e78e21dc1dba21418acf4" title="Is called if information for the BCU type is requested." alt="" coords="159,59,356,88"/><area shape="rect" id="node7" href="fb__prot_8c.html#ae56aada1e48493023c8f3ecf7a1e71a7" title="A read request to the application." alt="" coords="180,112,335,141"/><area shape="rect" id="node9" href="fb__prot_8c.html#abb5d4fc672e3e3e123f5f3e6e9f901e3" title="Is called if a broadcast is received with a matching group address (eg." alt="" coords="179,165,336,195"/><area shape="rect" id="node11" href="fb__prot_8c.html#af2931210aae10a2c39698d2f1fb3c98c" title="Read data from eeprom and return send it as telegram back to the requester." alt="" coords="191,219,324,248"/><area shape="rect" id="node13" href="fb__prot_8c.html#afae8acdc71d1ebff494c621459c097cf" title="Write recieved data to the eeprom." alt="" coords="189,272,325,301"/><area shape="rect" id="node15" href="fb__prot_8c.html#ae42ed05d4ccf0a841bdaa32fe7af4478" title="Returns the address of the device." alt="" coords="164,325,351,355"/><area shape="rect" id="node17" href="fb__prot_8c.html#ac3b30c7591e51974ab895440929395c6" title="Set the received address as our new device address." alt="" coords="163,379,352,408"/><area shape="rect" id="node19" href="fb__prot_8c.html#a5928e9483083ad86d6c82f0b0ca533af" title="Send aknowledge to certain message." alt="" coords="225,432,289,461"/><area shape="rect" id="node21" href="fb__prot_8c.html#a3b317425f1358ea37c8fca124e29c277" title="Called to start a connection to a physical address." alt="" coords="193,485,321,515"/><area shape="rect" id="node23" href="fb__prot_8c.html#a0675ad49aa389619806157f585c466ee" title="Release the transport connection." alt="" coords="184,539,331,568"/><area shape="rect" id="node25" href="fb__hal_8c.html#af44a3cacd6e2ffabfab5a4628b796a79" title="That function is called if the timeout of 384탎 tiggered." alt="" coords="197,592,317,621"/><area shape="rect" id="node27" href="fb__hal_8c.html#aec43762dc86e029b395d4e5819192c2d" title="The ISR handles which function must be called." alt="" coords="407,592,449,621"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a85ef2600dfae61cd15f445efbc31fb60"></a><!-- doxytag: member="fb_hal.c::fbhal_checkProgTaster" ref="a85ef2600dfae61cd15f445efbc31fb60" args="(void)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint8_t fbhal_checkProgTaster </td>
          <td>(</td>
          <td class="paramtype">void&nbsp;</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Check the programm button and set programming mode and switch LED depending on programming mode. </p>
<p>Programm button is on PB0 and pin 4 on Freebus connector.</p>
<p>Function detects the state of the prog button (debounced) and sets the programming mode. This is done only every 16th call, because the 킗 needs some time to switch from output to input mode and so we got more negative duty cylce for the prog led.</p>
<dl class="bug"><dt><b><a class="el" href="bug.html#_bug000002">Bug:</a></b></dt><dd>The macro SET_IO_PROG(IO_OUTPUT) could not be used here, because this sets the DDR and also the PORT = 0. This won't work. </dd></dl>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000092">Todo:</a></b></dt><dd>Check if this function is working fine. </dd></dl>
<dl class="author"><dt><b>Author:</b></dt><dd>Matthias Fechner, Tobias Buss </dd></dl>

<p>References <a class="el" href="freebus-debug_8h_source.html#l00057">DEBUG_PUTS</a>, <a class="el" href="delay_8h_source.html#l00048">delay</a>, <a class="el" href="freebus-atmega16_8h_source.html#l00185">PROG_DDR</a>, <a class="el" href="freebus-atmega16_8h_source.html#l00187">PROG_PIN</a>, <a class="el" href="freebus-atmega16_8h_source.html#l00184">PROG_PORT</a>, <a class="el" href="fb_8h_source.html#l00041">SS_PROG</a>, and <a class="el" href="fb__hal_8h_source.html#l00083">systemState</a>.</p>

<p>Referenced by <a class="el" href="fb__in8__app_8c_source.html#l00870">main()</a>.</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dynsection">
<div class="center"><img src="fb__hal_8c_a85ef2600dfae61cd15f445efbc31fb60_icgraph.png" border="0" usemap="#fb__hal_8c_a85ef2600dfae61cd15f445efbc31fb60_icgraph_map" alt=""></div>
<map name="fb__hal_8c_a85ef2600dfae61cd15f445efbc31fb60_icgraph_map" id="fb__hal_8c_a85ef2600dfae61cd15f445efbc31fb60_icgraph">
<area shape="rect" id="node3" href="fb__in8__app_8c.html#a840291bc02cba5474a4cb46a9b9566fe" title="The start point of the program, init all libraries, start the bus interface, the..." alt="" coords="208,5,259,35"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a1d2bce7e6ac0dd55aa811e53722ea4be"></a><!-- doxytag: member="fb_hal.c::fbhal_Init" ref="a1d2bce7e6ac0dd55aa811e53722ea4be" args="(void)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void fbhal_Init </td>
          <td>(</td>
          <td class="paramtype">void&nbsp;</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Set input/output mode to PORTs, init timers and interrupts. </p>

<p><dl class="todo"><dt><b><a class="el" href="todo.html#_todo000105">Todo:</a></b></dt><dd>Timer und Interrupt-Register konfigurieren </dd></dl>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000106">Todo:</a></b></dt><dd>define a macro for following instructions in freebus-atmegaxxx.h </dd></dl>
</p>

<p>References <a class="el" href="freebus-atmega16_8h_source.html#l00052">CONFIGURE_INT0</a>, <a class="el" href="fb__hal_8c_source.html#l00093">EIB_BIT_TIME</a>, <a class="el" href="fb__hal_8c_source.html#l00097">EIB_NONE_MODE</a>, <a class="el" href="fb__hal_8c_source.html#l00094">EIB_TX_LOWTIME</a>, <a class="el" href="fb__hal_8h_source.html#l00053">FB_BUS_FREE</a>, <a class="el" href="fb__hal_8c_source.html#l00140">fb_frame</a>, <a class="el" href="fb__hal_8c_source.html#l00142">fbstat</a>, <a class="el" href="fb__hal_8h_source.html#l00064">IO_INPUT</a>, <a class="el" href="fb__hal_8h_source.html#l00065">IO_OUTPUT</a>, <a class="el" href="fb__hal_8c_source.html#l00190">next_rx_state()</a>, <a class="el" href="fb__hal_8h_source.html#l00061">OFF</a>, <a class="el" href="fb__hal_8c_source.html#l00148">operationMode</a>, <a class="el" href="fb__hal_8c_source.html#l00141">rxframe</a>, <a class="el" href="fb__hal_8h_source.html#l00083">systemState</a>, and <a class="el" href="fb__hal_8c_source.html#l00117">TS_WAITING_CHARS</a>.</p>

<p>Referenced by <a class="el" href="fb__in8__app_8c_source.html#l00870">main()</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dynsection">
<div class="center"><img src="fb__hal_8c_a1d2bce7e6ac0dd55aa811e53722ea4be_cgraph.png" border="0" usemap="#fb__hal_8c_a1d2bce7e6ac0dd55aa811e53722ea4be_cgraph_map" alt=""></div>
<map name="fb__hal_8c_a1d2bce7e6ac0dd55aa811e53722ea4be_cgraph_map" id="fb__hal_8c_a1d2bce7e6ac0dd55aa811e53722ea4be_cgraph">
<area shape="rect" id="node3" href="fb__hal_8c.html#abe9ce1ff59cb1eb49f7e651549139764" title="Set the next state while in receiving mode." alt="" coords="128,5,229,35"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dynsection">
<div class="center"><img src="fb__hal_8c_a1d2bce7e6ac0dd55aa811e53722ea4be_icgraph.png" border="0" usemap="#fb__hal_8c_a1d2bce7e6ac0dd55aa811e53722ea4be_icgraph_map" alt=""></div>
<map name="fb__hal_8c_a1d2bce7e6ac0dd55aa811e53722ea4be_icgraph_map" id="fb__hal_8c_a1d2bce7e6ac0dd55aa811e53722ea4be_icgraph">
<area shape="rect" id="node3" href="fb__in8__app_8c.html#a840291bc02cba5474a4cb46a9b9566fe" title="The start point of the program, init all libraries, start the bus interface, the..." alt="" coords="128,5,179,35"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a000fea78ba4ec6b5cb844d931242184c"></a><!-- doxytag: member="fb_hal.c::freebus_sleep_mode" ref="a000fea78ba4ec6b5cb844d931242184c" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void freebus_sleep_mode </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Enter sleep_mode to save power. </p>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000091">Todo:</a></b></dt><dd>write that function. </dd></dl>

</div>
</div>
<a class="anchor" id="aec43762dc86e029b395d4e5819192c2d"></a><!-- doxytag: member="fb_hal.c::ISR" ref="aec43762dc86e029b395d4e5819192c2d" args="(TIMER0_COMPA_vect)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">ISR </td>
          <td>(</td>
          <td class="paramtype">TIMER0_COMPA_vect&nbsp;</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>The ISR handles which function must be called. </p>
<p>States are defined in the state diagramm.</p>
<dl class="return"><dt><b>Returns:</b></dt><dd></dd></dl>

<p><dl class="todo"><dt><b><a class="el" href="todo.html#_todo000094">Todo:</a></b></dt><dd>timeout depends on the message type, repeat, alarm </dd></dl>
</p>

<p>References <a class="el" href="fb__hal_8c_source.html#l00100">EIB_CHECK_FOR_COLLISION</a>, <a class="el" href="fb__hal_8c_source.html#l00099">EIB_RECEIVE_MODE</a>, <a class="el" href="fb__hal_8c_source.html#l00098">EIB_SEND_MODE</a>, <a class="el" href="freebus-atmega16_8h_source.html#l00064">ENABLE_RX_INT</a>, <a class="el" href="fb__hal_8c_source.html#l00145">fb_ackvalue</a>, <a class="el" href="fb__hal_8c_source.html#l00140">fb_frame</a>, <a class="el" href="fb__hal_8c_source.html#l00190">next_rx_state()</a>, <a class="el" href="fb__hal_8h_source.html#l00062">ON</a>, <a class="el" href="fb__hal_8c_source.html#l00148">operationMode</a>, <a class="el" href="fb__hal_8c_source.html#l00137">rx_state</a>, <a class="el" href="fb__hal_8c_source.html#l00141">rxframe</a>, <a class="el" href="fb__hal_8c_source.html#l00149">timer0_skips</a>, <a class="el" href="fb__hal_8c_source.html#l00717">timer_ack()</a>, <a class="el" href="fb__hal_8c_source.html#l00740">timer_bus_free()</a>, <a class="el" href="fb__hal_8c_source.html#l00572">timer_rec_chars()</a>, <a class="el" href="fb__hal_8c_source.html#l00787">timer_resp_tout()</a>, <a class="el" href="fb__hal_8c_source.html#l00636">timer_timeout()</a>, <a class="el" href="fb__hal_8c_source.html#l00119">TS_WAITING_ACK</a>, <a class="el" href="fb__hal_8c_source.html#l00120">TS_WAITING_ACK_RESP</a>, <a class="el" href="fb__hal_8c_source.html#l00121">TS_WAITING_BUS_FREE</a>, <a class="el" href="fb__hal_8c_source.html#l00117">TS_WAITING_CHARS</a>, <a class="el" href="fb__hal_8c_source.html#l00118">TS_WAITING_TIMEOUT</a>, <a class="el" href="fb__hal_8c_source.html#l00893">tx_error()</a>, <a class="el" href="fb__hal_8c_source.html#l00130">TX_ERROR</a>, <a class="el" href="fb__hal_8c_source.html#l00126">TX_NONE</a>, <a class="el" href="fb__hal_8c_source.html#l00820">tx_send_checksum()</a>, <a class="el" href="fb__hal_8c_source.html#l00128">TX_SEND_CHECKSUM</a>, <a class="el" href="fb__hal_8c_source.html#l00797">tx_send_data()</a>, <a class="el" href="fb__hal_8c_source.html#l00127">TX_SEND_DATA</a>, <a class="el" href="fb__hal_8c_source.html#l00138">tx_state</a>, <a class="el" href="fb__hal_8c_source.html#l00835">tx_wait_ack()</a>, and <a class="el" href="fb__hal_8c_source.html#l00129">TX_WAITING_ACK</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dynsection">
<div class="center"><img src="fb__hal_8c_aec43762dc86e029b395d4e5819192c2d_cgraph.png" border="0" usemap="#fb__hal_8c_aec43762dc86e029b395d4e5819192c2d_cgraph_map" alt=""></div>
<map name="fb__hal_8c_aec43762dc86e029b395d4e5819192c2d_cgraph_map" id="fb__hal_8c_aec43762dc86e029b395d4e5819192c2d_cgraph">
<area shape="rect" id="node3" href="fb__hal_8c.html#abe9ce1ff59cb1eb49f7e651549139764" title="Set the next state while in receiving mode." alt="" coords="483,314,600,343"/><area shape="rect" id="node5" href="fb__hal_8c.html#a4738339212f7be2d3090deb995953529" title="Telegram received completly now decided which telegram type was recieved and if it..." alt="" coords="312,470,400,499"/><area shape="rect" id="node10" href="fb__hal_8c.html#a4f090f79722be364605b7c776db2a78a" title="Telegram received." alt="" coords="104,471,227,501"/><area shape="rect" id="node19" href="fb__hal_8c.html#a8155185b5b41794d6ead2aba9870b9fa" title="Generate the telegram checksum and copy the next octet to send to fb_frame." alt="" coords="299,577,413,606"/><area shape="rect" id="node24" href="fb__hal_8c.html#adbc1536a5853b8f6c824462a53cf4f67" title="A start bit was received in the past now read bit for bit until the end of the octet..." alt="" coords="100,367,231,397"/><area shape="rect" id="node31" href="fb__hal_8c.html#a3cef2c79df784b2c7e52dde126b0e0d0" title="Telegram send completely but ack wasn&#39;t received in timerframe, set error flag..." alt="" coords="100,105,231,134"/><area shape="rect" id="node33" href="fb__hal_8c.html#afcdb445c1b6cc3e39d904592286349ee" title="Negative acknowledge received, check repeat counter and if repeat is not expired..." alt="" coords="319,51,393,81"/><area shape="rect" id="node37" href="fb__hal_8c.html#af44a3cacd6e2ffabfab5a4628b796a79" title="That function is called if the timeout of 384탎 tiggered." alt="" coords="105,158,225,187"/><area shape="rect" id="node50" href="fb__hal_8c.html#a1a372817454f06132f80e02fbc7005df" title="Put the checksum in fb_frame and set state machine to wait for ack." alt="" coords="281,630,431,659"/><area shape="rect" id="node55" href="fb__hal_8c.html#a1e9ccf79644054a2acf54780c4ee0fee" title="All data + checksum transmitted, stop IRQ and wait for acknowledge." alt="" coords="305,523,407,553"/><area shape="rect" id="node7" href="fb__hal_8c.html#a5a622f74cb37183309cbf6a3678fb129" title="Generate an EIB frame and calculate the checksum." alt="" coords="505,550,577,579"/><area shape="rect" id="node12" href="fb__hal_8c.html#a02bd6a0eef1e1be4a306236d886f04bb" title="Postive acknowledge received, dequeue message." alt="" coords="301,262,411,291"/><area shape="rect" id="node14" href="msg__queue_8h.html#a76c904b1fd4cb70e06c96422f8a58e43" title="Remove a message from the queue." alt="" coords="487,158,596,187"/><area shape="rect" id="node16" href="msg__queue_8h.html#afec1149f3bb049af42978cf90c775ca6" title="Free the message and mark it as MSG_FREE." alt="" coords="651,79,731,109"/><area shape="rect" id="node22" href="fb__hal_8c.html#aa4a5a78d404751d2731d41c606c430fc" title="Set the next state in sending mode." alt="" coords="481,603,601,633"/><area shape="rect" id="node26" href="msg__queue_8h.html#aa3b6fa424df78c0dbbbaa16a7dd32acb" title="Allocate space for a message and return a pointer to it." alt="" coords="315,417,397,446"/><area shape="rect" id="node28" href="fb__hal_8h.html#a29aed42c30189a510295e50c98f34afc" title="Hold application and set blink code to PORTB pin 0, our prog pin and LED." alt="" coords="513,417,569,446"/><area shape="rect" id="node39" href="fb__prot_8h.html#aa73e24db682143ef1340c4e4e46d7feb" title="That function will be called if a telegram was received completely." alt="" coords="299,158,413,187"/><area shape="rect" id="node43" href="fb__hal_8h.html#a3e4f31f4b97d833e7ef5fb9615def386" title="Function to set the ack value for the response to a telegram which must be send in..." alt="" coords="304,105,408,134"/><area shape="rect" id="node41" href="fb__prot_8c.html#af4f820be8f1240cee6515133062a2e93" title="Analyse the type of the message (broadcast, direct, group address) and check for..." alt="" coords="492,105,591,134"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="afea150fcd685610cb9f7672fce361e53"></a><!-- doxytag: member="fb_hal.c::ISR" ref="afea150fcd685610cb9f7672fce361e53" args="(INT0_vect)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">ISR </td>
          <td>(</td>
          <td class="paramtype">INT0_vect&nbsp;</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>A falling edge triggers this interrupt. </p>
<p>It's the start of an EIB telegram. Configure timer0 to read the bits starting with LSB. build frame: Stop Stop Parity 7 6 5 4 3 2 1 0 Start</p>
<dl class="return"><dt><b>Returns:</b></dt><dd></dd></dl>

<p><dl class="todo"><dt><b><a class="el" href="todo.html#_todo000093">Todo:</a></b></dt><dd>define a macro for following instructions in freebus-atmegaxxx.h </dd></dl>
</p>

<p>References <a class="el" href="freebus-debug_8h_source.html#l00053">DEBUG_PUTC</a>, <a class="el" href="fb__hal_8c_source.html#l00093">EIB_BIT_TIME</a>, <a class="el" href="fb__hal_8c_source.html#l00099">EIB_RECEIVE_MODE</a>, <a class="el" href="fb__hal_8h_source.html#l00053">FB_BUS_FREE</a>, <a class="el" href="fb__hal_8c_source.html#l00142">fbstat</a>, <a class="el" href="fb__hal_8c_source.html#l00190">next_rx_state()</a>, <a class="el" href="fb__hal_8c_source.html#l00148">operationMode</a>, <a class="el" href="fb__hal_8c_source.html#l00141">rxframe</a>, <a class="el" href="fb__hal_8c_source.html#l00149">timer0_skips</a>, and <a class="el" href="fb__hal_8c_source.html#l00117">TS_WAITING_CHARS</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dynsection">
<div class="center"><img src="fb__hal_8c_afea150fcd685610cb9f7672fce361e53_cgraph.png" border="0" usemap="#fb__hal_8c_afea150fcd685610cb9f7672fce361e53_cgraph_map" alt=""></div>
<map name="fb__hal_8c_afea150fcd685610cb9f7672fce361e53_cgraph_map" id="fb__hal_8c_afea150fcd685610cb9f7672fce361e53_cgraph">
<area shape="rect" id="node3" href="fb__hal_8c.html#abe9ce1ff59cb1eb49f7e651549139764" title="Set the next state while in receiving mode." alt="" coords="96,5,197,35"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="abe9ce1ff59cb1eb49f7e651549139764"></a><!-- doxytag: member="fb_hal.c::next_rx_state" ref="abe9ce1ff59cb1eb49f7e651549139764" args="(enum etimer_state new_state)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static void next_rx_state </td>
          <td>(</td>
          <td class="paramtype">enum <a class="el" href="fb__hal_8c.html#af24054d97e225ff81412767e9e92780b">etimer_state</a>&nbsp;</td>
          <td class="paramname"> <em>new_state</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [inline, static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Set the next state while in receiving mode. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>new_state</em>&nbsp;</td><td>Next function which must be called after timer triggers. </td></tr>
  </table>
  </dd>
</dl>

<p>References <a class="el" href="fb__hal_8c_source.html#l00137">rx_state</a>.</p>

<p>Referenced by <a class="el" href="fb__hal_8c_source.html#l01010">fbhal_Init()</a>, <a class="el" href="fb__hal_8c_source.html#l00375">ISR()</a>, <a class="el" href="fb__hal_8c_source.html#l00717">timer_ack()</a>, <a class="el" href="fb__hal_8c_source.html#l00572">timer_rec_chars()</a>, <a class="el" href="fb__hal_8c_source.html#l00636">timer_timeout()</a>, <a class="el" href="fb__hal_8c_source.html#l00863">tx_complete()</a>, <a class="el" href="fb__hal_8c_source.html#l00893">tx_error()</a>, and <a class="el" href="fb__hal_8c_source.html#l00835">tx_wait_ack()</a>.</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dynsection">
<div class="center"><img src="fb__hal_8c_abe9ce1ff59cb1eb49f7e651549139764_icgraph.png" border="0" usemap="#fb__hal_8c_abe9ce1ff59cb1eb49f7e651549139764_icgraph_map" alt=""></div>
<map name="fb__hal_8c_abe9ce1ff59cb1eb49f7e651549139764_icgraph_map" id="fb__hal_8c_abe9ce1ff59cb1eb49f7e651549139764_icgraph">
<area shape="rect" id="node3" href="fb__hal_8c.html#a1d2bce7e6ac0dd55aa811e53722ea4be" title="Set input/output mode to PORTs, init timers and interrupts." alt="" coords="187,5,269,35"/><area shape="rect" id="node7" href="fb__hal_8c.html#afea150fcd685610cb9f7672fce361e53" title="A falling edge triggers this interrupt." alt="" coords="207,59,249,88"/><area shape="rect" id="node9" href="fb__hal_8c.html#a4738339212f7be2d3090deb995953529" title="Telegram received completly now decided which telegram type was recieved and if it..." alt="" coords="353,160,441,189"/><area shape="rect" id="node13" href="fb__hal_8c.html#adbc1536a5853b8f6c824462a53cf4f67" title="A start bit was received in the past now read bit for bit until the end of the octet..." alt="" coords="332,213,463,243"/><area shape="rect" id="node16" href="fb__hal_8c.html#af44a3cacd6e2ffabfab5a4628b796a79" title="That function is called if the timeout of 384탎 tiggered." alt="" coords="337,320,457,349"/><area shape="rect" id="node19" href="fb__hal_8c.html#a02bd6a0eef1e1be4a306236d886f04bb" title="Postive acknowledge received, dequeue message." alt="" coords="173,267,283,296"/><area shape="rect" id="node25" href="fb__hal_8c.html#afcdb445c1b6cc3e39d904592286349ee" title="Negative acknowledge received, check repeat counter and if repeat is not expired..." alt="" coords="191,372,265,401"/><area shape="rect" id="node32" href="fb__hal_8c.html#a1e9ccf79644054a2acf54780c4ee0fee" title="All data + checksum transmitted, stop IRQ and wait for acknowledge." alt="" coords="177,112,279,141"/><area shape="rect" id="node5" href="fb__in8__app_8c.html#a840291bc02cba5474a4cb46a9b9566fe" title="The start point of the program, init all libraries, start the bus interface, the..." alt="" coords="371,5,424,35"/><area shape="rect" id="node11" href="fb__hal_8c.html#aec43762dc86e029b395d4e5819192c2d" title="The ISR handles which function must be called." alt="" coords="513,267,556,296"/><area shape="rect" id="node21" href="fb__hal_8c.html#a4f090f79722be364605b7c776db2a78a" title="Telegram received." alt="" coords="336,267,459,296"/><area shape="rect" id="node28" href="fb__hal_8c.html#a3cef2c79df784b2c7e52dde126b0e0d0" title="Telegram send completely but ack wasn&#39;t received in timerframe, set error flag..." alt="" coords="332,424,463,453"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="aa4a5a78d404751d2731d41c606c430fc"></a><!-- doxytag: member="fb_hal.c::next_tx_state" ref="aa4a5a78d404751d2731d41c606c430fc" args="(enum etx_state new_state)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static void next_tx_state </td>
          <td>(</td>
          <td class="paramtype">enum <a class="el" href="fb__hal_8c.html#ad04bb26f006f4041eeedd64c90e10dcb">etx_state</a>&nbsp;</td>
          <td class="paramname"> <em>new_state</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [inline, static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Set the next state in sending mode. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>new_state</em>&nbsp;</td><td>Next function which must be called after timer triggers. </td></tr>
  </table>
  </dd>
</dl>

<p>References <a class="el" href="fb__hal_8c_source.html#l00138">tx_state</a>.</p>

<p>Referenced by <a class="el" href="fb__hal_8c_source.html#l00820">tx_send_checksum()</a>, <a class="el" href="fb__hal_8c_source.html#l00797">tx_send_data()</a>, and <a class="el" href="fb__hal_8c_source.html#l00835">tx_wait_ack()</a>.</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dynsection">
<div class="center"><img src="fb__hal_8c_aa4a5a78d404751d2731d41c606c430fc_icgraph.png" border="0" usemap="#fb__hal_8c_aa4a5a78d404751d2731d41c606c430fc_icgraph_map" alt=""></div>
<map name="fb__hal_8c_aa4a5a78d404751d2731d41c606c430fc_icgraph_map" id="fb__hal_8c_aa4a5a78d404751d2731d41c606c430fc_icgraph">
<area shape="rect" id="node3" href="fb__hal_8c.html#a1a372817454f06132f80e02fbc7005df" title="Put the checksum in fb_frame and set state machine to wait for ack." alt="" coords="340,57,489,87"/><area shape="rect" id="node7" href="fb__hal_8c.html#a8155185b5b41794d6ead2aba9870b9fa" title="Generate the telegram checksum and copy the next octet to send to fb_frame." alt="" coords="176,137,291,167"/><area shape="rect" id="node52" href="fb__hal_8c.html#a1e9ccf79644054a2acf54780c4ee0fee" title="All data + checksum transmitted, stop IRQ and wait for acknowledge." alt="" coords="183,5,284,35"/><area shape="rect" id="node5" href="fb__hal_8c.html#aec43762dc86e029b395d4e5819192c2d" title="The ISR handles which function must be called." alt="" coords="597,84,640,113"/><area shape="rect" id="node10" href="fb__hal_8c.html#abc433410f75bf996dab8e7fa672205c0" title="Function is called from message queue system to trigger the interrupt for transmitting..." alt="" coords="364,215,465,244"/><area shape="rect" id="node49" href="fb__hal_8c.html#a4f090f79722be364605b7c776db2a78a" title="Telegram received." alt="" coords="353,111,476,140"/><area shape="rect" id="node12" href="fb__hal_8c.html#abbf23a2adcf8b8280c8ce17d4a12951b" title="Queue message for sending." alt="" coords="539,215,699,244"/><area shape="rect" id="node14" href="fb__prot_8c.html#a4a0be801ed4f2d9b2cbce548adf56a76" title="Read the values from the ADC converter." alt="" coords="1027,5,1136,35"/><area shape="rect" id="node16" href="fb__prot_8c.html#a37d55968595e78e21dc1dba21418acf4" title="Is called if information for the BCU type is requested." alt="" coords="983,59,1180,88"/><area shape="rect" id="node18" href="fb__prot_8c.html#af2931210aae10a2c39698d2f1fb3c98c" title="Read data from eeprom and return send it as telegram back to the requester." alt="" coords="1015,165,1148,195"/><area shape="rect" id="node20" href="fb__prot_8c.html#ae42ed05d4ccf0a841bdaa32fe7af4478" title="Returns the address of the device." alt="" coords="747,215,933,244"/><area shape="rect" id="node22" href="fb__prot_8c.html#a440973c20d3055721521a359aee68536" title="Sicherungslayer." alt="" coords="799,111,881,140"/><area shape="rect" id="node29" href="fb__app_8h.html#ace6b0e9279dd6bc5c4238fd4bac237ba" title="Read status from port and return it." alt="" coords="777,268,903,297"/><area shape="rect" id="node33" href="fb__prot_8c.html#ade80ef84f4f14d25a2283b43d9c1a54f" title="Send telegram as response to signal current state of the port to other devices." alt="" coords="771,321,909,351"/><area shape="rect" id="node35" href="fb__prot_8c.html#a990a78673785da5bb024bfaf60e0984a" title="Send telegram as response to signal current state of the port to other devices." alt="" coords="783,375,897,404"/><area shape="rect" id="node45" href="fb__hal_8c.html#ab475358073d6ed6f59de0b9fd41e65ee" title="That function can be use to send a test telegramm to the bus, e.g." alt="" coords="767,453,913,483"/><area shape="rect" id="node27" href="fb__prot_8c.html#afae8acdc71d1ebff494c621459c097cf" title="Write recieved data to the eeprom." alt="" coords="1013,112,1149,141"/><area shape="rect" id="node31" href="fb__prot_8c.html#ae56aada1e48493023c8f3ecf7a1e71a7" title="A read request to the application." alt="" coords="1004,268,1159,297"/><area shape="rect" id="node37" href="fb__in8__app_8c.html#a8d1473313842fe123fec771c086af269" title="Port Function: Jalousie." alt="" coords="1012,373,1151,403"/><area shape="rect" id="node39" href="fb__in8__app_8c.html#a3cabe34d9b90083ff13af0188e622539" title="Timer1 is used as application timer." alt="" coords="1231,373,1407,403"/><area shape="rect" id="node41" href="fb__in8__app_8c.html#a71a91b98ae9a796dac4ab23c7e3ff6d8" title="Port Function: switch." alt="" coords="1015,427,1148,456"/><area shape="rect" id="node47" href="fb__in8__app_8c.html#a840291bc02cba5474a4cb46a9b9566fe" title="The start point of the program, init all libraries, start the bus interface, the..." alt="" coords="1055,480,1108,509"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a30c6b413389944e9362e0bb20467962e"></a><!-- doxytag: member="fb_hal.c::panic" ref="a30c6b413389944e9362e0bb20467962e" args="(uint8_t reason)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void panic </td>
          <td>(</td>
          <td class="paramtype">uint8_t&nbsp;</td>
          <td class="paramname"> <em>reason</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Hold application and set blink code to PORTB pin 0, our prog pin and LED. </p>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000104">Todo:</a></b></dt><dd>Replace that function with a mechanism that not completely kills the controller application </dd></dl>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>reason</em>&nbsp;</td><td></td></tr>
  </table>
  </dd>
</dl>

<p>References <a class="el" href="fb__hal_8h_source.html#l00065">IO_OUTPUT</a>, <a class="el" href="fb__hal_8h_source.html#l00061">OFF</a>, and <a class="el" href="fb__hal_8h_source.html#l00062">ON</a>.</p>

</div>
</div>
<a class="anchor" id="abc433410f75bf996dab8e7fa672205c0"></a><!-- doxytag: member="fb_hal.c::retrigger_tx" ref="abc433410f75bf996dab8e7fa672205c0" args="(void)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static void retrigger_tx </td>
          <td>(</td>
          <td class="paramtype">void&nbsp;</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Function is called from message queue system to trigger the interrupt for transmitting data. </p>

<p>References <a class="el" href="fb__hal_8c_source.html#l00147">checksum</a>, <a class="el" href="fb__hal_8h_source.html#l00053">FB_BUS_FREE</a>, <a class="el" href="fb__hal_8c_source.html#l00142">fbstat</a>, <a class="el" href="msg__queue_8h_source.html#l00059">MSG_SENDING</a>, <a class="el" href="fb__hal_8c_source.html#l00104">START_TX</a>, <a class="el" href="msg__queue_8h_source.html#l00066">msg::state</a>, <a class="el" href="fb__hal_8c_source.html#l00797">tx_send_data()</a>, <a class="el" href="fb__hal_8c_source.html#l00127">TX_SEND_DATA</a>, <a class="el" href="fb__hal_8c_source.html#l00138">tx_state</a>, and <a class="el" href="fb__hal_8c_source.html#l00146">wr_cnt</a>.</p>

<p>Referenced by <a class="el" href="fb__hal_8c_source.html#l00968">fb_hal_txqueue_msg()</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dynsection">
<div class="center"><img src="fb__hal_8c_abc433410f75bf996dab8e7fa672205c0_cgraph.png" border="0" usemap="#fb__hal_8c_abc433410f75bf996dab8e7fa672205c0_cgraph_map" alt=""></div>
<map name="fb__hal_8c_abc433410f75bf996dab8e7fa672205c0_cgraph_map" id="fb__hal_8c_abc433410f75bf996dab8e7fa672205c0_cgraph">
<area shape="rect" id="node3" href="fb__hal_8c.html#a8155185b5b41794d6ead2aba9870b9fa" title="Generate the telegram checksum and copy the next octet to send to fb_frame." alt="" coords="143,32,241,61"/><area shape="rect" id="node5" href="fb__hal_8c.html#a5a622f74cb37183309cbf6a3678fb129" title="Generate an EIB frame and calculate the checksum." alt="" coords="309,5,373,35"/><area shape="rect" id="node7" href="fb__hal_8c.html#aa4a5a78d404751d2731d41c606c430fc" title="Set the next state in sending mode." alt="" coords="291,59,392,88"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dynsection">
<div class="center"><img src="fb__hal_8c_abc433410f75bf996dab8e7fa672205c0_icgraph.png" border="0" usemap="#fb__hal_8c_abc433410f75bf996dab8e7fa672205c0_icgraph_map" alt=""></div>
<map name="fb__hal_8c_abc433410f75bf996dab8e7fa672205c0_icgraph_map" id="fb__hal_8c_abc433410f75bf996dab8e7fa672205c0_icgraph">
<area shape="rect" id="node3" href="fb__hal_8c.html#abbf23a2adcf8b8280c8ce17d4a12951b" title="Queue message for sending." alt="" coords="141,215,283,244"/><area shape="rect" id="node5" href="fb__prot_8c.html#a4a0be801ed4f2d9b2cbce548adf56a76" title="Read the values from the ADC converter." alt="" coords="588,5,689,35"/><area shape="rect" id="node7" href="fb__prot_8c.html#a37d55968595e78e21dc1dba21418acf4" title="Is called if information for the BCU type is requested." alt="" coords="553,59,724,88"/><area shape="rect" id="node9" href="fb__prot_8c.html#af2931210aae10a2c39698d2f1fb3c98c" title="Read data from eeprom and return send it as telegram back to the requester." alt="" coords="577,165,700,195"/><area shape="rect" id="node11" href="fb__prot_8c.html#ae42ed05d4ccf0a841bdaa32fe7af4478" title="Returns the address of the device." alt="" coords="331,215,504,244"/><area shape="rect" id="node13" href="fb__prot_8c.html#a440973c20d3055721521a359aee68536" title="Sicherungslayer." alt="" coords="380,111,455,140"/><area shape="rect" id="node20" href="fb__app_8h.html#ace6b0e9279dd6bc5c4238fd4bac237ba" title="Read status from port and return it." alt="" coords="363,268,472,297"/><area shape="rect" id="node24" href="fb__prot_8c.html#ade80ef84f4f14d25a2283b43d9c1a54f" title="Send telegram as response to signal current state of the port to other devices." alt="" coords="356,321,479,351"/><area shape="rect" id="node26" href="fb__prot_8c.html#a990a78673785da5bb024bfaf60e0984a" title="Send telegram as response to signal current state of the port to other devices." alt="" coords="367,375,468,404"/><area shape="rect" id="node36" href="fb__hal_8c.html#ab475358073d6ed6f59de0b9fd41e65ee" title="That function can be use to send a test telegramm to the bus, e.g." alt="" coords="353,453,481,483"/><area shape="rect" id="node18" href="fb__prot_8c.html#afae8acdc71d1ebff494c621459c097cf" title="Write recieved data to the eeprom." alt="" coords="577,112,700,141"/><area shape="rect" id="node22" href="fb__prot_8c.html#ae56aada1e48493023c8f3ecf7a1e71a7" title="A read request to the application." alt="" coords="568,268,709,297"/><area shape="rect" id="node28" href="fb__in8__app_8c.html#a8d1473313842fe123fec771c086af269" title="Port Function: Jalousie." alt="" coords="575,373,703,403"/><area shape="rect" id="node30" href="fb__in8__app_8c.html#a3cabe34d9b90083ff13af0188e622539" title="Timer1 is used as application timer." alt="" coords="773,373,923,403"/><area shape="rect" id="node32" href="fb__in8__app_8c.html#a71a91b98ae9a796dac4ab23c7e3ff6d8" title="Port Function: switch." alt="" coords="579,427,699,456"/><area shape="rect" id="node38" href="fb__in8__app_8c.html#a840291bc02cba5474a4cb46a9b9566fe" title="The start point of the program, init all libraries, start the bus interface, the..." alt="" coords="613,480,664,509"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="ab475358073d6ed6f59de0b9fd41e65ee"></a><!-- doxytag: member="fb_hal.c::sendTestTelegram" ref="ab475358073d6ed6f59de0b9fd41e65ee" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void sendTestTelegram </td>
          <td>(</td>
          <td class="paramtype">void&nbsp;</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>That function can be use to send a test telegramm to the bus, e.g. </p>
<p>to measure signal levels in circuit. </p>

<p>References <a class="el" href="msg__queue_8c_source.html#l00061">AllocMsgI()</a>, <a class="el" href="fb__prot_8h_source.html#l00102">fbus_hdr::apci</a>, <a class="el" href="fb__prot_8h_source.html#l00097">fbus_hdr::ctrl</a>, <a class="el" href="msg__queue_8h_source.html#l00070">msg::data</a>, <a class="el" href="freebus-debug_8h_source.html#l00067">DEBUG_NEWLINE</a>, <a class="el" href="freebus-debug_8h_source.html#l00057">DEBUG_PUTS</a>, <a class="el" href="fb__prot_8h_source.html#l00099">fbus_hdr::dest</a>, <a class="el" href="fb__eeprom_8c_source.html#l00178">eeprom_ParamRead()</a>, <a class="el" href="fb__hal_8h_source.html#l00053">FB_BUS_FREE</a>, <a class="el" href="fb__hal_8c_source.html#l00968">fb_hal_txqueue_msg()</a>, <a class="el" href="fb__hal_8c_source.html#l00142">fbstat</a>, <a class="el" href="msg__queue_8h_source.html#l00069">msg::len</a>, <a class="el" href="fb__prot_8h_source.html#l00100">fbus_hdr::npci</a>, <a class="el" href="fb__prot_8h_source.html#l00082">PA_ADDRESS_HIGH</a>, <a class="el" href="fb__prot_8h_source.html#l00083">PA_ADDRESS_LOW</a>, <a class="el" href="msg__queue_8h_source.html#l00071">msg::repeat</a>, <a class="el" href="fb__prot_8h_source.html#l00098">fbus_hdr::src</a>, and <a class="el" href="fb__prot_8h_source.html#l00101">fbus_hdr::tpci</a>.</p>

<p>Referenced by <a class="el" href="fb__in8__app_8c_source.html#l00870">main()</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dynsection">
<div class="center"><img src="fb__hal_8c_ab475358073d6ed6f59de0b9fd41e65ee_cgraph.png" border="0" usemap="#fb__hal_8c_ab475358073d6ed6f59de0b9fd41e65ee_cgraph_map" alt=""></div>
<map name="fb__hal_8c_ab475358073d6ed6f59de0b9fd41e65ee_cgraph_map" id="fb__hal_8c_ab475358073d6ed6f59de0b9fd41e65ee_cgraph">
<area shape="rect" id="node3" href="msg__queue_8h.html#aa3b6fa424df78c0dbbbaa16a7dd32acb" title="Allocate space for a message and return a pointer to it." alt="" coords="213,5,291,35"/><area shape="rect" id="node7" href="fb__eeprom_8h.html#a93b2810dc3abdedaa3dfa772943fb5ca" title="Read data from the eeprom cache and return it." alt="" coords="183,59,321,88"/><area shape="rect" id="node9" href="fb__hal_8h.html#af70a4606fe5ce0777a371e0c6c3540fb" title="Queue message for sending." alt="" coords="181,112,323,141"/><area shape="rect" id="node5" href="fb__hal_8h.html#a29aed42c30189a510295e50c98f34afc" title="Hold application and set blink code to PORTB pin 0, our prog pin and LED." alt="" coords="388,5,441,35"/><area shape="rect" id="node11" href="msg__queue_8h.html#af35d846267d1aaaf1df04c8bff03047e" title="Add a new message to the message queue." alt="" coords="373,85,456,115"/><area shape="rect" id="node13" href="fb__hal_8c.html#abc433410f75bf996dab8e7fa672205c0" title="Function is called from message queue system to trigger the interrupt for transmitting..." alt="" coords="372,139,457,168"/><area shape="rect" id="node15" href="fb__hal_8c.html#a8155185b5b41794d6ead2aba9870b9fa" title="Generate the telegram checksum and copy the next octet to send to fb_frame." alt="" coords="508,139,607,168"/><area shape="rect" id="node17" href="fb__hal_8c.html#a5a622f74cb37183309cbf6a3678fb129" title="Generate an EIB frame and calculate the checksum." alt="" coords="675,112,739,141"/><area shape="rect" id="node19" href="fb__hal_8c.html#aa4a5a78d404751d2731d41c606c430fc" title="Set the next state in sending mode." alt="" coords="656,165,757,195"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dynsection">
<div class="center"><img src="fb__hal_8c_ab475358073d6ed6f59de0b9fd41e65ee_icgraph.png" border="0" usemap="#fb__hal_8c_ab475358073d6ed6f59de0b9fd41e65ee_icgraph_map" alt=""></div>
<map name="fb__hal_8c_ab475358073d6ed6f59de0b9fd41e65ee_icgraph_map" id="fb__hal_8c_ab475358073d6ed6f59de0b9fd41e65ee_icgraph">
<area shape="rect" id="node3" href="fb__in8__app_8c.html#a840291bc02cba5474a4cb46a9b9566fe" title="The start point of the program, init all libraries, start the bus interface, the..." alt="" coords="181,5,232,35"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a4738339212f7be2d3090deb995953529"></a><!-- doxytag: member="fb_hal.c::timer_ack" ref="a4738339212f7be2d3090deb995953529" args="(void)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static void timer_ack </td>
          <td>(</td>
          <td class="paramtype">void&nbsp;</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Telegram received completly now decided which telegram type was recieved and if it is necessary to send confirmation back. </p>
<p>If confirmation is requested return (1 octet) else wait 5.xxms which means end of telegram. </p>

<p><dl class="todo"><dt><b><a class="el" href="todo.html#_todo000097">Todo:</a></b></dt><dd>timeout depends on the message type, repeat, alarm on prio 1&amp;2 wait 5,216ms, on prio 3&amp;4 wait 5,216ms+312탎 </dd></dl>
</p>

<p>References <a class="el" href="fb__hal_8c_source.html#l00145">fb_ackvalue</a>, <a class="el" href="fb__hal_8c_source.html#l00355">fb_putc()</a>, <a class="el" href="fb__hal_8c_source.html#l00190">next_rx_state()</a>, <a class="el" href="fb__hal_8c_source.html#l00104">START_TX</a>, <a class="el" href="fb__hal_8c_source.html#l00149">timer0_skips</a>, and <a class="el" href="fb__hal_8c_source.html#l00121">TS_WAITING_BUS_FREE</a>.</p>

<p>Referenced by <a class="el" href="fb__hal_8c_source.html#l00422">ISR()</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dynsection">
<div class="center"><img src="fb__hal_8c_a4738339212f7be2d3090deb995953529_cgraph.png" border="0" usemap="#fb__hal_8c_a4738339212f7be2d3090deb995953529_cgraph_map" alt=""></div>
<map name="fb__hal_8c_a4738339212f7be2d3090deb995953529_cgraph_map" id="fb__hal_8c_a4738339212f7be2d3090deb995953529_cgraph">
<area shape="rect" id="node3" href="fb__hal_8c.html#a5a622f74cb37183309cbf6a3678fb129" title="Generate an EIB frame and calculate the checksum." alt="" coords="152,5,216,35"/><area shape="rect" id="node5" href="fb__hal_8c.html#abe9ce1ff59cb1eb49f7e651549139764" title="Set the next state while in receiving mode." alt="" coords="133,59,235,88"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dynsection">
<div class="center"><img src="fb__hal_8c_a4738339212f7be2d3090deb995953529_icgraph.png" border="0" usemap="#fb__hal_8c_a4738339212f7be2d3090deb995953529_icgraph_map" alt=""></div>
<map name="fb__hal_8c_a4738339212f7be2d3090deb995953529_icgraph_map" id="fb__hal_8c_a4738339212f7be2d3090deb995953529_icgraph">
<area shape="rect" id="node3" href="fb__hal_8c.html#aec43762dc86e029b395d4e5819192c2d" title="The ISR handles which function must be called." alt="" coords="145,5,188,35"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a4f090f79722be364605b7c776db2a78a"></a><!-- doxytag: member="fb_hal.c::timer_bus_free" ref="a4f090f79722be364605b7c776db2a78a" args="(void)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static void timer_bus_free </td>
          <td>(</td>
          <td class="paramtype">void&nbsp;</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Telegram received. </p>
<p>Stop timer </p>

<p><dl class="todo"><dt><b><a class="el" href="todo.html#_todo000098">Todo:</a></b></dt><dd>define a macro for following instructions in freebus-atmegaxxx.h </dd></dl>
</p>

<p>References <a class="el" href="fb__hal_8c_source.html#l00147">checksum</a>, <a class="el" href="freebus-debug_8h_source.html#l00067">DEBUG_NEWLINE</a>, <a class="el" href="freebus-debug_8h_source.html#l00053">DEBUG_PUTC</a>, <a class="el" href="freebus-debug_8h_source.html#l00063">DEBUG_PUTHEX</a>, <a class="el" href="fb__hal_8h_source.html#l00053">FB_BUS_FREE</a>, <a class="el" href="fb__hal_8c_source.html#l00142">fbstat</a>, <a class="el" href="msg__queue_8h_source.html#l00058">MSG_ALLOC</a>, <a class="el" href="msg__queue_8h_source.html#l00059">MSG_SENDING</a>, <a class="el" href="fb__hal_8c_source.html#l00104">START_TX</a>, <a class="el" href="msg__queue_8h_source.html#l00066">msg::state</a>, <a class="el" href="fb__hal_8c_source.html#l00863">tx_complete()</a>, <a class="el" href="fb__hal_8c_source.html#l00797">tx_send_data()</a>, <a class="el" href="fb__hal_8c_source.html#l00127">TX_SEND_DATA</a>, <a class="el" href="fb__hal_8c_source.html#l00138">tx_state</a>, and <a class="el" href="fb__hal_8c_source.html#l00146">wr_cnt</a>.</p>

<p>Referenced by <a class="el" href="fb__hal_8c_source.html#l00422">ISR()</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dynsection">
<div class="center"><img src="fb__hal_8c_a4f090f79722be364605b7c776db2a78a_cgraph.png" border="0" usemap="#fb__hal_8c_a4f090f79722be364605b7c776db2a78a_cgraph_map" alt=""></div>
<map name="fb__hal_8c_a4f090f79722be364605b7c776db2a78a_cgraph_map" id="fb__hal_8c_a4f090f79722be364605b7c776db2a78a_cgraph">
<area shape="rect" id="node3" href="fb__hal_8c.html#a02bd6a0eef1e1be4a306236d886f04bb" title="Postive acknowledge received, dequeue message." alt="" coords="164,59,257,88"/><area shape="rect" id="node11" href="fb__hal_8c.html#a8155185b5b41794d6ead2aba9870b9fa" title="Generate the telegram checksum and copy the next octet to send to fb_frame." alt="" coords="161,112,260,141"/><area shape="rect" id="node5" href="msg__queue_8h.html#a76c904b1fd4cb70e06c96422f8a58e43" title="Remove a message from the queue." alt="" coords="312,5,408,35"/><area shape="rect" id="node9" href="fb__hal_8c.html#abe9ce1ff59cb1eb49f7e651549139764" title="Set the next state while in receiving mode." alt="" coords="309,59,411,88"/><area shape="rect" id="node7" href="msg__queue_8h.html#afec1149f3bb049af42978cf90c775ca6" title="Free the message and mark it as MSG_FREE." alt="" coords="460,5,532,35"/><area shape="rect" id="node13" href="fb__hal_8c.html#a5a622f74cb37183309cbf6a3678fb129" title="Generate an EIB frame and calculate the checksum." alt="" coords="328,112,392,141"/><area shape="rect" id="node15" href="fb__hal_8c.html#aa4a5a78d404751d2731d41c606c430fc" title="Set the next state in sending mode." alt="" coords="309,165,411,195"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dynsection">
<div class="center"><img src="fb__hal_8c_a4f090f79722be364605b7c776db2a78a_icgraph.png" border="0" usemap="#fb__hal_8c_a4f090f79722be364605b7c776db2a78a_icgraph_map" alt=""></div>
<map name="fb__hal_8c_a4f090f79722be364605b7c776db2a78a_icgraph_map" id="fb__hal_8c_a4f090f79722be364605b7c776db2a78a_icgraph">
<area shape="rect" id="node3" href="fb__hal_8c.html#aec43762dc86e029b395d4e5819192c2d" title="The ISR handles which function must be called." alt="" coords="180,5,223,35"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="adbc1536a5853b8f6c824462a53cf4f67"></a><!-- doxytag: member="fb_hal.c::timer_rec_chars" ref="adbc1536a5853b8f6c824462a53cf4f67" args="(void)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static void timer_rec_chars </td>
          <td>(</td>
          <td class="paramtype">void&nbsp;</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>A start bit was received in the past now read bit for bit until the end of the octet is received (10 bit). </p>
<p>Then save the octet and start the timer for the next octet. </p>

<p>References <a class="el" href="msg__queue_8c_source.html#l00061">AllocMsgI()</a>, <a class="el" href="msg__queue_8h_source.html#l00070">msg::data</a>, <a class="el" href="freebus-debug_8h_source.html#l00067">DEBUG_NEWLINE</a>, <a class="el" href="freebus-debug_8h_source.html#l00063">DEBUG_PUTHEX</a>, <a class="el" href="freebus-atmega16_8h_source.html#l00064">ENABLE_RX_INT</a>, <a class="el" href="fb__hal_8h_source.html#l00048">FB_FRAME_ERR</a>, <a class="el" href="fb__hal_8h_source.html#l00049">FB_PARITY_ERR</a>, <a class="el" href="fb__hal_8c_source.html#l00142">fbstat</a>, <a class="el" href="msg__queue_8h_source.html#l00069">msg::len</a>, <a class="el" href="fb__hal_8c_source.html#l00190">next_rx_state()</a>, <a class="el" href="fb__hal_8c_source.html#l00141">rxframe</a>, <a class="el" href="fb__hal_8c_source.html#l00149">timer0_skips</a>, and <a class="el" href="fb__hal_8c_source.html#l00118">TS_WAITING_TIMEOUT</a>.</p>

<p>Referenced by <a class="el" href="fb__hal_8c_source.html#l00422">ISR()</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dynsection">
<div class="center"><img src="fb__hal_8c_adbc1536a5853b8f6c824462a53cf4f67_cgraph.png" border="0" usemap="#fb__hal_8c_adbc1536a5853b8f6c824462a53cf4f67_cgraph_map" alt=""></div>
<map name="fb__hal_8c_adbc1536a5853b8f6c824462a53cf4f67_cgraph_map" id="fb__hal_8c_adbc1536a5853b8f6c824462a53cf4f67_cgraph">
<area shape="rect" id="node3" href="msg__queue_8h.html#aa3b6fa424df78c0dbbbaa16a7dd32acb" title="Allocate space for a message and return a pointer to it." alt="" coords="180,5,257,35"/><area shape="rect" id="node7" href="fb__hal_8c.html#abe9ce1ff59cb1eb49f7e651549139764" title="Set the next state while in receiving mode." alt="" coords="168,59,269,88"/><area shape="rect" id="node5" href="fb__hal_8h.html#a29aed42c30189a510295e50c98f34afc" title="Hold application and set blink code to PORTB pin 0, our prog pin and LED." alt="" coords="317,5,371,35"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dynsection">
<div class="center"><img src="fb__hal_8c_adbc1536a5853b8f6c824462a53cf4f67_icgraph.png" border="0" usemap="#fb__hal_8c_adbc1536a5853b8f6c824462a53cf4f67_icgraph_map" alt=""></div>
<map name="fb__hal_8c_adbc1536a5853b8f6c824462a53cf4f67_icgraph_map" id="fb__hal_8c_adbc1536a5853b8f6c824462a53cf4f67_icgraph">
<area shape="rect" id="node3" href="fb__hal_8c.html#aec43762dc86e029b395d4e5819192c2d" title="The ISR handles which function must be called." alt="" coords="185,5,228,35"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a3cef2c79df784b2c7e52dde126b0e0d0"></a><!-- doxytag: member="fb_hal.c::timer_resp_tout" ref="a3cef2c79df784b2c7e52dde126b0e0d0" args="(void)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static void timer_resp_tout </td>
          <td>(</td>
          <td class="paramtype">void&nbsp;</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Telegram send completely but ack wasn't received in timerframe, set error flag in control structure. </p>

<p>References <a class="el" href="fb__hal_8c_source.html#l00893">tx_error()</a>.</p>

<p>Referenced by <a class="el" href="fb__hal_8c_source.html#l00422">ISR()</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dynsection">
<div class="center"><img src="fb__hal_8c_a3cef2c79df784b2c7e52dde126b0e0d0_cgraph.png" border="0" usemap="#fb__hal_8c_a3cef2c79df784b2c7e52dde126b0e0d0_cgraph_map" alt=""></div>
<map name="fb__hal_8c_a3cef2c79df784b2c7e52dde126b0e0d0_cgraph_map" id="fb__hal_8c_a3cef2c79df784b2c7e52dde126b0e0d0_cgraph">
<area shape="rect" id="node3" href="fb__hal_8c.html#afcdb445c1b6cc3e39d904592286349ee" title="Negative acknowledge received, check repeat counter and if repeat is not expired..." alt="" coords="165,32,232,61"/><area shape="rect" id="node5" href="msg__queue_8h.html#a76c904b1fd4cb70e06c96422f8a58e43" title="Remove a message from the queue." alt="" coords="283,5,379,35"/><area shape="rect" id="node9" href="fb__hal_8c.html#abe9ce1ff59cb1eb49f7e651549139764" title="Set the next state while in receiving mode." alt="" coords="280,59,381,88"/><area shape="rect" id="node7" href="msg__queue_8h.html#afec1149f3bb049af42978cf90c775ca6" title="Free the message and mark it as MSG_FREE." alt="" coords="431,5,503,35"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dynsection">
<div class="center"><img src="fb__hal_8c_a3cef2c79df784b2c7e52dde126b0e0d0_icgraph.png" border="0" usemap="#fb__hal_8c_a3cef2c79df784b2c7e52dde126b0e0d0_icgraph_map" alt=""></div>
<map name="fb__hal_8c_a3cef2c79df784b2c7e52dde126b0e0d0_icgraph_map" id="fb__hal_8c_a3cef2c79df784b2c7e52dde126b0e0d0_icgraph">
<area shape="rect" id="node3" href="fb__hal_8c.html#aec43762dc86e029b395d4e5819192c2d" title="The ISR handles which function must be called." alt="" coords="188,5,231,35"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="af44a3cacd6e2ffabfab5a4628b796a79"></a><!-- doxytag: member="fb_hal.c::timer_timeout" ref="af44a3cacd6e2ffabfab5a4628b796a79" args="(void)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static void timer_timeout </td>
          <td>(</td>
          <td class="paramtype">void&nbsp;</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>That function is called if the timeout of 384탎 tiggered. </p>
<p>That means the end of the telegram is reached. Now prepare all for the ack which must be sent within 1.352탎-384탎. </p>

<p><dl class="todo"><dt><b><a class="el" href="todo.html#_todo000096">Todo:</a></b></dt><dd>goto sollte man immer vermeiden </dd></dl>
</p>

<p>References <a class="el" href="msg__queue_8h_source.html#l00070">msg::data</a>, <a class="el" href="freebus-debug_8h_source.html#l00067">DEBUG_NEWLINE</a>, <a class="el" href="freebus-debug_8h_source.html#l00057">DEBUG_PUTS</a>, <a class="el" href="freebus-atmega16_8h_source.html#l00059">DISABLE_RX_INT</a>, <a class="el" href="fb_8h_source.html#l00031">FB_ACK</a>, <a class="el" href="fb__hal_8c_source.html#l00145">fb_ackvalue</a>, <a class="el" href="fb__hal_8h_source.html#l00048">FB_FRAME_ERR</a>, <a class="el" href="fb__prot_8c_source.html#l00797">fb_handlemsg()</a>, <a class="el" href="fb__hal_8h_source.html#l00056">FB_MESSAGE</a>, <a class="el" href="fb_8h_source.html#l00032">FB_NACK</a>, <a class="el" href="fb__hal_8h_source.html#l00049">FB_PARITY_ERR</a>, <a class="el" href="fb__hal_8c_source.html#l00328">fb_send_ack()</a>, <a class="el" href="fb__hal_8c_source.html#l00142">fbstat</a>, <a class="el" href="msg__queue_8h_source.html#l00099">FreeMsg()</a>, <a class="el" href="msg__queue_8h_source.html#l00069">msg::len</a>, <a class="el" href="msg__queue_8h_source.html#l00060">MSG_WAIT_ACK</a>, <a class="el" href="fb__hal_8c_source.html#l00190">next_rx_state()</a>, <a class="el" href="msg__queue_8h_source.html#l00066">msg::state</a>, <a class="el" href="fb__hal_8c_source.html#l00149">timer0_skips</a>, <a class="el" href="fb__hal_8c_source.html#l00119">TS_WAITING_ACK</a>, <a class="el" href="fb__hal_8c_source.html#l00863">tx_complete()</a>, and <a class="el" href="fb__hal_8c_source.html#l00893">tx_error()</a>.</p>

<p>Referenced by <a class="el" href="fb__hal_8c_source.html#l00422">ISR()</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dynsection">
<div class="center"><img src="fb__hal_8c_af44a3cacd6e2ffabfab5a4628b796a79_cgraph.png" border="0" usemap="#fb__hal_8c_af44a3cacd6e2ffabfab5a4628b796a79_cgraph_map" alt=""></div>
<map name="fb__hal_8c_af44a3cacd6e2ffabfab5a4628b796a79_cgraph_map" id="fb__hal_8c_af44a3cacd6e2ffabfab5a4628b796a79_cgraph">
<area shape="rect" id="node3" href="fb__prot_8h.html#aa73e24db682143ef1340c4e4e46d7feb" title="That function will be called if a telegram was received completely." alt="" coords="156,5,257,35"/><area shape="rect" id="node7" href="fb__hal_8h.html#a3e4f31f4b97d833e7ef5fb9615def386" title="Function to set the ack value for the response to a telegram which must be send in..." alt="" coords="160,59,253,88"/><area shape="rect" id="node9" href="msg__queue_8h.html#afec1149f3bb049af42978cf90c775ca6" title="Free the message and mark it as MSG_FREE." alt="" coords="457,137,529,167"/><area shape="rect" id="node11" href="fb__hal_8c.html#abe9ce1ff59cb1eb49f7e651549139764" title="Set the next state while in receiving mode." alt="" coords="307,216,408,245"/><area shape="rect" id="node13" href="fb__hal_8c.html#a02bd6a0eef1e1be4a306236d886f04bb" title="Postive acknowledge received, dequeue message." alt="" coords="160,163,253,192"/><area shape="rect" id="node19" href="fb__hal_8c.html#afcdb445c1b6cc3e39d904592286349ee" title="Negative acknowledge received, check repeat counter and if repeat is not expired..." alt="" coords="173,216,240,245"/><area shape="rect" id="node5" href="fb__prot_8c.html#af4f820be8f1240cee6515133062a2e93" title="Analyse the type of the message (broadcast, direct, group address) and check for..." alt="" coords="313,5,401,35"/><area shape="rect" id="node15" href="msg__queue_8h.html#a76c904b1fd4cb70e06c96422f8a58e43" title="Remove a message from the queue." alt="" coords="309,163,405,192"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dynsection">
<div class="center"><img src="fb__hal_8c_af44a3cacd6e2ffabfab5a4628b796a79_icgraph.png" border="0" usemap="#fb__hal_8c_af44a3cacd6e2ffabfab5a4628b796a79_icgraph_map" alt=""></div>
<map name="fb__hal_8c_af44a3cacd6e2ffabfab5a4628b796a79_icgraph_map" id="fb__hal_8c_af44a3cacd6e2ffabfab5a4628b796a79_icgraph">
<area shape="rect" id="node3" href="fb__hal_8c.html#aec43762dc86e029b395d4e5819192c2d" title="The ISR handles which function must be called." alt="" coords="177,5,220,35"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a02bd6a0eef1e1be4a306236d886f04bb"></a><!-- doxytag: member="fb_hal.c::tx_complete" ref="a02bd6a0eef1e1be4a306236d886f04bb" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static void tx_complete </td>
          <td>(</td>
          <td class="paramtype">void&nbsp;</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [inline, static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Postive acknowledge received, dequeue message. </p>

<p><dl class="todo"><dt><b><a class="el" href="todo.html#_todo000099">Todo:</a></b></dt><dd>: recalculate timer settings for different priorities </dd></dl>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000100">Todo:</a></b></dt><dd>: recalculate timer settings for different priorities </dd></dl>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000101">Todo:</a></b></dt><dd>timeout depends on the message type, repeat, alarm </dd></dl>
</p>

<p>References <a class="el" href="msg__queue_8c_source.html#l00116">dequeuemsg()</a>, <a class="el" href="fb__hal_8c_source.html#l00099">EIB_RECEIVE_MODE</a>, <a class="el" href="msg__queue_8h_source.html#l00067">msg::flags</a>, <a class="el" href="msg__queue_8h_source.html#l00061">MSG_COMPLETE</a>, <a class="el" href="msg__queue_8h_source.html#l00050">MSG_HI_PRIO</a>, <a class="el" href="fb__hal_8c_source.html#l00190">next_rx_state()</a>, <a class="el" href="fb__hal_8c_source.html#l00148">operationMode</a>, <a class="el" href="msg__queue_8h_source.html#l00066">msg::state</a>, <a class="el" href="fb__hal_8c_source.html#l00149">timer0_skips</a>, and <a class="el" href="fb__hal_8c_source.html#l00121">TS_WAITING_BUS_FREE</a>.</p>

<p>Referenced by <a class="el" href="fb__hal_8c_source.html#l00740">timer_bus_free()</a>, and <a class="el" href="fb__hal_8c_source.html#l00636">timer_timeout()</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dynsection">
<div class="center"><img src="fb__hal_8c_a02bd6a0eef1e1be4a306236d886f04bb_cgraph.png" border="0" usemap="#fb__hal_8c_a02bd6a0eef1e1be4a306236d886f04bb_cgraph_map" alt=""></div>
<map name="fb__hal_8c_a02bd6a0eef1e1be4a306236d886f04bb_cgraph_map" id="fb__hal_8c_a02bd6a0eef1e1be4a306236d886f04bb_cgraph">
<area shape="rect" id="node3" href="msg__queue_8h.html#a76c904b1fd4cb70e06c96422f8a58e43" title="Remove a message from the queue." alt="" coords="149,5,245,35"/><area shape="rect" id="node7" href="fb__hal_8c.html#abe9ce1ff59cb1eb49f7e651549139764" title="Set the next state while in receiving mode." alt="" coords="147,59,248,88"/><area shape="rect" id="node5" href="msg__queue_8h.html#afec1149f3bb049af42978cf90c775ca6" title="Free the message and mark it as MSG_FREE." alt="" coords="297,5,369,35"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dynsection">
<div class="center"><img src="fb__hal_8c_a02bd6a0eef1e1be4a306236d886f04bb_icgraph.png" border="0" usemap="#fb__hal_8c_a02bd6a0eef1e1be4a306236d886f04bb_icgraph_map" alt=""></div>
<map name="fb__hal_8c_a02bd6a0eef1e1be4a306236d886f04bb_icgraph_map" id="fb__hal_8c_a02bd6a0eef1e1be4a306236d886f04bb_icgraph">
<area shape="rect" id="node3" href="fb__hal_8c.html#a4f090f79722be364605b7c776db2a78a" title="Telegram received." alt="" coords="164,5,287,35"/><area shape="rect" id="node7" href="fb__hal_8c.html#af44a3cacd6e2ffabfab5a4628b796a79" title="That function is called if the timeout of 384탎 tiggered." alt="" coords="165,59,285,88"/><area shape="rect" id="node5" href="fb__hal_8c.html#aec43762dc86e029b395d4e5819192c2d" title="The ISR handles which function must be called." alt="" coords="337,32,380,61"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="afcdb445c1b6cc3e39d904592286349ee"></a><!-- doxytag: member="fb_hal.c::tx_error" ref="afcdb445c1b6cc3e39d904592286349ee" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static void tx_error </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Negative acknowledge received, check repeat counter and if repeat is not expired resend telegram. </p>
<p>Set the collision flag. </p>

<p><dl class="todo"><dt><b><a class="el" href="todo.html#_todo000102">Todo:</a></b></dt><dd>calculate always high prio </dd></dl>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000103">Todo:</a></b></dt><dd>timeout depends on the message type, repeat, alarm </dd></dl>
</p>

<p>References <a class="el" href="msg__queue_8h_source.html#l00070">msg::data</a>, <a class="el" href="msg__queue_8c_source.html#l00116">dequeuemsg()</a>, <a class="el" href="fb__hal_8h_source.html#l00050">FB_COLLISION</a>, <a class="el" href="fb__hal_8c_source.html#l00142">fbstat</a>, <a class="el" href="msg__queue_8h_source.html#l00067">msg::flags</a>, <a class="el" href="msg__queue_8h_source.html#l00058">MSG_ALLOC</a>, <a class="el" href="msg__queue_8h_source.html#l00061">MSG_COMPLETE</a>, <a class="el" href="msg__queue_8h_source.html#l00050">MSG_HI_PRIO</a>, <a class="el" href="fb__hal_8c_source.html#l00190">next_rx_state()</a>, <a class="el" href="msg__queue_8h_source.html#l00071">msg::repeat</a>, <a class="el" href="msg__queue_8h_source.html#l00066">msg::state</a>, <a class="el" href="fb__hal_8c_source.html#l00149">timer0_skips</a>, and <a class="el" href="fb__hal_8c_source.html#l00121">TS_WAITING_BUS_FREE</a>.</p>

<p>Referenced by <a class="el" href="fb__hal_8c_source.html#l00422">ISR()</a>, <a class="el" href="fb__hal_8c_source.html#l00787">timer_resp_tout()</a>, and <a class="el" href="fb__hal_8c_source.html#l00636">timer_timeout()</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dynsection">
<div class="center"><img src="fb__hal_8c_afcdb445c1b6cc3e39d904592286349ee_cgraph.png" border="0" usemap="#fb__hal_8c_afcdb445c1b6cc3e39d904592286349ee_cgraph_map" alt=""></div>
<map name="fb__hal_8c_afcdb445c1b6cc3e39d904592286349ee_cgraph_map" id="fb__hal_8c_afcdb445c1b6cc3e39d904592286349ee_cgraph">
<area shape="rect" id="node3" href="msg__queue_8h.html#a76c904b1fd4cb70e06c96422f8a58e43" title="Remove a message from the queue." alt="" coords="123,5,219,35"/><area shape="rect" id="node7" href="fb__hal_8c.html#abe9ce1ff59cb1eb49f7e651549139764" title="Set the next state while in receiving mode." alt="" coords="120,59,221,88"/><area shape="rect" id="node5" href="msg__queue_8h.html#afec1149f3bb049af42978cf90c775ca6" title="Free the message and mark it as MSG_FREE." alt="" coords="271,5,343,35"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dynsection">
<div class="center"><img src="fb__hal_8c_afcdb445c1b6cc3e39d904592286349ee_icgraph.png" border="0" usemap="#fb__hal_8c_afcdb445c1b6cc3e39d904592286349ee_icgraph_map" alt=""></div>
<map name="fb__hal_8c_afcdb445c1b6cc3e39d904592286349ee_icgraph_map" id="fb__hal_8c_afcdb445c1b6cc3e39d904592286349ee_icgraph">
<area shape="rect" id="node3" href="fb__hal_8c.html#aec43762dc86e029b395d4e5819192c2d" title="The ISR handles which function must be called." alt="" coords="313,25,356,54"/><area shape="rect" id="node5" href="fb__hal_8c.html#a3cef2c79df784b2c7e52dde126b0e0d0" title="Telegram send completely but ack wasn&#39;t received in timerframe, set error flag..." alt="" coords="132,25,263,54"/><area shape="rect" id="node8" href="fb__hal_8c.html#af44a3cacd6e2ffabfab5a4628b796a79" title="That function is called if the timeout of 384탎 tiggered." alt="" coords="137,78,257,108"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a1a372817454f06132f80e02fbc7005df"></a><!-- doxytag: member="fb_hal.c::tx_send_checksum" ref="a1a372817454f06132f80e02fbc7005df" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static void tx_send_checksum </td>
          <td>(</td>
          <td class="paramtype">void&nbsp;</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [inline, static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Put the checksum in fb_frame and set state machine to wait for ack. </p>

<p>References <a class="el" href="fb__hal_8c_source.html#l00147">checksum</a>, <a class="el" href="fb__hal_8c_source.html#l00355">fb_putc()</a>, <a class="el" href="fb__hal_8c_source.html#l00180">next_tx_state()</a>, and <a class="el" href="fb__hal_8c_source.html#l00129">TX_WAITING_ACK</a>.</p>

<p>Referenced by <a class="el" href="fb__hal_8c_source.html#l00422">ISR()</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dynsection">
<div class="center"><img src="fb__hal_8c_a1a372817454f06132f80e02fbc7005df_cgraph.png" border="0" usemap="#fb__hal_8c_a1a372817454f06132f80e02fbc7005df_cgraph_map" alt=""></div>
<map name="fb__hal_8c_a1a372817454f06132f80e02fbc7005df_cgraph_map" id="fb__hal_8c_a1a372817454f06132f80e02fbc7005df_cgraph">
<area shape="rect" id="node3" href="fb__hal_8c.html#a5a622f74cb37183309cbf6a3678fb129" title="Generate an EIB frame and calculate the checksum." alt="" coords="208,5,272,35"/><area shape="rect" id="node5" href="fb__hal_8c.html#aa4a5a78d404751d2731d41c606c430fc" title="Set the next state in sending mode." alt="" coords="189,59,291,88"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dynsection">
<div class="center"><img src="fb__hal_8c_a1a372817454f06132f80e02fbc7005df_icgraph.png" border="0" usemap="#fb__hal_8c_a1a372817454f06132f80e02fbc7005df_icgraph_map" alt=""></div>
<map name="fb__hal_8c_a1a372817454f06132f80e02fbc7005df_icgraph_map" id="fb__hal_8c_a1a372817454f06132f80e02fbc7005df_icgraph">
<area shape="rect" id="node3" href="fb__hal_8c.html#aec43762dc86e029b395d4e5819192c2d" title="The ISR handles which function must be called." alt="" coords="207,5,249,35"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a8155185b5b41794d6ead2aba9870b9fa"></a><!-- doxytag: member="fb_hal.c::tx_send_data" ref="a8155185b5b41794d6ead2aba9870b9fa" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static void tx_send_data </td>
          <td>(</td>
          <td class="paramtype">void&nbsp;</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [inline, static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Generate the telegram checksum and copy the next octet to send to fb_frame. </p>
<p>If the telegramm is finished set state machine to send the checksum. </p>

<p>References <a class="el" href="fb__hal_8c_source.html#l00147">checksum</a>, <a class="el" href="msg__queue_8h_source.html#l00070">msg::data</a>, <a class="el" href="fb__hal_8c_source.html#l00098">EIB_SEND_MODE</a>, <a class="el" href="fb__hal_8c_source.html#l00355">fb_putc()</a>, <a class="el" href="msg__queue_8h_source.html#l00069">msg::len</a>, <a class="el" href="fb__hal_8c_source.html#l00180">next_tx_state()</a>, <a class="el" href="fb__hal_8c_source.html#l00148">operationMode</a>, <a class="el" href="fb__hal_8c_source.html#l00128">TX_SEND_CHECKSUM</a>, and <a class="el" href="fb__hal_8c_source.html#l00146">wr_cnt</a>.</p>

<p>Referenced by <a class="el" href="fb__hal_8c_source.html#l00422">ISR()</a>, <a class="el" href="fb__hal_8c_source.html#l00937">retrigger_tx()</a>, and <a class="el" href="fb__hal_8c_source.html#l00740">timer_bus_free()</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dynsection">
<div class="center"><img src="fb__hal_8c_a8155185b5b41794d6ead2aba9870b9fa_cgraph.png" border="0" usemap="#fb__hal_8c_a8155185b5b41794d6ead2aba9870b9fa_cgraph_map" alt=""></div>
<map name="fb__hal_8c_a8155185b5b41794d6ead2aba9870b9fa_cgraph_map" id="fb__hal_8c_a8155185b5b41794d6ead2aba9870b9fa_cgraph">
<area shape="rect" id="node3" href="fb__hal_8c.html#a5a622f74cb37183309cbf6a3678fb129" title="Generate an EIB frame and calculate the checksum." alt="" coords="173,5,237,35"/><area shape="rect" id="node5" href="fb__hal_8c.html#aa4a5a78d404751d2731d41c606c430fc" title="Set the next state in sending mode." alt="" coords="155,59,256,88"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dynsection">
<div class="center"><img src="fb__hal_8c_a8155185b5b41794d6ead2aba9870b9fa_icgraph.png" border="0" usemap="#fb__hal_8c_a8155185b5b41794d6ead2aba9870b9fa_icgraph_map" alt=""></div>
<map name="fb__hal_8c_a8155185b5b41794d6ead2aba9870b9fa_icgraph_map" id="fb__hal_8c_a8155185b5b41794d6ead2aba9870b9fa_icgraph">
<area shape="rect" id="node3" href="fb__hal_8c.html#aec43762dc86e029b395d4e5819192c2d" title="The ISR handles which function must be called." alt="" coords="400,136,443,165"/><area shape="rect" id="node5" href="fb__hal_8c.html#abc433410f75bf996dab8e7fa672205c0" title="Function is called from message queue system to trigger the interrupt for transmitting..." alt="" coords="180,215,281,244"/><area shape="rect" id="node44" href="fb__hal_8c.html#a4f090f79722be364605b7c776db2a78a" title="Telegram received." alt="" coords="169,111,292,140"/><area shape="rect" id="node7" href="fb__hal_8c.html#abbf23a2adcf8b8280c8ce17d4a12951b" title="Queue message for sending." alt="" coords="341,215,501,244"/><area shape="rect" id="node9" href="fb__prot_8c.html#a4a0be801ed4f2d9b2cbce548adf56a76" title="Read the values from the ADC converter." alt="" coords="829,5,939,35"/><area shape="rect" id="node11" href="fb__prot_8c.html#a37d55968595e78e21dc1dba21418acf4" title="Is called if information for the BCU type is requested." alt="" coords="785,59,983,88"/><area shape="rect" id="node13" href="fb__prot_8c.html#af2931210aae10a2c39698d2f1fb3c98c" title="Read data from eeprom and return send it as telegram back to the requester." alt="" coords="817,165,951,195"/><area shape="rect" id="node15" href="fb__prot_8c.html#ae42ed05d4ccf0a841bdaa32fe7af4478" title="Returns the address of the device." alt="" coords="549,215,736,244"/><area shape="rect" id="node17" href="fb__prot_8c.html#a440973c20d3055721521a359aee68536" title="Sicherungslayer." alt="" coords="601,111,684,140"/><area shape="rect" id="node24" href="fb__app_8h.html#ace6b0e9279dd6bc5c4238fd4bac237ba" title="Read status from port and return it." alt="" coords="580,268,705,297"/><area shape="rect" id="node28" href="fb__prot_8c.html#ade80ef84f4f14d25a2283b43d9c1a54f" title="Send telegram as response to signal current state of the port to other devices." alt="" coords="573,321,712,351"/><area shape="rect" id="node30" href="fb__prot_8c.html#a990a78673785da5bb024bfaf60e0984a" title="Send telegram as response to signal current state of the port to other devices." alt="" coords="585,375,700,404"/><area shape="rect" id="node40" href="fb__hal_8c.html#ab475358073d6ed6f59de0b9fd41e65ee" title="That function can be use to send a test telegramm to the bus, e.g." alt="" coords="569,453,716,483"/><area shape="rect" id="node22" href="fb__prot_8c.html#afae8acdc71d1ebff494c621459c097cf" title="Write recieved data to the eeprom." alt="" coords="816,112,952,141"/><area shape="rect" id="node26" href="fb__prot_8c.html#ae56aada1e48493023c8f3ecf7a1e71a7" title="A read request to the application." alt="" coords="807,268,961,297"/><area shape="rect" id="node32" href="fb__in8__app_8c.html#a8d1473313842fe123fec771c086af269" title="Port Function: Jalousie." alt="" coords="815,373,953,403"/><area shape="rect" id="node34" href="fb__in8__app_8c.html#a3cabe34d9b90083ff13af0188e622539" title="Timer1 is used as application timer." alt="" coords="1033,373,1209,403"/><area shape="rect" id="node36" href="fb__in8__app_8c.html#a71a91b98ae9a796dac4ab23c7e3ff6d8" title="Port Function: switch." alt="" coords="817,427,951,456"/><area shape="rect" id="node42" href="fb__in8__app_8c.html#a840291bc02cba5474a4cb46a9b9566fe" title="The start point of the program, init all libraries, start the bus interface, the..." alt="" coords="857,480,911,509"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a1e9ccf79644054a2acf54780c4ee0fee"></a><!-- doxytag: member="fb_hal.c::tx_wait_ack" ref="a1e9ccf79644054a2acf54780c4ee0fee" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static void tx_wait_ack </td>
          <td>(</td>
          <td class="paramtype">void&nbsp;</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [inline, static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>All data + checksum transmitted, stop IRQ and wait for acknowledge. </p>

<p>References <a class="el" href="fb__hal_8c_source.html#l00099">EIB_RECEIVE_MODE</a>, <a class="el" href="freebus-atmega16_8h_source.html#l00064">ENABLE_RX_INT</a>, <a class="el" href="msg__queue_8h_source.html#l00060">MSG_WAIT_ACK</a>, <a class="el" href="fb__hal_8c_source.html#l00190">next_rx_state()</a>, <a class="el" href="fb__hal_8c_source.html#l00180">next_tx_state()</a>, <a class="el" href="fb__hal_8c_source.html#l00148">operationMode</a>, <a class="el" href="fb__hal_8c_source.html#l00141">rxframe</a>, <a class="el" href="msg__queue_8h_source.html#l00066">msg::state</a>, <a class="el" href="fb__hal_8c_source.html#l00149">timer0_skips</a>, <a class="el" href="fb__hal_8c_source.html#l00120">TS_WAITING_ACK_RESP</a>, and <a class="el" href="fb__hal_8c_source.html#l00126">TX_NONE</a>.</p>

<p>Referenced by <a class="el" href="fb__hal_8c_source.html#l00422">ISR()</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dynsection">
<div class="center"><img src="fb__hal_8c_a1e9ccf79644054a2acf54780c4ee0fee_cgraph.png" border="0" usemap="#fb__hal_8c_a1e9ccf79644054a2acf54780c4ee0fee_cgraph_map" alt=""></div>
<map name="fb__hal_8c_a1e9ccf79644054a2acf54780c4ee0fee_cgraph_map" id="fb__hal_8c_a1e9ccf79644054a2acf54780c4ee0fee_cgraph">
<area shape="rect" id="node3" href="fb__hal_8c.html#abe9ce1ff59cb1eb49f7e651549139764" title="Set the next state while in receiving mode." alt="" coords="144,5,245,35"/><area shape="rect" id="node5" href="fb__hal_8c.html#aa4a5a78d404751d2731d41c606c430fc" title="Set the next state in sending mode." alt="" coords="144,59,245,88"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dynsection">
<div class="center"><img src="fb__hal_8c_a1e9ccf79644054a2acf54780c4ee0fee_icgraph.png" border="0" usemap="#fb__hal_8c_a1e9ccf79644054a2acf54780c4ee0fee_icgraph_map" alt=""></div>
<map name="fb__hal_8c_a1e9ccf79644054a2acf54780c4ee0fee_icgraph_map" id="fb__hal_8c_a1e9ccf79644054a2acf54780c4ee0fee_icgraph">
<area shape="rect" id="node3" href="fb__hal_8c.html#aec43762dc86e029b395d4e5819192c2d" title="The ISR handles which function must be called." alt="" coords="159,5,201,35"/></map>
</div>
</p>

</div>
</div>
<hr/><h2>Variable Documentation</h2>
<a class="anchor" id="a89896b172be5ecbbe195b793a91fe4f4"></a><!-- doxytag: member="fb_hal.c::checksum" ref="a89896b172be5ecbbe195b793a91fe4f4" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">volatile uint8_t <a class="el" href="fb__hal_8c.html#a89896b172be5ecbbe195b793a91fe4f4">checksum</a><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>checksum of the EIB telegram (over all octets) </p>

<p>Referenced by <a class="el" href="message_8c_source.html#l00068">CMessage::CalcChecksum()</a>, <a class="el" href="fb__prot_8c_source.html#l00797">fb_handlemsg()</a>, <a class="el" href="fb__hal_8c_source.html#l00937">retrigger_tx()</a>, <a class="el" href="fb__hal_8c_source.html#l00740">timer_bus_free()</a>, <a class="el" href="fb__hal_8c_source.html#l00820">tx_send_checksum()</a>, and <a class="el" href="fb__hal_8c_source.html#l00797">tx_send_data()</a>.</p>

</div>
</div>
<a class="anchor" id="aabc55f9c0f54b21d7dc8409b5a8474da"></a><!-- doxytag: member="fb_hal.c::fb_ackvalue" ref="aabc55f9c0f54b21d7dc8409b5a8474da" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">volatile uint8_t <a class="el" href="fb__hal_8c.html#aabc55f9c0f54b21d7dc8409b5a8474da">fb_ackvalue</a><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>if a response byte should be send back set this variable to FB_ACK, FB_NACK, FB_BUSY or FB_NONE </p>

<p>Referenced by <a class="el" href="fb__hal_8c_source.html#l00328">fb_send_ack()</a>, <a class="el" href="fb__hal_8c_source.html#l00422">ISR()</a>, <a class="el" href="fb__hal_8c_source.html#l00717">timer_ack()</a>, and <a class="el" href="fb__hal_8c_source.html#l00636">timer_timeout()</a>.</p>

</div>
</div>
<a class="anchor" id="a41f5a7da095fd642694f9c6a222ede72"></a><!-- doxytag: member="fb_hal.c::fb_frame" ref="a41f5a7da095fd642694f9c6a222ede72" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">volatile uint16_t <a class="el" href="fb__hal_8c.html#a41f5a7da095fd642694f9c6a222ede72">fb_frame</a><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>the current octet to transmit, including start, parity and stop bit </p>

<p>Referenced by <a class="el" href="fb__hal_8c_source.html#l00535">checkForCollisions()</a>, <a class="el" href="fb__hal_8c_source.html#l00355">fb_putc()</a>, <a class="el" href="fb__hal_8c_source.html#l01010">fbhal_Init()</a>, and <a class="el" href="fb__hal_8c_source.html#l00422">ISR()</a>.</p>

</div>
</div>
<a class="anchor" id="af342e7c63def35b89b53992fdbd53eb3"></a><!-- doxytag: member="fb_hal.c::fbstat" ref="af342e7c63def35b89b53992fdbd53eb3" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">volatile uint8_t <a class="el" href="fb__hal_8c.html#af342e7c63def35b89b53992fdbd53eb3">fbstat</a><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>the status for transmition (error status, all ok) </p>

<p>Referenced by <a class="el" href="fb__hal_8c_source.html#l00535">checkForCollisions()</a>, <a class="el" href="fb__hal_8c_source.html#l01010">fbhal_Init()</a>, <a class="el" href="fb__hal_8c_source.html#l00375">ISR()</a>, <a class="el" href="fb__hal_8c_source.html#l00937">retrigger_tx()</a>, <a class="el" href="fb__hal_8c_source.html#l00224">sendTestTelegram()</a>, <a class="el" href="fb__hal_8c_source.html#l00740">timer_bus_free()</a>, <a class="el" href="fb__hal_8c_source.html#l00572">timer_rec_chars()</a>, <a class="el" href="fb__hal_8c_source.html#l00636">timer_timeout()</a>, and <a class="el" href="fb__hal_8c_source.html#l00893">tx_error()</a>.</p>

</div>
</div>
<a class="anchor" id="a895b38744b07b801d5765dcf50de0b16"></a><!-- doxytag: member="fb_hal.c::operationMode" ref="a895b38744b07b801d5765dcf50de0b16" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint8_t <a class="el" href="fb__hal_8c.html#a895b38744b07b801d5765dcf50de0b16">operationMode</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>defines if sending or receiving data </p>

<p>Referenced by <a class="el" href="fb__hal_8c_source.html#l00535">checkForCollisions()</a>, <a class="el" href="fb__hal_8c_source.html#l01010">fbhal_Init()</a>, <a class="el" href="fb__hal_8c_source.html#l00375">ISR()</a>, <a class="el" href="fb__hal_8c_source.html#l00863">tx_complete()</a>, <a class="el" href="fb__hal_8c_source.html#l00797">tx_send_data()</a>, and <a class="el" href="fb__hal_8c_source.html#l00835">tx_wait_ack()</a>.</p>

</div>
</div>
<a class="anchor" id="adbfedca471e27c2d257fc90093e5f3de"></a><!-- doxytag: member="fb_hal.c::rx_ptr" ref="adbfedca471e27c2d257fc90093e5f3de" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="structmsg.html">msg</a>* <a class="el" href="fb__hal_8c.html#adbfedca471e27c2d257fc90093e5f3de">rx_ptr</a><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>store a recieved telegramm here. </p>

</div>
</div>
<a class="anchor" id="a917217e208d04fa3254181b9ddfa2f12"></a><!-- doxytag: member="fb_hal.c::rx_state" ref="a917217e208d04fa3254181b9ddfa2f12" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">enum <a class="el" href="fb__hal_8c.html#af24054d97e225ff81412767e9e92780b">etimer_state</a> <a class="el" href="fb__hal_8c.html#a917217e208d04fa3254181b9ddfa2f12">rx_state</a><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>save the next state while be in receiving mode </p>

<p>Referenced by <a class="el" href="fb__hal_8c_source.html#l00422">ISR()</a>, and <a class="el" href="fb__hal_8c_source.html#l00190">next_rx_state()</a>.</p>

</div>
</div>
<a class="anchor" id="a6c6b8bbd9bffb5b0c907b3b903b9ea8f"></a><!-- doxytag: member="fb_hal.c::rxframe" ref="a6c6b8bbd9bffb5b0c907b3b903b9ea8f" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">volatile uint16_t <a class="el" href="fb__hal_8c.html#a6c6b8bbd9bffb5b0c907b3b903b9ea8f">rxframe</a><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>hold data of the octet while receiving data. That variable is filled bit per bit. </p>

<p>Referenced by <a class="el" href="fb__hal_8c_source.html#l01010">fbhal_Init()</a>, <a class="el" href="fb__hal_8c_source.html#l00375">ISR()</a>, <a class="el" href="fb__hal_8c_source.html#l00572">timer_rec_chars()</a>, and <a class="el" href="fb__hal_8c_source.html#l00835">tx_wait_ack()</a>.</p>

</div>
</div>
<a class="anchor" id="a1769822e1fa84e6790b15ba3ec99d32e"></a><!-- doxytag: member="fb_hal.c::timer0_skips" ref="a1769822e1fa84e6790b15ba3ec99d32e" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">volatile uint8_t <a class="el" href="fb__hal_8c.html#a1769822e1fa84e6790b15ba3ec99d32e">timer0_skips</a><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>counter for skipping timer0 interrupts </p>

<p>Referenced by <a class="el" href="fb__hal_8c_source.html#l00375">ISR()</a>, <a class="el" href="fb__hal_8c_source.html#l00717">timer_ack()</a>, <a class="el" href="fb__hal_8c_source.html#l00572">timer_rec_chars()</a>, <a class="el" href="fb__hal_8c_source.html#l00636">timer_timeout()</a>, <a class="el" href="fb__hal_8c_source.html#l00863">tx_complete()</a>, <a class="el" href="fb__hal_8c_source.html#l00893">tx_error()</a>, and <a class="el" href="fb__hal_8c_source.html#l00835">tx_wait_ack()</a>.</p>

</div>
</div>
<a class="anchor" id="a008e953d2cc04433cec1a2467459164a"></a><!-- doxytag: member="fb_hal.c::tx_ptr" ref="a008e953d2cc04433cec1a2467459164a" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="structmsg.html">msg</a>* <a class="el" href="fb__hal_8c.html#a008e953d2cc04433cec1a2467459164a">tx_ptr</a><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>store telegram which should be sent </p>

</div>
</div>
<a class="anchor" id="a7c331c7fe91b2ca727e65c7262fdc5ae"></a><!-- doxytag: member="fb_hal.c::tx_state" ref="a7c331c7fe91b2ca727e65c7262fdc5ae" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">enum <a class="el" href="fb__hal_8c.html#ad04bb26f006f4041eeedd64c90e10dcb">etx_state</a> <a class="el" href="fb__hal_8c.html#a7c331c7fe91b2ca727e65c7262fdc5ae">tx_state</a><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>save the next state while be in transmitting mode </p>

<p>Referenced by <a class="el" href="fb__hal_8c_source.html#l00535">checkForCollisions()</a>, <a class="el" href="fb__hal_8c_source.html#l00422">ISR()</a>, <a class="el" href="fb__hal_8c_source.html#l00180">next_tx_state()</a>, <a class="el" href="fb__hal_8c_source.html#l00937">retrigger_tx()</a>, and <a class="el" href="fb__hal_8c_source.html#l00740">timer_bus_free()</a>.</p>

</div>
</div>
<a class="anchor" id="af481e250ef03f4b453d59719312d6014"></a><!-- doxytag: member="fb_hal.c::wr_cnt" ref="af481e250ef03f4b453d59719312d6014" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">volatile uint8_t <a class="el" href="fb__hal_8c.html#af481e250ef03f4b453d59719312d6014">wr_cnt</a><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>number of octet in telegram to send </p>

<p>Referenced by <a class="el" href="fb__hal_8c_source.html#l00937">retrigger_tx()</a>, <a class="el" href="fb__hal_8c_source.html#l00740">timer_bus_free()</a>, and <a class="el" href="fb__hal_8c_source.html#l00797">tx_send_data()</a>.</p>

</div>
</div>
</div>
<hr size="1"/><address style="text-align: right;"><small>Generated by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.6.2 </small></address>
</body>
</html>
